<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Scipy | Northboat Blog</title>
    <meta name="generator" content="VuePress 1.9.8">
    <link rel="icon" href="/img/leaf.ico">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
    <meta name="description" content="片刻寧靜">
    
    <link rel="preload" href="/assets/css/0.styles.0123fe10.css" as="style"><link rel="preload" href="/assets/js/app.bf2f8e4d.js" as="script"><link rel="preload" href="/assets/js/5.d83caa2b.js" as="script"><link rel="preload" href="/assets/js/94.b7e3a570.js" as="script"><link rel="prefetch" href="/assets/js/10.ffe7a5d7.js"><link rel="prefetch" href="/assets/js/100.28c1be49.js"><link rel="prefetch" href="/assets/js/101.a35c8a37.js"><link rel="prefetch" href="/assets/js/102.447fcb60.js"><link rel="prefetch" href="/assets/js/103.ec78c338.js"><link rel="prefetch" href="/assets/js/104.cb7c3161.js"><link rel="prefetch" href="/assets/js/105.0c6532d9.js"><link rel="prefetch" href="/assets/js/106.8cbfbab9.js"><link rel="prefetch" href="/assets/js/107.b48af86c.js"><link rel="prefetch" href="/assets/js/108.b369b330.js"><link rel="prefetch" href="/assets/js/109.936c8247.js"><link rel="prefetch" href="/assets/js/11.7e62b9fa.js"><link rel="prefetch" href="/assets/js/110.790e7ef6.js"><link rel="prefetch" href="/assets/js/111.456caa48.js"><link rel="prefetch" href="/assets/js/112.33e84330.js"><link rel="prefetch" href="/assets/js/113.2081e380.js"><link rel="prefetch" href="/assets/js/114.e0f1d70a.js"><link rel="prefetch" href="/assets/js/115.b0e26c09.js"><link rel="prefetch" href="/assets/js/116.9a635b8b.js"><link rel="prefetch" href="/assets/js/117.ad4d4efe.js"><link rel="prefetch" href="/assets/js/118.e340336c.js"><link rel="prefetch" href="/assets/js/119.f6ab61b7.js"><link rel="prefetch" href="/assets/js/12.62810708.js"><link rel="prefetch" href="/assets/js/120.2e05c840.js"><link rel="prefetch" href="/assets/js/121.a9203a01.js"><link rel="prefetch" href="/assets/js/122.f9394898.js"><link rel="prefetch" href="/assets/js/123.615cf68e.js"><link rel="prefetch" href="/assets/js/124.5cb38bfe.js"><link rel="prefetch" href="/assets/js/125.a01a6e38.js"><link rel="prefetch" href="/assets/js/126.8633cf75.js"><link rel="prefetch" href="/assets/js/127.52cf8ad7.js"><link rel="prefetch" href="/assets/js/128.92557d25.js"><link rel="prefetch" href="/assets/js/129.4675065f.js"><link rel="prefetch" href="/assets/js/13.286d0e4a.js"><link rel="prefetch" href="/assets/js/130.9aa15a02.js"><link rel="prefetch" href="/assets/js/131.c0af0982.js"><link rel="prefetch" href="/assets/js/132.3d8c7795.js"><link rel="prefetch" href="/assets/js/133.848c5091.js"><link rel="prefetch" href="/assets/js/134.eef51192.js"><link rel="prefetch" href="/assets/js/135.955e2193.js"><link rel="prefetch" href="/assets/js/136.3b70185d.js"><link rel="prefetch" href="/assets/js/137.f1cb7985.js"><link rel="prefetch" href="/assets/js/138.e79d4fc2.js"><link rel="prefetch" href="/assets/js/139.e7bcc40d.js"><link rel="prefetch" href="/assets/js/14.9d543c49.js"><link rel="prefetch" href="/assets/js/140.457a6dba.js"><link rel="prefetch" href="/assets/js/141.ace7e701.js"><link rel="prefetch" href="/assets/js/142.9d6bc002.js"><link rel="prefetch" href="/assets/js/143.e2e59301.js"><link rel="prefetch" href="/assets/js/144.8ce3f73e.js"><link rel="prefetch" href="/assets/js/145.d211bd71.js"><link rel="prefetch" href="/assets/js/146.04cf9ffb.js"><link rel="prefetch" href="/assets/js/147.2161f226.js"><link rel="prefetch" href="/assets/js/148.5bc459e8.js"><link rel="prefetch" href="/assets/js/149.b1624753.js"><link rel="prefetch" href="/assets/js/15.d4d1d36f.js"><link rel="prefetch" href="/assets/js/150.9afb6f9a.js"><link rel="prefetch" href="/assets/js/151.98443b25.js"><link rel="prefetch" href="/assets/js/152.5ae82907.js"><link rel="prefetch" href="/assets/js/153.26c2a957.js"><link rel="prefetch" href="/assets/js/154.3bdd7032.js"><link rel="prefetch" href="/assets/js/155.2f96fdcb.js"><link rel="prefetch" href="/assets/js/156.e8ae4821.js"><link rel="prefetch" href="/assets/js/157.7e25cbea.js"><link rel="prefetch" href="/assets/js/158.931c9aee.js"><link rel="prefetch" href="/assets/js/159.b30fc372.js"><link rel="prefetch" href="/assets/js/16.197e1a9c.js"><link rel="prefetch" href="/assets/js/160.0bc3c983.js"><link rel="prefetch" href="/assets/js/161.5fd4605d.js"><link rel="prefetch" href="/assets/js/162.82ba9d8c.js"><link rel="prefetch" href="/assets/js/163.18fd8644.js"><link rel="prefetch" href="/assets/js/164.549a1065.js"><link rel="prefetch" href="/assets/js/165.e6525636.js"><link rel="prefetch" href="/assets/js/166.47e81965.js"><link rel="prefetch" href="/assets/js/167.0b17171b.js"><link rel="prefetch" href="/assets/js/168.aa15f0e5.js"><link rel="prefetch" href="/assets/js/169.4b59ba0d.js"><link rel="prefetch" href="/assets/js/17.af839014.js"><link rel="prefetch" href="/assets/js/170.ba1f83b2.js"><link rel="prefetch" href="/assets/js/171.30c69b4d.js"><link rel="prefetch" href="/assets/js/172.827acd41.js"><link rel="prefetch" href="/assets/js/173.2e54c625.js"><link rel="prefetch" href="/assets/js/174.68599b7c.js"><link rel="prefetch" href="/assets/js/175.d5438d41.js"><link rel="prefetch" href="/assets/js/176.c5a7b576.js"><link rel="prefetch" href="/assets/js/177.9e5da251.js"><link rel="prefetch" href="/assets/js/178.7d4acfdc.js"><link rel="prefetch" href="/assets/js/18.cc84802b.js"><link rel="prefetch" href="/assets/js/19.e5133fa5.js"><link rel="prefetch" href="/assets/js/2.2ca08261.js"><link rel="prefetch" href="/assets/js/20.229f4f88.js"><link rel="prefetch" href="/assets/js/21.f3075006.js"><link rel="prefetch" href="/assets/js/22.f83d1ff6.js"><link rel="prefetch" href="/assets/js/23.0b516bb4.js"><link rel="prefetch" href="/assets/js/24.c107eb4d.js"><link rel="prefetch" href="/assets/js/25.33253bf6.js"><link rel="prefetch" href="/assets/js/26.bbf56fd6.js"><link rel="prefetch" href="/assets/js/27.e0dc6201.js"><link rel="prefetch" href="/assets/js/28.cb452276.js"><link rel="prefetch" href="/assets/js/29.aa6d870f.js"><link rel="prefetch" href="/assets/js/3.33d59adf.js"><link rel="prefetch" href="/assets/js/30.7b4acdda.js"><link rel="prefetch" href="/assets/js/31.2f90551f.js"><link rel="prefetch" href="/assets/js/32.8885364c.js"><link rel="prefetch" href="/assets/js/33.21cd792b.js"><link rel="prefetch" href="/assets/js/34.c812ec13.js"><link rel="prefetch" href="/assets/js/35.b875e794.js"><link rel="prefetch" href="/assets/js/36.596a9000.js"><link rel="prefetch" href="/assets/js/37.1704a578.js"><link rel="prefetch" href="/assets/js/38.d2888161.js"><link rel="prefetch" href="/assets/js/39.296408db.js"><link rel="prefetch" href="/assets/js/4.73eb1b84.js"><link rel="prefetch" href="/assets/js/40.3303ed8a.js"><link rel="prefetch" href="/assets/js/41.b68e00ce.js"><link rel="prefetch" href="/assets/js/42.5e6e71f2.js"><link rel="prefetch" href="/assets/js/43.9b200275.js"><link rel="prefetch" href="/assets/js/44.868df9e4.js"><link rel="prefetch" href="/assets/js/45.574e2a94.js"><link rel="prefetch" href="/assets/js/46.2c689197.js"><link rel="prefetch" href="/assets/js/47.02530dcb.js"><link rel="prefetch" href="/assets/js/48.440eff2d.js"><link rel="prefetch" href="/assets/js/49.49c49365.js"><link rel="prefetch" href="/assets/js/50.35141878.js"><link rel="prefetch" href="/assets/js/51.6178566f.js"><link rel="prefetch" href="/assets/js/52.170b8ff8.js"><link rel="prefetch" href="/assets/js/53.2b1f7061.js"><link rel="prefetch" href="/assets/js/54.21062edd.js"><link rel="prefetch" href="/assets/js/55.628b5d25.js"><link rel="prefetch" href="/assets/js/56.436ce91e.js"><link rel="prefetch" href="/assets/js/57.e16b944e.js"><link rel="prefetch" href="/assets/js/58.89392ff0.js"><link rel="prefetch" href="/assets/js/59.5fbb46d6.js"><link rel="prefetch" href="/assets/js/6.bf5b6366.js"><link rel="prefetch" href="/assets/js/60.5fe5cc42.js"><link rel="prefetch" href="/assets/js/61.db19f078.js"><link rel="prefetch" href="/assets/js/62.626ed4ee.js"><link rel="prefetch" href="/assets/js/63.71c02bfc.js"><link rel="prefetch" href="/assets/js/64.572610d2.js"><link rel="prefetch" href="/assets/js/65.f5f623c3.js"><link rel="prefetch" href="/assets/js/66.375a24bd.js"><link rel="prefetch" href="/assets/js/67.426b126f.js"><link rel="prefetch" href="/assets/js/68.cef7d353.js"><link rel="prefetch" href="/assets/js/69.1953d6a3.js"><link rel="prefetch" href="/assets/js/7.c41ea483.js"><link rel="prefetch" href="/assets/js/70.c4431111.js"><link rel="prefetch" href="/assets/js/71.a998cf9e.js"><link rel="prefetch" href="/assets/js/72.f54f7db9.js"><link rel="prefetch" href="/assets/js/73.62afdfa2.js"><link rel="prefetch" href="/assets/js/74.d2d20e08.js"><link rel="prefetch" href="/assets/js/75.8c1dac36.js"><link rel="prefetch" href="/assets/js/76.5c5a588d.js"><link rel="prefetch" href="/assets/js/77.f9e974a8.js"><link rel="prefetch" href="/assets/js/78.0469d7da.js"><link rel="prefetch" href="/assets/js/79.d7e2d358.js"><link rel="prefetch" href="/assets/js/8.c51855da.js"><link rel="prefetch" href="/assets/js/80.64710fa9.js"><link rel="prefetch" href="/assets/js/81.973df69b.js"><link rel="prefetch" href="/assets/js/82.31355a78.js"><link rel="prefetch" href="/assets/js/83.e9afdf67.js"><link rel="prefetch" href="/assets/js/84.ce46c220.js"><link rel="prefetch" href="/assets/js/85.0efe23b9.js"><link rel="prefetch" href="/assets/js/86.6dd50e52.js"><link rel="prefetch" href="/assets/js/87.46357c7a.js"><link rel="prefetch" href="/assets/js/88.c0a0f153.js"><link rel="prefetch" href="/assets/js/89.6c028854.js"><link rel="prefetch" href="/assets/js/9.077f98b4.js"><link rel="prefetch" href="/assets/js/90.b43beec4.js"><link rel="prefetch" href="/assets/js/91.cb42c7dd.js"><link rel="prefetch" href="/assets/js/92.764a4056.js"><link rel="prefetch" href="/assets/js/93.2f1feb18.js"><link rel="prefetch" href="/assets/js/95.1f512286.js"><link rel="prefetch" href="/assets/js/96.9197eeef.js"><link rel="prefetch" href="/assets/js/97.0e756bbf.js"><link rel="prefetch" href="/assets/js/98.fb27aac9.js"><link rel="prefetch" href="/assets/js/99.adffe607.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0123fe10.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.gif" alt="Northboat Blog" class="logo"> <span class="site-name can-hide">Northboat Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Home Page" class="dropdown-title"><span class="title">Home Page</span> <span class="arrow down"></span></button> <button type="button" aria-label="Home Page" class="mobile-dropdown-title"><span class="title">Home Page</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/" class="nav-link">
  Home
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/northboat" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github Profile
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="/lib/" class="nav-link">
  Liberal
</a></li><li class="dropdown-item"><!----> <a href="https://t.me/northboat" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Contact Me
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="2084 Full Stack" class="dropdown-title"><span class="title">2084 Full Stack</span> <span class="arrow down"></span></button> <button type="button" aria-label="2084 Full Stack" class="mobile-dropdown-title"><span class="title">2084 Full Stack</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dev/algo/" class="nav-link">
  Algorithm
</a></li><li class="dropdown-item"><!----> <a href="/dev/java/" class="nav-link">
  Java
</a></li><li class="dropdown-item"><!----> <a href="/dev/ops/" class="nav-link">
  Operations
</a></li><li class="dropdown-item"><!----> <a href="/dev/fe/" class="nav-link">
  Front End
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="NEUQ CS" class="dropdown-title"><span class="title">NEUQ CS</span> <span class="arrow down"></span></button> <button type="button" aria-label="NEUQ CS" class="mobile-dropdown-title"><span class="title">NEUQ CS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/408/ds/" class="nav-link">
  Data Structure
</a></li><li class="dropdown-item"><!----> <a href="/408/cn/" class="nav-link">
  Network
</a></li><li class="dropdown-item"><!----> <a href="/408/os/" class="nav-link">
  Operating System
</a></li><li class="dropdown-item"><!----> <a href="/408/co/" class="nav-link">
  Organization
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CS and ML" class="dropdown-title"><span class="title">CS and ML</span> <span class="arrow down"></span></button> <button type="button" aria-label="CS and ML" class="mobile-dropdown-title"><span class="title">CS and ML</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/cs/prog/" class="nav-link router-link-active">
  Programming
</a></li><li class="dropdown-item"><!----> <a href="/cs/math/" class="nav-link">
  Math
</a></li><li class="dropdown-item"><!----> <a href="/cs/is/" class="nav-link">
  Cyberspace Security
</a></li><li class="dropdown-item"><!----> <a href="/cs/ml/" class="nav-link">
  Machine Learning
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Home Page" class="dropdown-title"><span class="title">Home Page</span> <span class="arrow down"></span></button> <button type="button" aria-label="Home Page" class="mobile-dropdown-title"><span class="title">Home Page</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/" class="nav-link">
  Home
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/northboat" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github Profile
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="/lib/" class="nav-link">
  Liberal
</a></li><li class="dropdown-item"><!----> <a href="https://t.me/northboat" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Contact Me
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="2084 Full Stack" class="dropdown-title"><span class="title">2084 Full Stack</span> <span class="arrow down"></span></button> <button type="button" aria-label="2084 Full Stack" class="mobile-dropdown-title"><span class="title">2084 Full Stack</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dev/algo/" class="nav-link">
  Algorithm
</a></li><li class="dropdown-item"><!----> <a href="/dev/java/" class="nav-link">
  Java
</a></li><li class="dropdown-item"><!----> <a href="/dev/ops/" class="nav-link">
  Operations
</a></li><li class="dropdown-item"><!----> <a href="/dev/fe/" class="nav-link">
  Front End
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="NEUQ CS" class="dropdown-title"><span class="title">NEUQ CS</span> <span class="arrow down"></span></button> <button type="button" aria-label="NEUQ CS" class="mobile-dropdown-title"><span class="title">NEUQ CS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/408/ds/" class="nav-link">
  Data Structure
</a></li><li class="dropdown-item"><!----> <a href="/408/cn/" class="nav-link">
  Network
</a></li><li class="dropdown-item"><!----> <a href="/408/os/" class="nav-link">
  Operating System
</a></li><li class="dropdown-item"><!----> <a href="/408/co/" class="nav-link">
  Organization
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CS and ML" class="dropdown-title"><span class="title">CS and ML</span> <span class="arrow down"></span></button> <button type="button" aria-label="CS and ML" class="mobile-dropdown-title"><span class="title">CS and ML</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/cs/prog/" class="nav-link router-link-active">
  Programming
</a></li><li class="dropdown-item"><!----> <a href="/cs/math/" class="nav-link">
  Math
</a></li><li class="dropdown-item"><!----> <a href="/cs/is/" class="nav-link">
  Cyberspace Security
</a></li><li class="dropdown-item"><!----> <a href="/cs/ml/" class="nav-link">
  Machine Learning
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>C/C++</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Python3</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>数据科学库</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/cs/prog/lib/pylib-numpy.html" class="sidebar-link">Numpy</a></li><li><a href="/cs/prog/lib/pylib-pandas.html" class="sidebar-link">Pandas</a></li><li><a href="/cs/prog/lib/pylib-scipy.html" aria-current="page" class="active sidebar-link">Scipy</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cs/prog/lib/pylib-scipy.html#intro" class="sidebar-link">Intro</a></li><li class="sidebar-sub-header"><a href="/cs/prog/lib/pylib-scipy.html#optimize" class="sidebar-link">Optimize</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cs/prog/lib/pylib-scipy.html#非线性方程组求解" class="sidebar-link">非线性方程组求解</a></li><li class="sidebar-sub-header"><a href="/cs/prog/lib/pylib-scipy.html#最小二乘拟合" class="sidebar-link">最小二乘拟合</a></li><li class="sidebar-sub-header"><a href="/cs/prog/lib/pylib-scipy.html#计算局域最小值" class="sidebar-link">计算局域最小值</a></li><li class="sidebar-sub-header"><a href="/cs/prog/lib/pylib-scipy.html#计算全域最小值" class="sidebar-link">计算全域最小值</a></li></ul></li><li class="sidebar-sub-header"><a href="/cs/prog/lib/pylib-scipy.html#spatial" class="sidebar-link">Spatial</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cs/prog/lib/pylib-scipy.html#最近旁点" class="sidebar-link">最近旁点</a></li></ul></li></ul></li><li><a href="/cs/prog/lib/pylib-matplotlib.html" class="sidebar-link">Matplotlib</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>PHP</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><blockquote><p>Scipy是一个用于数学、科学、工程领域的常用软件包，是一个数值计算库，可以处理插值、积分、优化、图像处理、常微分方程数值解的求解、信号处理等问题</p> <p>它能够有效计算Numpy矩阵，使Numpy和Scipy协同工作，高效处理数据</p></blockquote> <h2 id="intro">Intro</h2> <p>导入</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>import numpy as np
import scipy
import matplotlib.pyplot as plt

print(scipy.__version__)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><code>pyplot</code>是绘图库<code>matplotlib</code>下的一个模块</p> <ul><li><code>pyplot</code>和<code>matlab</code>高度相似</li> <li>还有另一个模块叫做<code>pylab</code>，<code>pylab = pyplot + 部分numpy</code>，更加冗余</li> <li>引入<code>pylab</code>不用加<code>maplotlib</code>，即直接<code>import pylab</code></li></ul> <p>常数和特殊函数</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>from scipy import constants as C

# 真空光速
print(C.c)
# 普朗克常数
print(C.h)
# pyysical_constants是一个常量字典，物理常量名为键，对应一个三元组，分别为常数值、单位和误差
print(C.physical_constants[&quot;electron mass&quot;])

# 1英里等于多少米, 1英寸等于多少米, 1克等于多少千克, 1磅等于多少千克
print(C.mile)
print(C.inch)
print(C.gram)
print(C.pound)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>科学计算</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>import scipy.special as S

print (1 + 1e-20)
print (np.log(1+1e-20))
print (S.log1p(1e-20))
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>线代计算</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>m = np.linspace(0.1, 0.9, 4)
u = np.linspace(-10, 10, 200)
results = S.ellipj(u[:, None], m[None, :])

print([y.shape for y in results])
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>绘图</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>m = np.linspace(0.1, 0.9, 4)
u = np.linspace(-10, 10, 200)
results = S.ellipj(u[:, None], m[None, :])
#%figonly=使用广播计算得到的`ellipj()`返回值
fig, axes = plt.subplots(2, 2, figsize=(12, 4))
labels = [&quot;$sn$&quot;, &quot;$cn$&quot;, &quot;$dn$&quot;, &quot;$\phi$&quot;]
for ax, y, label in zip(axes.ravel(), results, labels):
    ax.plot(u, y)
    ax.set_ylabel(label)
    ax.margins(0, 0.1)
    
axes[1, 1].legend([&quot;$m={:g}$&quot;.format(m_) for m_ in m], loc=&quot;best&quot;, ncol=2);
plt.show()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><img src="/assets/img/Figure_4.a310a03c.png"> <h2 id="optimize">Optimize</h2> <blockquote><p>拟合与优化</p></blockquote> <div class="language-python line-numbers-mode"><pre class="language-text"><code>import matplotlib.pyplot as plt
import numpy as np
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="非线性方程组求解">非线性方程组求解</h3> <p>从<code>math</code>库中引入<code>sin,cos</code>函数，引入<code>scipy</code>的<code>potimize</code>模块</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>from math import sin,cos
from scipy import optimize

def f(x):
    x0,x1,x2 = x.tolist()
    return [5*x1+3, 4*x0**2-2*sin(x1*x2), x1*x2-1.5]

result = optimize.fsolve(f, [1,1,1])
print(result)
print(f(result))
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><ul><li><p><code>fsolve</code>的第一个参数为方程组，第二个参数为未知数初始值</p></li> <li><p>方程组的形式由一个数组返回，<code>=0</code>省略，如上述代码表示方程组
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>5</mn><mo>×</mo><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mn>3</mn><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>4</mn><mo>×</mo><msubsup><mi>x</mi><mn>0</mn><mn>2</mn></msubsup><mo>−</mo><mn>2</mn><mi>sin</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>×</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>×</mo><msub><mi>x</mi><mn>2</mn></msub><mo>−</mo><mn>1.5</mn><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\begin{cases}
5\times x_1+3=0\\
4\times x_0^2-2\sin{(x_1\times x_2)}=0\\
x_1\times x_2-1.5=0
\end{cases}
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:4.32em;vertical-align:-1.91em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35em;"><span style="top:-2.2em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.192em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.316em" viewBox="0 0 888.89 316" preserveAspectRatio="xMinYMin" style="width:0.8889em;"><path d="M384 0 H504 V316 H384z M384 0 H504 V316 H384z"></path></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.316em" viewBox="0 0 888.89 316" preserveAspectRatio="xMinYMin" style="width:0.8889em;"><path d="M384 0 H504 V316 H384z M384 0 H504 V316 H384z"></path></svg></span></span><span style="top:-4.6em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.85em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">5</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0</span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">4</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0</span></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1.5</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></eqn></section></p></li> <li><p>该函数使用最速梯度下降法求解局部最优解，故要设置未知数的初始值</p></li></ul> <p>最速（梯度）下降法，先求原函数在原点的梯度，再设步长并求出使函数值最小的步长，原点减去步长乘以梯度得次点，令次点为原点，重复以上操作</p> <ul><li><p>梯度：偏导的集合</p></li> <li><p>对于上述方程组，其对应函数为
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mn>4</mn><msubsup><mi>x</mi><mn>0</mn><mn>2</mn></msubsup><mo>+</mo><mn>5</mn><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><mn>2</mn><mi>sin</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><mo>+</mo><msub><mi>x</mi><mn>1</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><mn>1.5</mn></mrow><annotation encoding="application/x-tex">
f(x_0,x_1,x_2)=4x_0^2+5x_1-2\sin{(x_1x_2)}+x_1x_2+1.5
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1111em;vertical-align:-0.247em;"></span><span class="mord">4</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7944em;vertical-align:-0.15em;"></span><span class="mord">5</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1.5</span></span></span></span></span></eqn></section></p></li> <li><p>其偏导即为
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>f</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">[</mo><msubsup><mi>f</mi><msub><mi>x</mi><mn>0</mn></msub><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><msubsup><mi>f</mi><msub><mi>x</mi><mn>1</mn></msub><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><msubsup><mi>f</mi><msub><mi>x</mi><mn>2</mn></msub><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">
f'(x)=[f_{x_0}'(x_0), f_{x_1}'(x_1), f_{x_2}'(x_2)]
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.0519em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.149em;vertical-align:-0.3471em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-2.453em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3471em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-2.453em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3471em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-2.453em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3471em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)]</span></span></span></span></span></eqn></section></p></li> <li><p>代入<code>[1,1,1]</code>即为原点的梯度</p></li> <li><p>令<code>f(1,1,1)-af'(1,1,1)</code>取最小值，求得步长<code>a</code></p></li> <li><p>次点即为<code>[1,1,1]-af'(1,1,1)</code></p></li></ul> <div class="language-python line-numbers-mode"><pre class="language-text"><code>def g(x):
    return [[0, 5, 0],
           [8*x[0], -2*cos(x[1]*x[2]), -2*x[1]*cos(x[1]*x[2])],
           [0, x[2], x[1]]]
result1 = optimize.fsolve(f, [1,1,1], fprime=g)
print(result1) 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li><p><code>fprime</code>： 可调用 <code>f(x, *args)</code> ，可选</p> <p>用于计算 func 的雅可比行列式的函数，该函数具有跨行的导数。默认情况下，将估计雅可比行列式</p></li></ul> <h3 id="最小二乘拟合">最小二乘拟合</h3> <blockquote><p>最小二乘法（又称最小平方法）是一种数学优化技术。它通过最小化误差的平方和寻找数据的最佳函数匹配。利用最小二乘法可以简便地求得未知的数据，并使得这些求得的数据与实际数据之间误差的平方和为最小</p> <p>最小二乘法还可用于曲线拟合，其他一些优化问题也可通过最小化能量或最大化熵用最小二乘法来表达</p></blockquote> <p>简单来说，就是通过构造函数，使计算结果和已知数据的平方差最小</p> <p>使用<code>optimize.leastsq</code>拟合一次函数</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>X = np.array([ 8.19,  2.72,  6.39,  8.71,  4.7 ,  2.66,  3.78])
Y = np.array([ 7.01,  2.78,  6.47,  6.71,  4.1 ,  4.23,  4.05])

def residuals(p):
    &quot;计算以p为参数的直线和原始数据之间的误差&quot;
    k, b = p
    return Y - (k*X + b)

# leastsq使得residuals()的输出数组的平方和最小，参数的初始值为[1,0]
r = optimize.leastsq(residuals, [1, 0])
k, b = r[0]
print (&quot;k =&quot;,k, &quot;b =&quot;,b)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><ul><li>拟合的结果<code>r[0]</code>为一个向量，按函数<code>residuals</code>入参<code>p</code>的顺序存放着未知参数的估计值</li></ul> <h3 id="计算局域最小值">计算局域最小值</h3> <h3 id="计算全域最小值">计算全域最小值</h3> <h2 id="spatial">Spatial</h2> <blockquote><p>空间算法库</p></blockquote> <h3 id="最近旁点">最近旁点</h3> <p>对于一维序列，寻找最近旁点</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>import numpy as np
from scipy import spatial

x = np.sort(np.random.rand(100))
# print(x)

idx = np.searchsorted(x,0.5)
print(x[idx], x[idx-1])
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li><code>np.random.rand</code>将随机生成<code>[0,1)</code>的浮点数，接收参数整型为生成浮点数个数</li> <li>用<code>np.searchsorted(迭代器, 数)</code>寻找最近旁点的下标（取上限），即最近的大于该数的数组元素的下标（自然最近旁点有可能是<code>x[idx-1]</code>，即最近的小于该数的元素下标）</li></ul> <p>对于二维的点阵，寻找最近旁点：用<code>cKDTree</code>寻找</p> <p>1、<code>query</code></p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>np.random.seed(42)
N = 100
# 生成(-1,1)的随机数共一百行，每行两列
points = np.random.uniform(-1,1,(N,2))
kd = spatial.cKDTree(points)
# 要寻找旁点的点
targets = np.array([[0, 0], [0.5, 0.5],
                    [-0.5, 0.5], [0.5, -0.5],
                    [-0.5, -0.5]])
print(targets)
dist, idx = kd.query(targets, 3)
print(dist)
print(idx)
print(points[83])
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><ul><li><code>np.random.seed(42)</code>对随机数做种，使每次生成的随机数一样，<code>seed()</code>无参实际上就是随便调了一个整型做种生成随机数</li> <li><code>kd = spatial.cKDTree(points)</code>对已知所有点构造<code>cKDTree</code></li> <li>用<code>np.array()</code>构造目标点</li> <li>用<code>query(targets, 3)</code>搜索最近旁点，<code>3</code>表示搜索最近的三个旁点，因为一共五个目标点，所以结果是一个<code>5x3</code>的矩阵，每行表示一个目标点的<code>3</code>旁点</li> <li><code>query</code>返回的两个值分别为
<ul><li><code>dist</code>：旁点距目标点距离</li> <li><code>idx</code>：旁点在<code>points</code>的下标</li></ul></li></ul> <p>2、<code>query_ball_point</code></p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>r = 0.2
idx2 = kd.query_ball_point(targets, r)
print(idx2)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>targets</code>同上，为目标点矩阵</li> <li><code>r</code>为旁点距目标点最大距离，意思是将返回距目标点<code>距离&lt;r</code>的点的坐标</li> <li>返回的是一个<code>list</code>数组，每个<code>list</code>储存一个目标点的旁点下标</li></ul> <p>3、<code>query_pairs</code></p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>idx3 = kd.query_pairs(0.1)-kd.query_pairs(0.08)
print(idx3)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>query_pairs(r)</code>返回的是一个<code>set</code>集合，集合中存的数据是一对对下标，如<code>(11,97)</code>，意思是<code>points[11]</code>和<code>points[97]</code>之间的距离小于<code>r</code></li> <li>用<code>set</code>集合减去<code>set</code>，即去掉前者中和后者共有的元素，如上述代码表示距离小于<code>0.1</code>但大于<code>0.08</code>的点对</li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">7/27/2023, 2:21:23 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/cs/prog/lib/pylib-pandas.html" class="prev">
        Pandas
      </a></span> <span class="next"><a href="/cs/prog/lib/pylib-matplotlib.html">
        Matplotlib
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><div class="reco-bgm-panel" data-v-b1d3339e><audio id="bgm" src="/song/aries.aac" data-v-b1d3339e></audio> <div class="reco-float-box" style="bottom:44px;z-index:999999;display:none;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><img src="/img/error.jpg" data-v-b1d3339e></div> <div class="reco-bgm-box" style="left:10px;bottom:10px;z-index:999999;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="reco-bgm-cover" style="background-image:url(/img/error.jpg);" data-v-b1d3339e><div class="mini-operation" style="display:none;" data-v-b1d3339e><i class="reco-bgm reco-bgm-pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play" style="display:none;" data-v-b1d3339e></i></div> <div class="falut-message" style="display:none;" data-v-b1d3339e>
          播放失败
        </div></div> <div class="reco-bgm-info" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-music music" data-v-b1d3339e></i>白羊</div> <div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-artist" data-v-b1d3339e></i>northboat</div> <div class="reco-bgm-progress" data-v-b1d3339e><div class="progress-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div> <div class="reco-bgm-operation" data-v-b1d3339e><i class="reco-bgm reco-bgm-last last" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-pause pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play play" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-next next" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-volume1 volume" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-mute mute" style="display:none;" data-v-b1d3339e></i> <div class="volume-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div></div> <div class="reco-bgm-left-box" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><i class="reco-bgm reco-bgm-left" data-v-b1d3339e></i></div></div></div><!----><div class="RibbonAnimation"></div><div class="Sakura" data-v-248d85d6><canvas id="canvas_sakura" style="z-index:99;" data-v-248d85d6></canvas></div></div></div>
    <script src="/assets/js/app.bf2f8e4d.js" defer></script><script src="/assets/js/5.d83caa2b.js" defer></script><script src="/assets/js/94.b7e3a570.js" defer></script>
  </body>
</html>
