<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Pandas | Northboat Dock</title>
    <meta name="generator" content="VuePress 1.9.8">
    <link rel="icon" href="/img/leaf.ico">
    <link rel="stylesheet" href="/css/katex0.15.1.min.css">
    <script src="/js/katex0.15.1.min.js"></script>
    <script src="/js/jquery1.9.1.min.js"></script>
    <script src="/js/crypto.js"></script>
    <script src="/js/md5.js"></script>
    <link rel="stylesheet" href="/css/button.css">
    <meta name="description" content="片刻寧靜">
    
    <link rel="preload" href="/assets/css/0.styles.70e1d524.css" as="style"><link rel="preload" href="/assets/js/app.bc86f6a3.js" as="script"><link rel="preload" href="/assets/js/6.2002952c.js" as="script"><link rel="preload" href="/assets/js/79.9e3702ee.js" as="script"><link rel="prefetch" href="/assets/js/10.0e24d1f8.js"><link rel="prefetch" href="/assets/js/100.3387f88c.js"><link rel="prefetch" href="/assets/js/101.a520d44d.js"><link rel="prefetch" href="/assets/js/102.6c411f39.js"><link rel="prefetch" href="/assets/js/103.830d9ae8.js"><link rel="prefetch" href="/assets/js/104.7fe72c7f.js"><link rel="prefetch" href="/assets/js/105.31132c0b.js"><link rel="prefetch" href="/assets/js/106.42d2dd65.js"><link rel="prefetch" href="/assets/js/107.274103f9.js"><link rel="prefetch" href="/assets/js/108.63607c58.js"><link rel="prefetch" href="/assets/js/109.b16ad3c0.js"><link rel="prefetch" href="/assets/js/11.36d4a8ce.js"><link rel="prefetch" href="/assets/js/110.e597c1a2.js"><link rel="prefetch" href="/assets/js/111.673ef647.js"><link rel="prefetch" href="/assets/js/112.d4b57c1d.js"><link rel="prefetch" href="/assets/js/113.d88c4a3a.js"><link rel="prefetch" href="/assets/js/114.bed8a373.js"><link rel="prefetch" href="/assets/js/115.d0bec5d4.js"><link rel="prefetch" href="/assets/js/116.04dbe307.js"><link rel="prefetch" href="/assets/js/117.48b44a23.js"><link rel="prefetch" href="/assets/js/118.afc43826.js"><link rel="prefetch" href="/assets/js/119.380a1bff.js"><link rel="prefetch" href="/assets/js/12.dd6d86a1.js"><link rel="prefetch" href="/assets/js/120.abf20b98.js"><link rel="prefetch" href="/assets/js/121.5a6b521a.js"><link rel="prefetch" href="/assets/js/122.6c6dbf8b.js"><link rel="prefetch" href="/assets/js/123.bd71ba73.js"><link rel="prefetch" href="/assets/js/124.b05e73b5.js"><link rel="prefetch" href="/assets/js/125.178b18a8.js"><link rel="prefetch" href="/assets/js/126.fde55263.js"><link rel="prefetch" href="/assets/js/127.22044820.js"><link rel="prefetch" href="/assets/js/128.327b1ab0.js"><link rel="prefetch" href="/assets/js/129.34651b62.js"><link rel="prefetch" href="/assets/js/13.ce64d39a.js"><link rel="prefetch" href="/assets/js/130.0eec2fbb.js"><link rel="prefetch" href="/assets/js/131.8c76c472.js"><link rel="prefetch" href="/assets/js/132.58cc93e6.js"><link rel="prefetch" href="/assets/js/133.587daf0b.js"><link rel="prefetch" href="/assets/js/134.3c677117.js"><link rel="prefetch" href="/assets/js/135.619ef1df.js"><link rel="prefetch" href="/assets/js/136.8385bf6d.js"><link rel="prefetch" href="/assets/js/137.fe6f02c7.js"><link rel="prefetch" href="/assets/js/138.6793f4f2.js"><link rel="prefetch" href="/assets/js/139.d8031a6c.js"><link rel="prefetch" href="/assets/js/14.505935ef.js"><link rel="prefetch" href="/assets/js/140.8f3a6439.js"><link rel="prefetch" href="/assets/js/141.a1527188.js"><link rel="prefetch" href="/assets/js/142.44833a69.js"><link rel="prefetch" href="/assets/js/143.c4f6a2da.js"><link rel="prefetch" href="/assets/js/144.38d6e13a.js"><link rel="prefetch" href="/assets/js/145.d9437365.js"><link rel="prefetch" href="/assets/js/146.ee98d52e.js"><link rel="prefetch" href="/assets/js/147.f4a2f3ee.js"><link rel="prefetch" href="/assets/js/148.3ebe4b7d.js"><link rel="prefetch" href="/assets/js/149.8cce7075.js"><link rel="prefetch" href="/assets/js/15.1f6b807d.js"><link rel="prefetch" href="/assets/js/150.5d4d8f46.js"><link rel="prefetch" href="/assets/js/151.21b96a8d.js"><link rel="prefetch" href="/assets/js/152.0f5651b5.js"><link rel="prefetch" href="/assets/js/153.3abe32f1.js"><link rel="prefetch" href="/assets/js/154.826741fb.js"><link rel="prefetch" href="/assets/js/155.d308fb44.js"><link rel="prefetch" href="/assets/js/156.2fd6808d.js"><link rel="prefetch" href="/assets/js/157.e2231d0e.js"><link rel="prefetch" href="/assets/js/158.ed580ca6.js"><link rel="prefetch" href="/assets/js/159.1a032c5e.js"><link rel="prefetch" href="/assets/js/16.6c5c491e.js"><link rel="prefetch" href="/assets/js/160.4365051a.js"><link rel="prefetch" href="/assets/js/161.8ed7081d.js"><link rel="prefetch" href="/assets/js/162.46e48e94.js"><link rel="prefetch" href="/assets/js/163.aad18c71.js"><link rel="prefetch" href="/assets/js/164.90b29a9f.js"><link rel="prefetch" href="/assets/js/165.d475f07d.js"><link rel="prefetch" href="/assets/js/166.229b5482.js"><link rel="prefetch" href="/assets/js/167.49d5d2d7.js"><link rel="prefetch" href="/assets/js/168.04d7ffa1.js"><link rel="prefetch" href="/assets/js/169.ea8fd1d0.js"><link rel="prefetch" href="/assets/js/17.1c1a82ae.js"><link rel="prefetch" href="/assets/js/170.bdc78a3d.js"><link rel="prefetch" href="/assets/js/171.efefbfa6.js"><link rel="prefetch" href="/assets/js/172.76b02a79.js"><link rel="prefetch" href="/assets/js/173.c3861386.js"><link rel="prefetch" href="/assets/js/174.59063021.js"><link rel="prefetch" href="/assets/js/175.ac4c5202.js"><link rel="prefetch" href="/assets/js/176.3d2b0ede.js"><link rel="prefetch" href="/assets/js/177.5807cd6e.js"><link rel="prefetch" href="/assets/js/178.be4bd3f0.js"><link rel="prefetch" href="/assets/js/179.2d2f0b79.js"><link rel="prefetch" href="/assets/js/18.ea8c889f.js"><link rel="prefetch" href="/assets/js/180.87be4742.js"><link rel="prefetch" href="/assets/js/181.b50cc40d.js"><link rel="prefetch" href="/assets/js/182.77a25c8e.js"><link rel="prefetch" href="/assets/js/19.44fcd3de.js"><link rel="prefetch" href="/assets/js/2.e0b3969e.js"><link rel="prefetch" href="/assets/js/20.814f61f4.js"><link rel="prefetch" href="/assets/js/21.b1ea136f.js"><link rel="prefetch" href="/assets/js/22.dddf782e.js"><link rel="prefetch" href="/assets/js/23.e43e1a39.js"><link rel="prefetch" href="/assets/js/24.1bad6713.js"><link rel="prefetch" href="/assets/js/25.6f4263e8.js"><link rel="prefetch" href="/assets/js/26.fbf1eeb6.js"><link rel="prefetch" href="/assets/js/27.b33105aa.js"><link rel="prefetch" href="/assets/js/28.921059e1.js"><link rel="prefetch" href="/assets/js/29.1ed888b4.js"><link rel="prefetch" href="/assets/js/3.3af0c581.js"><link rel="prefetch" href="/assets/js/30.40e93d30.js"><link rel="prefetch" href="/assets/js/31.3880c077.js"><link rel="prefetch" href="/assets/js/32.06100d8e.js"><link rel="prefetch" href="/assets/js/33.631fa087.js"><link rel="prefetch" href="/assets/js/34.e3eed8b7.js"><link rel="prefetch" href="/assets/js/35.1977141f.js"><link rel="prefetch" href="/assets/js/36.607f34f6.js"><link rel="prefetch" href="/assets/js/37.25abe06d.js"><link rel="prefetch" href="/assets/js/38.a89d33ab.js"><link rel="prefetch" href="/assets/js/39.1d08e61b.js"><link rel="prefetch" href="/assets/js/4.0ba7a754.js"><link rel="prefetch" href="/assets/js/40.b6bedd91.js"><link rel="prefetch" href="/assets/js/41.d299acb3.js"><link rel="prefetch" href="/assets/js/42.91fbf2aa.js"><link rel="prefetch" href="/assets/js/43.469c79dd.js"><link rel="prefetch" href="/assets/js/44.d1c7f0b9.js"><link rel="prefetch" href="/assets/js/45.326d35a8.js"><link rel="prefetch" href="/assets/js/46.6b173ac9.js"><link rel="prefetch" href="/assets/js/47.87868374.js"><link rel="prefetch" href="/assets/js/48.a9e51de3.js"><link rel="prefetch" href="/assets/js/49.be39c9ed.js"><link rel="prefetch" href="/assets/js/5.b3d39676.js"><link rel="prefetch" href="/assets/js/50.c7384eae.js"><link rel="prefetch" href="/assets/js/51.a31a7b8f.js"><link rel="prefetch" href="/assets/js/52.1edf63f7.js"><link rel="prefetch" href="/assets/js/53.d708f29e.js"><link rel="prefetch" href="/assets/js/54.bfcc53c2.js"><link rel="prefetch" href="/assets/js/55.1a3a9079.js"><link rel="prefetch" href="/assets/js/56.c200b94f.js"><link rel="prefetch" href="/assets/js/57.4b63e7a8.js"><link rel="prefetch" href="/assets/js/58.5026a694.js"><link rel="prefetch" href="/assets/js/59.96db1330.js"><link rel="prefetch" href="/assets/js/60.ef18395d.js"><link rel="prefetch" href="/assets/js/61.589a9342.js"><link rel="prefetch" href="/assets/js/62.4395c1b4.js"><link rel="prefetch" href="/assets/js/63.f3e1151b.js"><link rel="prefetch" href="/assets/js/64.a4f97bca.js"><link rel="prefetch" href="/assets/js/65.23dba830.js"><link rel="prefetch" href="/assets/js/66.f1b64901.js"><link rel="prefetch" href="/assets/js/67.c768be7d.js"><link rel="prefetch" href="/assets/js/68.a28c10ee.js"><link rel="prefetch" href="/assets/js/69.8bc62fca.js"><link rel="prefetch" href="/assets/js/7.f0ab890a.js"><link rel="prefetch" href="/assets/js/70.1deae583.js"><link rel="prefetch" href="/assets/js/71.98cf3c87.js"><link rel="prefetch" href="/assets/js/72.ae900dad.js"><link rel="prefetch" href="/assets/js/73.f1568946.js"><link rel="prefetch" href="/assets/js/74.6c3233a4.js"><link rel="prefetch" href="/assets/js/75.cf5ddb5f.js"><link rel="prefetch" href="/assets/js/76.ac9c393b.js"><link rel="prefetch" href="/assets/js/77.76f9997f.js"><link rel="prefetch" href="/assets/js/78.73b566a5.js"><link rel="prefetch" href="/assets/js/8.0535ebf7.js"><link rel="prefetch" href="/assets/js/80.04eac001.js"><link rel="prefetch" href="/assets/js/81.6cc19641.js"><link rel="prefetch" href="/assets/js/82.95749901.js"><link rel="prefetch" href="/assets/js/83.1a42d8a2.js"><link rel="prefetch" href="/assets/js/84.dcc0ba3a.js"><link rel="prefetch" href="/assets/js/85.588686dd.js"><link rel="prefetch" href="/assets/js/86.44611273.js"><link rel="prefetch" href="/assets/js/87.fcb003ec.js"><link rel="prefetch" href="/assets/js/88.826e2e6e.js"><link rel="prefetch" href="/assets/js/89.fcd78787.js"><link rel="prefetch" href="/assets/js/9.06e12aa2.js"><link rel="prefetch" href="/assets/js/90.5dd77648.js"><link rel="prefetch" href="/assets/js/91.2f7f6cd2.js"><link rel="prefetch" href="/assets/js/92.d1095fd6.js"><link rel="prefetch" href="/assets/js/93.6d33f23b.js"><link rel="prefetch" href="/assets/js/94.9cbca204.js"><link rel="prefetch" href="/assets/js/95.63848009.js"><link rel="prefetch" href="/assets/js/96.f5316807.js"><link rel="prefetch" href="/assets/js/97.3e4a14e6.js"><link rel="prefetch" href="/assets/js/98.f047ba1d.js"><link rel="prefetch" href="/assets/js/99.ff26f979.js">
    <link rel="stylesheet" href="/assets/css/0.styles.70e1d524.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/error.jpg" alt="Northboat Dock" class="logo"> <span class="site-name can-hide">Northboat Dock</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Home Page" class="dropdown-title"><span class="title">Home Page</span> <span class="arrow down"></span></button> <button type="button" aria-label="Home Page" class="mobile-dropdown-title"><span class="title">Home Page</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/" class="nav-link">
  Home
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/northboat" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="/lib/" class="nav-link">
  Library
</a></li><li class="dropdown-item"><!----> <a href="https://t.me/northboat" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Telegram
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="2084 Full Stack Dev" class="dropdown-title"><span class="title">2084 Full Stack Dev</span> <span class="arrow down"></span></button> <button type="button" aria-label="2084 Full Stack Dev" class="mobile-dropdown-title"><span class="title">2084 Full Stack Dev</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dev/algo/" class="nav-link">
  Algorithm
</a></li><li class="dropdown-item"><!----> <a href="/dev/java/" class="nav-link">
  Java
</a></li><li class="dropdown-item"><!----> <a href="/dev/ops/" class="nav-link">
  Operations
</a></li><li class="dropdown-item"><!----> <a href="/dev/fe/" class="nav-link">
  Front End
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CS and ML" class="dropdown-title"><span class="title">CS and ML</span> <span class="arrow down"></span></button> <button type="button" aria-label="CS and ML" class="mobile-dropdown-title"><span class="title">CS and ML</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/cs/prog/" class="nav-link router-link-active">
  Programming
</a></li><li class="dropdown-item"><!----> <a href="/cs/math/" class="nav-link">
  Math
</a></li><li class="dropdown-item"><!----> <a href="/cs/cs/" class="nav-link">
  Cyberspace Security
</a></li><li class="dropdown-item"><!----> <a href="/cs/ml/" class="nav-link">
  Machine Learning
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="NEUQ Computer Science" class="dropdown-title"><span class="title">NEUQ Computer Science</span> <span class="arrow down"></span></button> <button type="button" aria-label="NEUQ Computer Science" class="mobile-dropdown-title"><span class="title">NEUQ Computer Science</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/408/ds/" class="nav-link">
  Data Structure
</a></li><li class="dropdown-item"><!----> <a href="/408/cn/" class="nav-link">
  Network
</a></li><li class="dropdown-item"><!----> <a href="/408/os/" class="nav-link">
  Operating System
</a></li><li class="dropdown-item"><!----> <a href="/408/co/" class="nav-link">
  Organization
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Home Page" class="dropdown-title"><span class="title">Home Page</span> <span class="arrow down"></span></button> <button type="button" aria-label="Home Page" class="mobile-dropdown-title"><span class="title">Home Page</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/" class="nav-link">
  Home
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/northboat" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="/lib/" class="nav-link">
  Library
</a></li><li class="dropdown-item"><!----> <a href="https://t.me/northboat" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Telegram
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="2084 Full Stack Dev" class="dropdown-title"><span class="title">2084 Full Stack Dev</span> <span class="arrow down"></span></button> <button type="button" aria-label="2084 Full Stack Dev" class="mobile-dropdown-title"><span class="title">2084 Full Stack Dev</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dev/algo/" class="nav-link">
  Algorithm
</a></li><li class="dropdown-item"><!----> <a href="/dev/java/" class="nav-link">
  Java
</a></li><li class="dropdown-item"><!----> <a href="/dev/ops/" class="nav-link">
  Operations
</a></li><li class="dropdown-item"><!----> <a href="/dev/fe/" class="nav-link">
  Front End
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CS and ML" class="dropdown-title"><span class="title">CS and ML</span> <span class="arrow down"></span></button> <button type="button" aria-label="CS and ML" class="mobile-dropdown-title"><span class="title">CS and ML</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/cs/prog/" class="nav-link router-link-active">
  Programming
</a></li><li class="dropdown-item"><!----> <a href="/cs/math/" class="nav-link">
  Math
</a></li><li class="dropdown-item"><!----> <a href="/cs/cs/" class="nav-link">
  Cyberspace Security
</a></li><li class="dropdown-item"><!----> <a href="/cs/ml/" class="nav-link">
  Machine Learning
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="NEUQ Computer Science" class="dropdown-title"><span class="title">NEUQ Computer Science</span> <span class="arrow down"></span></button> <button type="button" aria-label="NEUQ Computer Science" class="mobile-dropdown-title"><span class="title">NEUQ Computer Science</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/408/ds/" class="nav-link">
  Data Structure
</a></li><li class="dropdown-item"><!----> <a href="/408/cn/" class="nav-link">
  Network
</a></li><li class="dropdown-item"><!----> <a href="/408/os/" class="nav-link">
  Operating System
</a></li><li class="dropdown-item"><!----> <a href="/408/co/" class="nav-link">
  Organization
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>C/C++</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Python3</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>数据科学库</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/cs/prog/lib/pylib-numpy.html" class="sidebar-link">Numpy</a></li><li><a href="/cs/prog/lib/pylib-pandas.html" aria-current="page" class="active sidebar-link">Pandas</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cs/prog/lib/pylib-pandas.html#pandas-for-beginner" class="sidebar-link">Pandas For Beginner</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cs/prog/lib/pylib-pandas.html#series" class="sidebar-link">Series</a></li><li class="sidebar-sub-header"><a href="/cs/prog/lib/pylib-pandas.html#dataframe" class="sidebar-link">DataFrame</a></li><li class="sidebar-sub-header"><a href="/cs/prog/lib/pylib-pandas.html#选择数据" class="sidebar-link">选择数据</a></li><li class="sidebar-sub-header"><a href="/cs/prog/lib/pylib-pandas.html#设置值" class="sidebar-link">设置值</a></li><li class="sidebar-sub-header"><a href="/cs/prog/lib/pylib-pandas.html#处理丢失数据" class="sidebar-link">处理丢失数据</a></li><li class="sidebar-sub-header"><a href="/cs/prog/lib/pylib-pandas.html#导入导出" class="sidebar-link">导入导出</a></li><li class="sidebar-sub-header"><a href="/cs/prog/lib/pylib-pandas.html#合并操作" class="sidebar-link">合并操作</a></li><li class="sidebar-sub-header"><a href="/cs/prog/lib/pylib-pandas.html#plot出图" class="sidebar-link">plot出图</a></li></ul></li><li class="sidebar-sub-header"><a href="/cs/prog/lib/pylib-pandas.html#pandas-50" class="sidebar-link">Pandas 50</a></li></ul></li><li><a href="/cs/prog/lib/pylib-scipy.html" class="sidebar-link">Scipy</a></li><li><a href="/cs/prog/lib/pylib-matplotlib.html" class="sidebar-link">Matplotlib</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>PHP</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><blockquote><p>Pandas是基于Numpy构建的库，目的是让Numpy为中心的应用变得更加简单</p></blockquote> <h2 id="pandas-for-beginner">Pandas For Beginner</h2> <h3 id="series">Series</h3> <p>创建一个系列</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code># Series
s = pd.Series([1,3,6,np.nan,44,1], index=[6,5,4,3,2,1])
print(s)
s.index = [1,2,3,4,5,6]
print(s)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>系列即一串带有索引的数据</li></ul> <p>其输出结果为</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>6     1.0
5     3.0
4     6.0
3     NaN
2    44.0
1     1.0
dtype: float64
1     1.0
2     3.0
3     6.0
4     NaN
5    44.0
6     1.0
dtype: float64
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><ul><li>默认的索引从<code>0</code>开始，步长为<code>1</code></li></ul> <h3 id="dataframe">DataFrame</h3> <p>创建一个数据框架</p> <ul><li>创建连续日期数组<code>pd.date_range('2018-08-19',periods=6)</code>，意为从8.19日起往后数6天构成的日期数组</li> <li>返回标准正态分布样本<code>np.random.randn(6,4)</code>意为返回<code>6x4</code>个样本，于<code>numpy.random.rand(d0, d1, …, dn)</code>不同，其返回的随机样本位于<code>[0, 1)</code>中</li></ul> <div class="language-python line-numbers-mode"><pre class="language-text"><code>import pandas as pd
import numpy as np

# DataFrame
dates = pd.date_range('2018-08-19',periods=6)
# dates = pd.date_range('2018-08-19','2018-08-24') # 起始、结束  与上述等价

df = pd.DataFrame(np.random.randn(6,4),index=dates,columns=['a','b','c','d'])
print(df)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-text"><code>                   a         b         c         d
2018-08-19 -0.147933  0.726108  2.725752  1.373449
2018-08-20 -0.512244  0.218556  0.820553  0.582996
2018-08-21 -0.455171  0.361705  1.196131 -0.577475
2018-08-22 -1.600681 -0.987295  1.361328  0.427573
2018-08-23 -1.683981 -1.075722 -0.360446  0.651535
2018-08-24 -0.652182 -0.516795 -1.100374  1.577188
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>数据框架的转置</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>print(df.T)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-text"><code>   2018-08-19  2018-08-20  ...  2018-08-23  2018-08-24
a   -0.147933   -0.512244  ...   -1.683981   -0.652182
b    0.726108    0.218556  ...   -1.075722   -0.516795
c    2.725752    0.820553  ...   -0.360446   -1.100374
d    1.373449    0.582996  ...    0.651535    1.577188
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>实际上这里的<code>DataFrame</code>就是一个<code>a[0][0]</code>为空，第一列、第一行为属性的矩阵</li></ul> <p>打印某一个属性值</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>print(df['d'])
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-text"><code>[4 rows x 6 columns]
2018-08-19    1.373449
2018-08-20    0.582996
2018-08-21   -0.577475
2018-08-22    0.427573
2018-08-23    0.651535
2018-08-24    1.577188
Freq: D, Name: d, dtype: float64
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li>第一列为索引，第二列为属性<code>d</code>的值</li></ul> <p>打印索引</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>print(df.index)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-text"><code>DatetimeIndex(['2018-08-19', '2018-08-20', '2018-08-21', '2018-08-22',
               '2018-08-23', '2018-08-24'],
              dtype='datetime64[ns]', freq='D')
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>打印行属性</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>print(df.columns)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-text"><code>Index(['a', 'b', 'c', 'd'], dtype='object')
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>打印所有数据</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>print(df.values)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-text"><code>[[-0.14793322  0.72610839  2.72575215  1.3734486 ]
 [-0.5122437   0.21855648  0.82055337  0.58299647]
 [-0.45517147  0.3617052   1.19613096 -0.57747469]
 [-1.6006812  -0.98729492  1.36132808  0.42757327]
 [-1.68398091 -1.07572233 -0.36044647  0.65153468]
 [-0.65218188 -0.51679505 -1.10037376  1.57718844]]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>打印数据统计总结</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>print(df.describe())
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-text"><code>              a         b         c         d
count  6.000000  6.000000  6.000000  6.000000
mean  -0.842032 -0.212240  0.773824  0.672544
std    0.641976  0.752936  1.351658  0.766898
min   -1.683981 -1.075722 -1.100374 -0.577475
25%   -1.363556 -0.869670 -0.065197  0.466429
50%   -0.582213 -0.149119  1.008342  0.617266
75%   -0.469440  0.325918  1.320029  1.192970
max   -0.147933  0.726108  2.725752  1.577188
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>在创建<code>DataFrame</code>时不规定行列属性，索引将默认从<code>0</code>开始</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>df1 = pd.DataFrame(np.arange(12).reshape((3,4)))
print(df1)
print(df1[1])
print(df1.index)
print(df1.columns)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-text"><code>   0  1   2   3
0  0  1   2   3
1  4  5   6   7
2  8  9  10  11
0    1
1    5
2    9
Name: 1, dtype: int64
RangeIndex(start=0, stop=3, step=1)
RangeIndex(start=0, stop=4, step=1)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>另一种以对象的形式构建<code>DataFrame</code></p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>df2 = pd.DataFrame({ 'A' : 1.,
                     'B' : pd.Timestamp('20130102'),
                     'C' : pd.Series(1,index=list(range(4)),dtype='float32'),
                     'D' : np.array([3]*4,dtype='int32'),
                     'E' : pd.Categorical([&quot;test&quot;,&quot;train&quot;,&quot;test&quot;,&quot;train&quot;]),
                     'F' : 'foo' })
print(df2)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-text"><code>     A          B    C  D      E    F
0  1.0 2013-01-02  1.0  3   test  foo
1  1.0 2013-01-02  3.0  3  train  foo
2  1.0 2013-01-02  6.0  3   test  foo
3  1.0 2013-01-02  9.0  3  train  foo
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>排序：使用函数<code>df.sort_index(axis, ascending)</code></p> <ul><li><code>axis=1</code>表示排序列属性，<code>axis=0</code>表示排序行属性，这里的排序的对象其实是索引，通过排序索引更改数据的位置</li> <li><code>ascending=True</code>表示升序，<code>ascending=False</code>表示降序</li></ul> <p>对列进行降序排列</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>df21 = df2.sort_index(axis=1, ascending=False) # 降序排列列属性
print(df21)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-text"><code>     F      E  D    C          B    A
0  foo   test  3  1.0 2013-01-02  1.0
1  foo  train  3  3.0 2013-01-02  1.0
2  foo   test  3  6.0 2013-01-02  1.0
3  foo  train  3  9.0 2013-01-02  1.0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>降序排列行属性</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>df22 = df2.sort_index(axis=0, ascending=False)
print(df22)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-text"><code>     A          B    C  D      E    F
3  1.0 2013-01-02  9.0  3  train  foo
2  1.0 2013-01-02  6.0  3   test  foo
1  1.0 2013-01-02  3.0  3  train  foo
0  1.0 2013-01-02  1.0  3   test  foo
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>这里的排序都是不改变原数据矩阵的</li></ul> <p>根据特定属性进行排列：使用函数<code>df.sort_values(by, ascending)</code></p> <ul><li><code>by=某一属性</code>，将按照这一属性的具体值进行排列</li> <li><code>ascengding=True</code>表示升序排列</li></ul> <div class="language-python line-numbers-mode"><pre class="language-text"><code>df23 = df2.sort_values(by='C', ascending=False)
print(df23)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-text"><code>     A          B    C  D      E    F
3  1.0 2013-01-02  9.0  3  train  foo
2  1.0 2013-01-02  6.0  3   test  foo
1  1.0 2013-01-02  3.0  3  train  foo
0  1.0 2013-01-02  1.0  3   test  foo
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="选择数据">选择数据</h3> <blockquote><p>基于<code>DataFrame</code>对其中数据进行筛选排除</p></blockquote> <div class="language-python line-numbers-mode"><pre class="language-text"><code>import pandas as pd
import numpy as np

dates = pd.date_range('20220706', periods=6)
df = pd.DataFrame(np.arange(24).reshape((6,4)), index=dates, columns=['A','B','C','D'])
print(df)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>检索某一列</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>print(df['A'])
print(df.A)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>检索多行，含头不含尾，即<code>0,1,2</code>行</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>print(df[0:3])
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>也可以用行属性名来检索，此时含头含尾，即表示检索从<code>2022-07-06</code>到<code>2022-07-11</code>的数据</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>print(df['2022-07-06':'2022-07-11'])
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>这里的日期也可以用<code>20220706</code>的形式，即省略<code>-</code></li></ul> <p>检索特定行：使用<code>dataframe</code>的<code>loc</code>数组</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>print(df.loc['2022-07-09'])
print(df.loc['2022-07-09':'2022-07-11'])
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>检索特定列，同样使用<code>loc</code>数组，第一个入参为行，第二个入参为列，当单独搜索多列时，令第一个入参为<code>:</code>即可</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>print(df.loc[:, 'A':'C'])
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>当然也可以限定列</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>print(df.loc['20220707', 'A':'C'])
print(df.loc['20220707':'20220709', 'A':'C'])
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>使用<code>iloc</code>列表进行筛选</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code># 第三行第一列元素
print(df.iloc[3,1])

# 第3,4行，第1,2列元素
print(df.iloc[3:5, 1:3])

# 第1,3,5行，第1,2列元素
print(df.iloc[[1,3,5], 1:3])

# 第0,1,2行，第0,2列元素
print(df.iloc[:3,[0,2]])
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>通过值进行筛选，选出<code>A</code>属性大于<code>8</code>的行</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>print(df[df.A&gt;8])
print(df.loc[df.A&gt;8])
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>这两种写法等价</li></ul> <p>总结一波</p> <table><thead><tr><th>单列</th> <th>单行</th> <th>多列</th> <th>多行</th></tr></thead> <tbody><tr><td><code>df['A']</code></td> <td><code>df.loc['20220707']</code></td> <td><code>df.loc[:, 'A':'C']</code></td> <td><code>df[0,3]</code></td></tr> <tr><td><code>df.A</code></td> <td></td> <td></td> <td><code>df['20220707','20220711']</code>（含头含尾）</td></tr> <tr><td><code>df.loc[:, 'A']</code></td> <td></td> <td></td> <td><code>df.loc['20220707','20220711']</code></td></tr></tbody></table> <ul><li><code>loc/iloc</code>是最全能的，可以搜任意行/列</li> <li><code>iloc</code>只能接收整型参数，即严格依靠坐标取值</li> <li><code>loc</code>只能接收字符串参数，依靠行、列属性值进行取值</li> <li>均用<code>:</code>代表全体</li> <li><code>ix</code>似乎被废弃了</li></ul> <h3 id="设置值">设置值</h3> <p>基本设置，就是通过<code>loc/iloc</code>确定范围，然后直接赋值</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>import pandas as pd
import numpy as np

dates = pd.date_range('20220706',periods=6)
df = pd.DataFrame(np.arange(24).reshape((6,4)), index=dates, columns=['A','B','C','D'])
print(df)

df.iloc[0,0] = 23
print(df)
df.loc['20220711','D'] = 0
print(df)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>设置整行/列数据</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>df.iloc[0] = 'nmsl'
print(df)
df.iloc[:,1] = 'hahaha'
print(df)
df.loc['20220706'] = 'sad'
df.loc[:, 'A'] = 'hehe'
print(df)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>设置多行/多列</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>df.iloc[[1,2]] = 1
print(df)
df.loc[:, ['B','C']] = 2
print(df)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>根据条件设置</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>df.B[df.A&gt;4] = np.nan
df.B.loc[df.A&gt;4] = np.nan
df['B'][df.A&gt;4] = np.nan
df['B'].loc[df.A&gt;4] = np.nan
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>将<code>A</code>属性大于<code>4</code>的行的<code>B</code>属性设置为<code>np.nan</code></li> <li>四种写法均可</li></ul> <p>添加行</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>date = pd.to_datetime('20220712')
df.loc[date] = [24,25,26,27]
print(df)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>添加列</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>df['E'] = pd.Series([1,2,3,4,5,6], index=pd.date_range('20220706',periods=6))
print(df)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>这里的数据个数必须和已有索引保持一致，不然会报错</li> <li>这里的索引最好和已有的数据对齐，没有对齐的索引所对应的数据将变为<code>NaN</code></li></ul> <h3 id="处理丢失数据">处理丢失数据</h3> <blockquote><p>丢失数据即指<code>NaN</code></p></blockquote> <div class="language-python line-numbers-mode"><pre class="language-text"><code>import pandas as pd
import numpy as np

dates = pd.date_range('20220706', periods=6)
df = pd.DataFrame(np.arange(24).reshape((6,4)), index=dates, columns=['A','B','C','D'])
df.iloc[2,2] = np.nan
df.iloc[5,3] = np.nan
print(df)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>上述数据中有两个丢失数据<code>NaN</code></p> <p>删除有丢失数据的行/列</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>df1 = df.dropna()
print(df1)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>无参的<code>dropna()</code>默认删除所有含有<code>NaN</code>的行，并返回没有<code>NaN</code>的矩阵，不改变原矩阵</li></ul> <p>其实有两个参数：<code>axis</code>和<code>how</code></p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>df2 = df.dropna(axis=1, how='any')
print(df2)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>axis=1</code>时表示删除<code>Nan</code>所在列，默认<code>axis=0</code></li> <li><code>how='any'</code>表示只要存在<code>Nan</code>即删除，<code>how='all'</code>表示要这一行/列全为<code>Nan</code>时才删除，默认为<code>any</code></li></ul> <p>将<code>Nan</code>替换为<code>0</code>或其他</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>df3 = df.fillna(value='nmsl')
print(df3)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>在各元素上判断是否有<code>Nan</code>或<code>NULL</code>，输出一个布尔矩阵</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>df4 = df3.isnull()
df5 = df.isnull()
print(df4)
print(df5)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>在各元素上判断是否有<code>Nan</code>，输出一个布尔矩阵</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>df6 = df.isna()
print(df6)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>判断各列是否有缺失数据</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>df7 = df.isna().any()
print(df7)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-text"><code>A    False
B    False
C     True
D     True
dtype: bool
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>判断整张表中是否有缺失数据</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>flag = np.any(df.isnull())
print(flag)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="导入导出">导入导出</h3> <p>导入现成数据</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>import pandas as pd

data = pd.read_csv('student.csv')
print(data)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>注意这里要把<code>student.csv</code>放在<code>.py</code>的同一目录下，或者用相对、绝对路径去找</li></ul> <p>前三行和后四行（就像<code>linux</code>的命令）</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>print(data.head(3))
print(data.tail(4))
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>导出数据</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>data.to_pickle('student.pickle')
print(pd.read_pickle('student.pickle'))
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>均在当前目录下完成</li></ul> <h3 id="合并操作">合并操作</h3> <blockquote><p>很像数据库表的合并</p></blockquote> <h4 id="concat">Concat</h4> <div class="language-python line-numbers-mode"><pre class="language-text"><code>import pandas as pd
import numpy as np

df1 = pd.DataFrame(np.zeros((3,4)), columns=['A','B','C','D'])
df2 = pd.DataFrame(np.ones((3,4)), columns=['A','B','C','D'])
df3 = pd.DataFrame(np.ones((3,4))*2, columns=['A','B','C','D'])

print(df1)
print(df2)
print(df3)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><ul><li>列索引均为<code>A,B,C,D</code></li> <li>行索引均为<code>0,1,2,3</code></li></ul> <p>上下合并</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>res1 = pd.concat([df1,df2,df3], axis=0)
print(res1)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>这种合并方式，其行索引会重复，即为<code>0,1,2,3,0,1,2,3,0,1,2,3</code></p> <p>在合并时可以手动忽略索引，重新从<code>0</code>开始建立行索引</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>res2 = pd.concat([df1,df2,df3], axis=0, ignore_index=True)
print(res2)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>使用<code>append</code>函数进行合并</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>df7 = pd.DataFrame(np.ones((3,4))*0, columns=['a','b','c','d'])
df8 = pd.DataFrame(np.ones((3,4))*1, columns=['a','b','c','d'])
df9 = pd.DataFrame(np.ones((3,4))*2, columns=['a','b','c','d'])
s = pd.Series([1,2,3,4], index=['a','b','c','d'])
# 将df2合并到df1下面,以及重置index,并打印出结果
res7 = df7.append(df8,ignore_index=True)
print(res7)
res8 = df7.append([df8,df9], ignore_index=True)
print(res8)
res9 = df7.append(s, ignore_index=True)
print(res9)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ul><li>这里的<code>append</code>均为上下合并，要求列数相同，不然报错</li></ul> <p>内外连接</p> <p>外连接</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>df3 = pd.DataFrame(np.ones((3,4))*0, columns=['a','b','c','d'], index=[1,2,3])
df4 = pd.DataFrame(np.ones((3,4))*1, columns=['b','c','d','e'], index=[2,3,4])
print(df3)
print(df4)

res3 = pd.concat([df3,df4], ignore_index=True, join='outer')
print(res3)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>和数据库表的外连接一样（左右外连接）</li> <li>首先是上下连接</li> <li>由于<code>df1</code>和<code>df2</code>的列属性不尽相同，列属性相同的列直接合并，对于不同的列属性，各自不存在的数据均用<code>NaN</code>填充</li></ul> <p>内连接</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>res4 = pd.concat([df3,df4], ignore_index=True, join='inner')
print(res4)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>只保留相同的列，舍弃掉不同的列属性</li></ul> <p>左右合并</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>df5 = pd.DataFrame(np.ones((3,4))*0, columns=['a','b','c','d'], index=[1,2,3])
df6 = pd.DataFrame(np.ones((3,4))*1, columns=['b','c','d','e'], index=[2,3,4])
print(df5)
print(df6)

res5 = pd.concat([df5,df6], axis=1)
print(res5)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>不同的行、列元素用<code>NaN</code>填充，注意这里的横向连接即使列属性名字一样，也视作不同的列</p> <h4 id="merge">Merge</h4> <p><code>pandas.merge(df1, df2, on='', how='', indicator='', left_index=True/False, right_index=True/False, suffixes=[])</code></p> <ul><li><code>df1,df2</code>是要合并的两个数据集</li> <li><code>how=inner/outer</code>表示合并方式，内连接或外连接</li> <li><code>left_index/right_index</code>表示是否用索引进行连接</li> <li><code>suffixes</code>用于分开相同的列，如<code>df1,df2</code>中均有列属性<code>age</code>，加入参数<code>suffixes['_boy', '_girl']</code>，其合并的数据集中将出现两个<code>age</code>属性，即<code>age_boy, age_girl</code></li> <li><code>indicator</code>会在合并的数据集中新建一列，表明每行的连接方式，有<code>left_only, right_only, both</code>，分别代表左外连接，右外连接，全连接</li></ul> <div class="language-python line-numbers-mode"><pre class="language-text"><code>import pandas as pd
import numpy as np

import pandas as pd
# 依据一组key合并
# 定义资料集并打印出
left = pd.DataFrame({'key' : ['K0','K1','K2','K3'],
                     'A' : ['A0','A1','A2','A3'],
                     'B' : ['B0','B1','B2','B3']})

right = pd.DataFrame({'key': ['K0', 'K1', 'K2', 'K3'],
                      'C' : ['C0', 'C1', 'C2', 'C3'],
                      'D' : ['D0', 'D1', 'D2', 'D3']})
print(left)
print(right)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>通过列属性<code>key</code>进行合并</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>res = pd.merge(left, right, on='key')
print(res)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>得到数据集
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>m</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>e</mi><mo stretchy="false">(</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>k</mi><mi>e</mi><mi>y</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>B</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>K</mi><mn>0</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>A</mi><mn>0</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>B</mi><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>K</mi><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>A</mi><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>B</mi><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>K</mi><mn>2</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>A</mi><mn>2</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>B</mi><mn>2</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>K</mi><mn>3</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>A</mi><mn>3</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>B</mi><mn>3</mn></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo separator="true">,</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>k</mi><mi>e</mi><mi>y</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>C</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>D</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>K</mi><mn>0</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>C</mi><mn>0</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>D</mi><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>K</mi><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>C</mi><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>D</mi><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>K</mi><mn>2</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>C</mi><mn>2</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>D</mi><mn>2</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>K</mi><mn>3</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>C</mi><mn>3</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>D</mi><mn>3</mn></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo separator="true">,</mo><mi>o</mi><mi>n</mi><msup><mo>=</mo><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi>k</mi><mi>e</mi><msup><mi>y</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>k</mi><mi>e</mi><mi>y</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>B</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>C</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>D</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>K</mi><mn>0</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>A</mi><mn>0</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>B</mi><mn>0</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>C</mi><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>D</mi><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>K</mi><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>A</mi><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>B</mi><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>C</mi><mn>2</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>D</mi><mn>2</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>K</mi><mn>2</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>A</mi><mn>2</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>B</mi><mn>2</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>C</mi><mn>3</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>D</mi><mn>3</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>K</mi><mn>3</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>A</mi><mn>3</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>B</mi><mn>3</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>C</mi><mn>4</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>D</mi><mn>4</mn></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">
merge(
\begin{bmatrix}
  &amp; key &amp; A  &amp;  B\\
0 &amp; K0  &amp; A0 &amp; B0\\
1 &amp; K1  &amp; A1 &amp; B1\\
2 &amp; K2  &amp; A2 &amp; B2\\
3 &amp; K3  &amp; A3 &amp; B3\\
\end{bmatrix}
,
\begin{bmatrix}
  &amp; key &amp; C  &amp;  D\\
0 &amp; K0  &amp; C0 &amp; D0\\
1 &amp; K1  &amp; C1 &amp; D1\\
2 &amp; K2  &amp; C2 &amp; D2\\
3 &amp; K3  &amp; C3 &amp; D3\\
\end{bmatrix}
,on='key')=
\begin{bmatrix}
  &amp; key &amp; A  &amp; B  &amp; C  &amp; D\\
0 &amp; K0  &amp; A0 &amp; B0 &amp; C1 &amp; D1\\
1 &amp; K1  &amp; A1 &amp; B1 &amp; C2 &amp; D2\\
2 &amp; K2  &amp; A2 &amp; B2 &amp; C3 &amp; D3\\
3 &amp; K3  &amp; A3 &amp; B3 &amp; C4 &amp; D4
\end{bmatrix}
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:6em;vertical-align:-2.75em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal" style="margin-right:0.02778em;">er</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">e</span><span class="mopen">(</span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.25em;"><span class="pstrut" style="height:8em;"></span><span style="width:0.667em;height:6.000em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="6.000em" viewBox="0 0 667 6000"><path d="M403 1759 V84 H666 V0 H319 V1759 v2400 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v2400 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-0.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.03588em;">ey</span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord">0</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord">1</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord">2</span></span></span><span style="top:-0.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="mord">0</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="mord">1</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="mord">2</span></span></span><span style="top:-0.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="mord">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">0</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">1</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">2</span></span></span><span style="top:-0.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.25em;"><span class="pstrut" style="height:8em;"></span><span style="width:0.667em;height:6.000em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="6.000em" viewBox="0 0 667 6000"><path d="M347 1759 V0 H0 V84 H263 V1759 v2400 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v2400 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.25em;"><span class="pstrut" style="height:8em;"></span><span style="width:0.667em;height:6.000em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="6.000em" viewBox="0 0 667 6000"><path d="M403 1759 V84 H666 V0 H319 V1759 v2400 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v2400 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-0.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.03588em;">ey</span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord">0</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord">1</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord">2</span></span></span><span style="top:-0.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord">0</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord">1</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord">2</span></span></span><span style="top:-0.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord">0</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord">1</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord">2</span></span></span><span style="top:-0.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.25em;"><span class="pstrut" style="height:8em;"></span><span style="width:0.667em;height:6.000em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="6.000em" viewBox="0 0 667 6000"><path d="M347 1759 V0 H0 V84 H263 V1759 v2400 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v2400 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel">=</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0519em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal">e</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:6em;vertical-align:-2.75em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.25em;"><span class="pstrut" style="height:8em;"></span><span style="width:0.667em;height:6.000em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="6.000em" viewBox="0 0 667 6000"><path d="M403 1759 V84 H666 V0 H319 V1759 v2400 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v2400 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-0.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.03588em;">ey</span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord">0</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord">1</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord">2</span></span></span><span style="top:-0.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="mord">0</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="mord">1</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="mord">2</span></span></span><span style="top:-0.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="mord">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">0</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">1</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">2</span></span></span><span style="top:-0.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord">1</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord">2</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord">3</span></span></span><span style="top:-0.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord">1</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord">2</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord">3</span></span></span><span style="top:-0.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.25em;"><span class="pstrut" style="height:8em;"></span><span style="width:0.667em;height:6.000em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="6.000em" viewBox="0 0 667 6000"><path d="M347 1759 V0 H0 V84 H263 V1759 v2400 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v2400 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span></span></span></span></span></span></eqn></section>
两列合并</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>left = pd.DataFrame({'key1': ['K0', 'K0', 'K1', 'K2'],
                      'key2': ['K0', 'K1', 'K0', 'K1'],
                      'A': ['A0', 'A1', 'A2', 'A3'],
                      'B': ['B0', 'B1', 'B2', 'B3']})
right = pd.DataFrame({'key1': ['K0', 'K1', 'K1', 'K2'],
                       'key2': ['K0', 'K0', 'K0', 'K0'],
                       'C': ['C0', 'C1', 'C2', 'C3'],
                       'D': ['D0', 'D1', 'D2', 'D3']})
print(left)
print(right)

res = pd.merge(left, right, on=['key1','key2'])
print(res)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ul><li>这里默认为内连接，即只保留<code>left</code>和<code>right</code>公共的<code>(key1,key2)</code>组合所在的行</li></ul> <p>当然可以设置为外连接，左外连接，右外连接</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>res1 = pd.merge(left, right, on=['key1', 'key2'], how='outer')
res2 = pd.merge(left, right, on=['key1', 'key2'], how='left')
res3 = pd.merge(left, right, on=['key1', 'key2'], how='right')
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>根据索引连接</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>left = pd.DataFrame({'A': ['A0', 'A1', 'A2'],
                     'B': ['B0', 'B1', 'B2']},
                     index=['K0', 'K1', 'K2'])
right = pd.DataFrame({'C': ['C0', 'C2', 'C3'],
                      'D': ['D0', 'D2', 'D3']},
                     index=['K0', 'K2', 'K3'])
print(left)
print(right)

res = pd.merge(left, right, left_index=True, right_index=True, how='outer')
print(res)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ul><li>令<code>left_index, right_index</code>均为<code>True</code>表示用二者的索引连接，同样有四种连接方式<code>outer, inner, left, right</code></li></ul> <p>解决列重叠问题</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>boys = pd.DataFrame({'k': ['K0', 'K1', 'K2'], 'age': [1, 2, 3]})
girls = pd.DataFrame({'k': ['K0', 'K0', 'K3'], 'age': [4, 5, 6]})
print(boys)
print(girls)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>可以注意到这里的数据集<code>boys, girls</code>均有列属性<code>age</code>，表示<code>ki</code>班级的男/女平均年龄，在合并时若想把二者分开统计，则令名字相同的列属性添加后缀<code>_boy, _girl</code>，注意这里会把每个相同的列属性均分开，同时对两个数据集按照先后顺序添加后缀</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>res = pd.merge(boys,girls,on='k',suffixes=['_boy','_girl'],how='inner')
print(res)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-text"><code>    k  age_boy  age_girl
0  K0        1         4
1  K0        1         5
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="plot出图">plot出图</h3> <p>调用库<code>matplotlib.pyplot</code>对<code>Series</code>和<code>DataFrame</code>进行绘图</p> <p>绘制<code>Series</code>的曲线图，横轴为索引，纵轴为值</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

data = pd.Series(np.random.randn(1000), index=np.arange(1000))
print(data)
print(data.cumsum())

data.plot()
plt.show()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><img src="/assets/img/Figure_1.833df823.png"> <p>绘制<code>DataFrame</code>四个列属性的坐标图，横轴为行索引，纵轴为数据值，每个列属性代表一条曲线</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>data1 = pd.DataFrame(np.random.randn(1000,4), index=np.arange(1000), columns=list(&quot;ABCD&quot;))
data1.cumsum()
data1.plot()
plt.show()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><img src="/assets/img/Figure_2.89496095.png"> <p>绘制<code>data1</code>的<code>x-y</code>坐标图</p> <div class="language-python line-numbers-mode"><pre class="language-text"><code>ax = data1.plot.scatter(x='A',y='B',color='DarkBlue',label='Class1')
# 将之下这个 data 画在上一个 ax 上面
data1.plot.scatter(x='A',y='C',color='LightGreen',label='Class2',ax=ax)
plt.show()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><img src="/assets/img/Figure_3.b7b3bb7b.png"> <h2 id="pandas-50">Pandas 50</h2></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">7/27/2023, 2:21:23 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/cs/prog/lib/pylib-numpy.html" class="prev">
        Numpy
      </a></span> <span class="next"><a href="/cs/prog/lib/pylib-scipy.html">
        Scipy
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><div class="reco-bgm-panel" data-v-b1d3339e><audio id="bgm" src="/song/aries.aac" data-v-b1d3339e></audio> <div class="reco-float-box" style="bottom:44px;z-index:999999;display:none;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><img src="/img/error.jpg" data-v-b1d3339e></div> <div class="reco-bgm-box" style="left:10px;bottom:10px;z-index:999999;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="reco-bgm-cover" style="background-image:url(/img/error.jpg);" data-v-b1d3339e><div class="mini-operation" style="display:none;" data-v-b1d3339e><i class="reco-bgm reco-bgm-pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play" style="display:none;" data-v-b1d3339e></i></div> <div class="falut-message" style="display:none;" data-v-b1d3339e>
          播放失败
        </div></div> <div class="reco-bgm-info" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-music music" data-v-b1d3339e></i>白羊</div> <div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-artist" data-v-b1d3339e></i>northboat</div> <div class="reco-bgm-progress" data-v-b1d3339e><div class="progress-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div> <div class="reco-bgm-operation" data-v-b1d3339e><i class="reco-bgm reco-bgm-last last" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-pause pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play play" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-next next" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-volume1 volume" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-mute mute" style="display:none;" data-v-b1d3339e></i> <div class="volume-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div></div> <div class="reco-bgm-left-box" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><i class="reco-bgm reco-bgm-left" data-v-b1d3339e></i></div></div></div><!----><div class="RibbonAnimation"></div><div class="Sakura" data-v-248d85d6><canvas id="canvas_sakura" style="z-index:99;" data-v-248d85d6></canvas></div></div></div>
    <script src="/assets/js/app.bc86f6a3.js" defer></script><script src="/assets/js/6.2002952c.js" defer></script><script src="/assets/js/79.9e3702ee.js" defer></script>
  </body>
</html>
