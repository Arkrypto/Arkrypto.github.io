<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>不确定知识 - 概率推理 | Northboat Blog</title>
    <meta name="generator" content="VuePress 1.9.8">
    <link rel="icon" href="/img/leaf.ico">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
    <meta name="description" content="片刻寧靜">
    
    <link rel="preload" href="/assets/css/0.styles.70e1d524.css" as="style"><link rel="preload" href="/assets/js/app.ea876610.js" as="script"><link rel="preload" href="/assets/js/5.ccbdcc26.js" as="script"><link rel="preload" href="/assets/js/69.cd818ffc.js" as="script"><link rel="prefetch" href="/assets/js/10.730ce112.js"><link rel="prefetch" href="/assets/js/100.cebc909b.js"><link rel="prefetch" href="/assets/js/101.76935bbb.js"><link rel="prefetch" href="/assets/js/102.70ced7e1.js"><link rel="prefetch" href="/assets/js/103.b4b1ec85.js"><link rel="prefetch" href="/assets/js/104.4e0719d1.js"><link rel="prefetch" href="/assets/js/105.b6fcf69c.js"><link rel="prefetch" href="/assets/js/106.f2e91128.js"><link rel="prefetch" href="/assets/js/107.62987fec.js"><link rel="prefetch" href="/assets/js/108.633219b9.js"><link rel="prefetch" href="/assets/js/109.7ab6b2aa.js"><link rel="prefetch" href="/assets/js/11.84e4e3c0.js"><link rel="prefetch" href="/assets/js/110.e05d4f65.js"><link rel="prefetch" href="/assets/js/111.c3684fab.js"><link rel="prefetch" href="/assets/js/112.a3bc28eb.js"><link rel="prefetch" href="/assets/js/113.f1975e31.js"><link rel="prefetch" href="/assets/js/114.288cc455.js"><link rel="prefetch" href="/assets/js/115.f37f2caa.js"><link rel="prefetch" href="/assets/js/116.e95406b6.js"><link rel="prefetch" href="/assets/js/117.27a8b5c8.js"><link rel="prefetch" href="/assets/js/118.71ca4ed4.js"><link rel="prefetch" href="/assets/js/119.32f88c69.js"><link rel="prefetch" href="/assets/js/12.2fc1bc27.js"><link rel="prefetch" href="/assets/js/120.08cd1e1b.js"><link rel="prefetch" href="/assets/js/121.7a1b1065.js"><link rel="prefetch" href="/assets/js/122.c83a285f.js"><link rel="prefetch" href="/assets/js/123.53b22611.js"><link rel="prefetch" href="/assets/js/124.479b44d9.js"><link rel="prefetch" href="/assets/js/125.f2909d56.js"><link rel="prefetch" href="/assets/js/126.937cfc62.js"><link rel="prefetch" href="/assets/js/127.c266ecbf.js"><link rel="prefetch" href="/assets/js/128.676a1c01.js"><link rel="prefetch" href="/assets/js/129.3478f70f.js"><link rel="prefetch" href="/assets/js/13.8be75c9b.js"><link rel="prefetch" href="/assets/js/130.b22cc030.js"><link rel="prefetch" href="/assets/js/131.8450013c.js"><link rel="prefetch" href="/assets/js/132.6791cf80.js"><link rel="prefetch" href="/assets/js/133.19d75a7d.js"><link rel="prefetch" href="/assets/js/134.f7319881.js"><link rel="prefetch" href="/assets/js/135.e6e688b1.js"><link rel="prefetch" href="/assets/js/136.dcc29982.js"><link rel="prefetch" href="/assets/js/137.22ea0a61.js"><link rel="prefetch" href="/assets/js/138.64faba51.js"><link rel="prefetch" href="/assets/js/139.0ce88b20.js"><link rel="prefetch" href="/assets/js/14.4408d596.js"><link rel="prefetch" href="/assets/js/140.09f58123.js"><link rel="prefetch" href="/assets/js/141.b649dece.js"><link rel="prefetch" href="/assets/js/142.2d81f9b2.js"><link rel="prefetch" href="/assets/js/143.eae22861.js"><link rel="prefetch" href="/assets/js/144.1247f0b7.js"><link rel="prefetch" href="/assets/js/145.5d9b330c.js"><link rel="prefetch" href="/assets/js/146.43daa2a5.js"><link rel="prefetch" href="/assets/js/147.97c816ed.js"><link rel="prefetch" href="/assets/js/148.bc54d8ba.js"><link rel="prefetch" href="/assets/js/149.75ebc266.js"><link rel="prefetch" href="/assets/js/15.4430b8dd.js"><link rel="prefetch" href="/assets/js/150.3a518f34.js"><link rel="prefetch" href="/assets/js/151.97602c9d.js"><link rel="prefetch" href="/assets/js/152.48d248f8.js"><link rel="prefetch" href="/assets/js/153.3b9983b1.js"><link rel="prefetch" href="/assets/js/154.801e777f.js"><link rel="prefetch" href="/assets/js/155.8aba8bbe.js"><link rel="prefetch" href="/assets/js/156.8482f59a.js"><link rel="prefetch" href="/assets/js/157.d3265b03.js"><link rel="prefetch" href="/assets/js/158.338fbd09.js"><link rel="prefetch" href="/assets/js/159.d3e3b09b.js"><link rel="prefetch" href="/assets/js/16.85f982ad.js"><link rel="prefetch" href="/assets/js/160.39eefe10.js"><link rel="prefetch" href="/assets/js/161.c389774d.js"><link rel="prefetch" href="/assets/js/162.c59155e0.js"><link rel="prefetch" href="/assets/js/163.3b7a45cb.js"><link rel="prefetch" href="/assets/js/164.b0c1e2d2.js"><link rel="prefetch" href="/assets/js/165.d5309ef0.js"><link rel="prefetch" href="/assets/js/166.a6f2caee.js"><link rel="prefetch" href="/assets/js/167.eaf243f1.js"><link rel="prefetch" href="/assets/js/168.9ee1fd2a.js"><link rel="prefetch" href="/assets/js/169.810383df.js"><link rel="prefetch" href="/assets/js/17.86a5dc17.js"><link rel="prefetch" href="/assets/js/170.3d48b34d.js"><link rel="prefetch" href="/assets/js/171.adc8372b.js"><link rel="prefetch" href="/assets/js/172.c1982db5.js"><link rel="prefetch" href="/assets/js/173.a7966702.js"><link rel="prefetch" href="/assets/js/174.d370bd4e.js"><link rel="prefetch" href="/assets/js/175.60700a63.js"><link rel="prefetch" href="/assets/js/176.acde3ac1.js"><link rel="prefetch" href="/assets/js/18.6bcb2934.js"><link rel="prefetch" href="/assets/js/19.c93131ba.js"><link rel="prefetch" href="/assets/js/2.010c8157.js"><link rel="prefetch" href="/assets/js/20.aea4169d.js"><link rel="prefetch" href="/assets/js/21.a3158467.js"><link rel="prefetch" href="/assets/js/22.39c1f543.js"><link rel="prefetch" href="/assets/js/23.3c475464.js"><link rel="prefetch" href="/assets/js/24.5c304407.js"><link rel="prefetch" href="/assets/js/25.e9f4ca3e.js"><link rel="prefetch" href="/assets/js/26.b26c359a.js"><link rel="prefetch" href="/assets/js/27.5fc05bd1.js"><link rel="prefetch" href="/assets/js/28.3d2b4e48.js"><link rel="prefetch" href="/assets/js/29.b0becfe0.js"><link rel="prefetch" href="/assets/js/3.5e338655.js"><link rel="prefetch" href="/assets/js/30.f6282a96.js"><link rel="prefetch" href="/assets/js/31.6a7e116b.js"><link rel="prefetch" href="/assets/js/32.8c1a9440.js"><link rel="prefetch" href="/assets/js/33.7d6c704b.js"><link rel="prefetch" href="/assets/js/34.0b022486.js"><link rel="prefetch" href="/assets/js/35.0943a540.js"><link rel="prefetch" href="/assets/js/36.9020b463.js"><link rel="prefetch" href="/assets/js/37.3afd9f0c.js"><link rel="prefetch" href="/assets/js/38.6a63bf31.js"><link rel="prefetch" href="/assets/js/39.f493e991.js"><link rel="prefetch" href="/assets/js/4.5d49ca76.js"><link rel="prefetch" href="/assets/js/40.4d380424.js"><link rel="prefetch" href="/assets/js/41.cb95eb59.js"><link rel="prefetch" href="/assets/js/42.0a42375e.js"><link rel="prefetch" href="/assets/js/43.0b69dd7c.js"><link rel="prefetch" href="/assets/js/44.1175ca83.js"><link rel="prefetch" href="/assets/js/45.1677d1a0.js"><link rel="prefetch" href="/assets/js/46.7cda5826.js"><link rel="prefetch" href="/assets/js/47.c4c2d730.js"><link rel="prefetch" href="/assets/js/48.b50d9b05.js"><link rel="prefetch" href="/assets/js/49.b99b32ec.js"><link rel="prefetch" href="/assets/js/50.c692144e.js"><link rel="prefetch" href="/assets/js/51.5b63e53c.js"><link rel="prefetch" href="/assets/js/52.bc723131.js"><link rel="prefetch" href="/assets/js/53.8356d59e.js"><link rel="prefetch" href="/assets/js/54.711f57e3.js"><link rel="prefetch" href="/assets/js/55.bea7c347.js"><link rel="prefetch" href="/assets/js/56.ab807fc1.js"><link rel="prefetch" href="/assets/js/57.232d2d8b.js"><link rel="prefetch" href="/assets/js/58.90200bdb.js"><link rel="prefetch" href="/assets/js/59.68d74e3a.js"><link rel="prefetch" href="/assets/js/6.ce299ade.js"><link rel="prefetch" href="/assets/js/60.449f8a40.js"><link rel="prefetch" href="/assets/js/61.83dc6317.js"><link rel="prefetch" href="/assets/js/62.d36b8229.js"><link rel="prefetch" href="/assets/js/63.7944ea2f.js"><link rel="prefetch" href="/assets/js/64.92e0213d.js"><link rel="prefetch" href="/assets/js/65.b3ba649e.js"><link rel="prefetch" href="/assets/js/66.3f6fad59.js"><link rel="prefetch" href="/assets/js/67.05cb9208.js"><link rel="prefetch" href="/assets/js/68.32d39685.js"><link rel="prefetch" href="/assets/js/7.fe1ac9c0.js"><link rel="prefetch" href="/assets/js/70.be80f965.js"><link rel="prefetch" href="/assets/js/71.c7a36427.js"><link rel="prefetch" href="/assets/js/72.f9dbde0f.js"><link rel="prefetch" href="/assets/js/73.14d4e748.js"><link rel="prefetch" href="/assets/js/74.45482962.js"><link rel="prefetch" href="/assets/js/75.5b559016.js"><link rel="prefetch" href="/assets/js/76.7a39f411.js"><link rel="prefetch" href="/assets/js/77.f06e6ac8.js"><link rel="prefetch" href="/assets/js/78.319b7699.js"><link rel="prefetch" href="/assets/js/79.d5e63745.js"><link rel="prefetch" href="/assets/js/8.2f11ba3c.js"><link rel="prefetch" href="/assets/js/80.8cf055d6.js"><link rel="prefetch" href="/assets/js/81.333905e3.js"><link rel="prefetch" href="/assets/js/82.93407526.js"><link rel="prefetch" href="/assets/js/83.53fe6b58.js"><link rel="prefetch" href="/assets/js/84.1baef59b.js"><link rel="prefetch" href="/assets/js/85.a178b30e.js"><link rel="prefetch" href="/assets/js/86.5e62021c.js"><link rel="prefetch" href="/assets/js/87.2d2eaf18.js"><link rel="prefetch" href="/assets/js/88.e5b8f69b.js"><link rel="prefetch" href="/assets/js/89.908baf8a.js"><link rel="prefetch" href="/assets/js/9.3ee4f6ba.js"><link rel="prefetch" href="/assets/js/90.240aaf4d.js"><link rel="prefetch" href="/assets/js/91.2c5ac2ea.js"><link rel="prefetch" href="/assets/js/92.47f2df26.js"><link rel="prefetch" href="/assets/js/93.0323c8f0.js"><link rel="prefetch" href="/assets/js/94.d280a44a.js"><link rel="prefetch" href="/assets/js/95.e718b39c.js"><link rel="prefetch" href="/assets/js/96.70021dd2.js"><link rel="prefetch" href="/assets/js/97.13317737.js"><link rel="prefetch" href="/assets/js/98.e92730da.js"><link rel="prefetch" href="/assets/js/99.9d88239b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.70e1d524.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="Northboat Blog" class="logo"> <span class="site-name can-hide">Northboat Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Home Page" class="dropdown-title"><span class="title">Home Page</span> <span class="arrow down"></span></button> <button type="button" aria-label="Home Page" class="mobile-dropdown-title"><span class="title">Home Page</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/" class="nav-link">
  Home
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/northboat" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github Profile
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="/lib/" class="nav-link">
  Liberal
</a></li><li class="dropdown-item"><!----> <a href="https://t.me/northboat" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Contact Me
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="2084 Full Stack" class="dropdown-title"><span class="title">2084 Full Stack</span> <span class="arrow down"></span></button> <button type="button" aria-label="2084 Full Stack" class="mobile-dropdown-title"><span class="title">2084 Full Stack</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dev/algo/" class="nav-link">
  Algorithm
</a></li><li class="dropdown-item"><!----> <a href="/dev/java/" class="nav-link">
  Java
</a></li><li class="dropdown-item"><!----> <a href="/dev/ops/" class="nav-link">
  Operations
</a></li><li class="dropdown-item"><!----> <a href="/dev/fe/" class="nav-link">
  Front End
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="NEUQ CS" class="dropdown-title"><span class="title">NEUQ CS</span> <span class="arrow down"></span></button> <button type="button" aria-label="NEUQ CS" class="mobile-dropdown-title"><span class="title">NEUQ CS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/408/ds/" class="nav-link">
  Data Structure
</a></li><li class="dropdown-item"><!----> <a href="/408/cn/" class="nav-link">
  Network
</a></li><li class="dropdown-item"><!----> <a href="/408/os/" class="nav-link">
  Operating System
</a></li><li class="dropdown-item"><!----> <a href="/408/co/" class="nav-link">
  Organization
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CS and ML" class="dropdown-title"><span class="title">CS and ML</span> <span class="arrow down"></span></button> <button type="button" aria-label="CS and ML" class="mobile-dropdown-title"><span class="title">CS and ML</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/cs/math/" class="nav-link">
  Mathematics
</a></li><li class="dropdown-item"><!----> <a href="/cs/coding/" class="nav-link">
  Coding
</a></li><li class="dropdown-item"><!----> <a href="/cs/security/" class="nav-link">
  Cyberspace Security
</a></li><li class="dropdown-item"><!----> <a href="/cs/machine/" class="nav-link router-link-active">
  Machine Learning
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Home Page" class="dropdown-title"><span class="title">Home Page</span> <span class="arrow down"></span></button> <button type="button" aria-label="Home Page" class="mobile-dropdown-title"><span class="title">Home Page</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/" class="nav-link">
  Home
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/northboat" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github Profile
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="/lib/" class="nav-link">
  Liberal
</a></li><li class="dropdown-item"><!----> <a href="https://t.me/northboat" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Contact Me
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="2084 Full Stack" class="dropdown-title"><span class="title">2084 Full Stack</span> <span class="arrow down"></span></button> <button type="button" aria-label="2084 Full Stack" class="mobile-dropdown-title"><span class="title">2084 Full Stack</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dev/algo/" class="nav-link">
  Algorithm
</a></li><li class="dropdown-item"><!----> <a href="/dev/java/" class="nav-link">
  Java
</a></li><li class="dropdown-item"><!----> <a href="/dev/ops/" class="nav-link">
  Operations
</a></li><li class="dropdown-item"><!----> <a href="/dev/fe/" class="nav-link">
  Front End
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="NEUQ CS" class="dropdown-title"><span class="title">NEUQ CS</span> <span class="arrow down"></span></button> <button type="button" aria-label="NEUQ CS" class="mobile-dropdown-title"><span class="title">NEUQ CS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/408/ds/" class="nav-link">
  Data Structure
</a></li><li class="dropdown-item"><!----> <a href="/408/cn/" class="nav-link">
  Network
</a></li><li class="dropdown-item"><!----> <a href="/408/os/" class="nav-link">
  Operating System
</a></li><li class="dropdown-item"><!----> <a href="/408/co/" class="nav-link">
  Organization
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CS and ML" class="dropdown-title"><span class="title">CS and ML</span> <span class="arrow down"></span></button> <button type="button" aria-label="CS and ML" class="mobile-dropdown-title"><span class="title">CS and ML</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/cs/math/" class="nav-link">
  Mathematics
</a></li><li class="dropdown-item"><!----> <a href="/cs/coding/" class="nav-link">
  Coding
</a></li><li class="dropdown-item"><!----> <a href="/cs/security/" class="nav-link">
  Cyberspace Security
</a></li><li class="dropdown-item"><!----> <a href="/cs/machine/" class="nav-link router-link-active">
  Machine Learning
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>人工智能导论</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/cs/machine/cs188/ai-search-csp-game.html" class="sidebar-link">搜索算法 - 约束满足问题 - 博弈</a></li><li><a href="/cs/machine/cs188/ai-mdp-rl.html" class="sidebar-link">马尔可夫决定过程 - 强化学习</a></li><li><a href="/cs/machine/cs188/ai-probabilistic-reasoning.html" aria-current="page" class="active sidebar-link">不确定知识 - 概率推理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cs/machine/cs188/ai-probabilistic-reasoning.html#probability" class="sidebar-link">Probability</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cs/machine/cs188/ai-probabilistic-reasoning.html#random-variables" class="sidebar-link">Random Variables</a></li><li class="sidebar-sub-header"><a href="/cs/machine/cs188/ai-probabilistic-reasoning.html#joint-distributions" class="sidebar-link">Joint Distributions</a></li><li class="sidebar-sub-header"><a href="/cs/machine/cs188/ai-probabilistic-reasoning.html#probabilistic-models" class="sidebar-link">Probabilistic Models</a></li><li class="sidebar-sub-header"><a href="/cs/machine/cs188/ai-probabilistic-reasoning.html#conditional-distributions" class="sidebar-link">Conditional Distributions</a></li><li class="sidebar-sub-header"><a href="/cs/machine/cs188/ai-probabilistic-reasoning.html#independence" class="sidebar-link">Independence</a></li></ul></li><li class="sidebar-sub-header"><a href="/cs/machine/cs188/ai-probabilistic-reasoning.html#bayes-nets" class="sidebar-link">Bayes' Nets</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cs/machine/cs188/ai-probabilistic-reasoning.html#representation" class="sidebar-link">Representation</a></li><li class="sidebar-sub-header"><a href="/cs/machine/cs188/ai-probabilistic-reasoning.html#conditional-independence" class="sidebar-link">Conditional Independence</a></li><li class="sidebar-sub-header"><a href="/cs/machine/cs188/ai-probabilistic-reasoning.html#probabilistic-inference-2" class="sidebar-link">Probabilistic Inference</a></li></ul></li><li class="sidebar-sub-header"><a href="/cs/machine/cs188/ai-probabilistic-reasoning.html#decision-networks-and-vpi" class="sidebar-link">Decision Networks and VPI</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cs/machine/cs188/ai-probabilistic-reasoning.html#decision-network" class="sidebar-link">Decision Network</a></li><li class="sidebar-sub-header"><a href="/cs/machine/cs188/ai-probabilistic-reasoning.html#vpi" class="sidebar-link">VPI</a></li><li class="sidebar-sub-header"><a href="/cs/machine/cs188/ai-probabilistic-reasoning.html#pomdps" class="sidebar-link">POMDPs</a></li></ul></li></ul></li><li><a href="/cs/machine/cs188/ai-hmm-ml.html" class="sidebar-link">隐马尔科夫模型 - 机器学习</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Scikit-Learn</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>机器学习导论</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><blockquote><p>Probabilistic Reasoning</p> <p>概率推理</p></blockquote> <h2 id="probability">Probability</h2> <blockquote><p>概率论：不确定性下建模和计算以及人工智能的基础</p></blockquote> <p>example：捉鬼敢死队</p> <ul><li>在一个二维的方阵中，隐藏了一个或多个鬼</li> <li>探针标记坐标：颜色越深鬼越近，但有概率出错，每个点只能标记一次，并且每次标记负分</li> <li>开枪：结束游戏，若打到鬼胜利，若为打到则失败</li></ul> <p>Models：在这里指巨大的联合分布，一个巨大的概率查找表</p> <h3 id="random-variables">Random Variables</h3> <p>随机变量</p> <p>简单分类</p> <ul><li><p>R = is it raining（treu/false）</p></li> <li><p>T = is it hot or cold（hot/cold）</p></li> <li><p>D = how long will it take to drive to work（[0, x)）</p> <p>连续性随机变量</p></li> <li><p>L = where is ghost（{0，0}，{0，1}...）</p></li></ul> <p>有点像CSP问题中<code>state &amp; domain</code>（状态和值域）</p> <p>通常随机变量都是离散型变量</p> <p>在真实模型中随机变量概率为0是毁灭性的，概率总和为1</p> <p>简记</p> <ul><li>P(hot) = P(T=hot)</li></ul> <h3 id="joint-distributions">Joint Distributions</h3> <blockquote><p>联合分布：概率模型的核心</p> <p>给出推荐概率的关键</p></blockquote> <p>联合分布概率，即约束一系列随机变量值的概率，就像真值表</p> <ul><li><code>P(X1=x1,X2=x2,...,Xn=xn)</code></li> <li><code>P(x1,x2,...xn)</code></li></ul> <p>n variables with n domain distrbution size：d^n</p> <p>永远不能写出整个概率空间</p> <h3 id="probabilistic-models">Probabilistic Models</h3> <p>概率模型，一组变量和其概率，像是一个巨大的CSP问题，变量对应状态，概率对应值，各变量间存在约束</p> <p><strong>Event</strong></p> <p>事件是一组随机变量的联合结果，通过联合概率表我们可以计算任一事件的概率</p> <p><strong>Marginal Distributions</strong></p> <p>边缘分布：联合分布的一个子表格</p> <p>如有随机变量x、y及其联合分布表a，我们单独提出x的概率分布表b，那么b就是a的一个边缘分布</p> <p><strong>Conditional Probabilities</strong></p> <p>条件概率，a、b均为某一事件</p> <ul><li>P(a|b) = P(a, b) / P(b)</li></ul> <p>即在b发生的前提下，a发生的概率，可以由联合概率和边缘概率计算得出</p> <h3 id="conditional-distributions">Conditional Distributions</h3> <p>条件分布，这里W、T均为变量，条件分布将是一组概率集，即在T为hot的前提下，变量W的概率分布关系</p> <ul><li>P(W|T=hot)</li></ul> <p>他依据事件发生的事实（具体值），而不是概率分布表，这有区别于边缘分布</p> <ul><li><p><code>P(W=s|T=c) = P(W=s, T=c) / ΣP(W=wi, T=c)</code></p> <p>即某一确定条件概率为其条件和自身都发生的概率除以所有可能发生的概率总和</p></li></ul> <p>所有这些事件的概率集合便是W|T的条件分布表</p> <p>计算条件分布的一般方式：</p> <blockquote><p>the algorithms for base nets</p></blockquote> <ul><li>在概率分布表中选出条件满足的所有行</li> <li>等比例调整他们的概率使其概率和为1</li></ul> <h4 id="probabilistic-inference">Probabilistic Inference</h4> <blockquote><p>概率推理</p></blockquote> <p>从已知的概率基于证据推理未知的概率，得到期望的概率</p> <h4 id="inference-by-enumeration">Inference by Enumeration</h4> <p>枚举推理</p> <ul><li><p>Evdence variables：E1...Ek=e1...ek</p> <p>已知事实</p></li> <li><p>Query* variable：Q</p> <p>查询变量，即要推理的问题，想要计算的结果</p></li> <li><p>Hidden variables：H1...Hr</p> <p>尚未证实的事实，也属于未知变量</p></li></ul> <p>推理过程</p> <p>step 1：select the entries consistent with the evidence</p> <ul><li>查询出一个与Q有关的联合概率分布表</li></ul> <p>step 2：sum out H to get joint（联合） of Query and evidence</p> <ul><li><p>Query</p> <p>根据Q合并相同特征的行。如Q为推断天气情况，那么温度和季节将是隐藏变量，你将在使隐藏变量塌陷，将所有<code>W=sun</code>和<code>W=rain</code>提出并合并成两行（subtable）</p></li> <li><p>Evidence</p> <p>根据已知证据（条件），筛选有用的概率分布，如已知是冬天，那么将去掉所有<code>S!=冬天</code>的行</p> <p>条件越多，筛选结果越少</p></li></ul> <p>step 3：normalize</p> <ul><li>即将概率总和等比率扩大至1，转化为一个规范的概率表</li></ul> <p>隐藏变量均具有转化为证据的潜力</p> <p>Obvious problems</p> <ul><li><p>worst case time complexity O(d^n)</p> <p>查询整张联合概率分布表</p></li> <li><p>space complexity O(d^n) to store the joint distribution</p> <p>需要O(d^n)的空间储存联合概率表</p></li></ul> <p>How to produce joint distribution?</p> <p><strong>The Product Rule</strong></p> <ul><li><code>P(y) * P(x|y) = P(x,y)</code></li></ul> <p>根据局部条件分布推断联合概率分布</p> <h4 id="the-chain-rule">The Chain Rule</h4> <p>链规则，对于<code>P(y) * P(x|y) = P(x,y)</code>的推广</p> <ul><li><code>P(x1,x2,x3) = P(x1) * P(x2|x1) * P(x3|x1x2)</code></li> <li><code>P(x1,x2,...,xn) = ∏P(xi|x1...xi-1)</code></li></ul> <p>先获得<code>P(x1)</code>，通过条件<code>P(x1),P(x2|x1)</code>计算<code>P(x2,x1)</code>，通过<code>P(x2,x1),P(x3|x1,x2)</code>获得<code>P(x3,x1,x2)</code>，以此类推，最终可以获得<code>P(x1,x2,...,xn)</code></p> <h4 id="bayes-rule">Bayes Rule</h4> <p>Product rule：<code>P(x,y) = P(x|y)P(y) = P(y|x)P(x)</code></p> <p>移项可得：<code>P(x|y) = (P(y|x)/P(y)) * P(x)</code></p> <p>why it's helpful?</p> <p>通过转换条件（在反向条件中构建条件），通过更简单的条件进行建模</p> <p><strong>Inference with Bayes' Rule</strong></p> <p>例子：诊断病例<code>P(致病因素|症状)</code></p> <ul><li><p><code>P(cause|effect) = (P(effect|cause)P(cause)) / P(effect)</code></p></li> <li><p>cause：脑膜炎</p></li> <li><p>effect：颈部僵硬</p></li></ul> <p>已知：颈部僵硬在普通人群中概率，颈部僵硬在脑膜炎患者之间的概率</p> <p>当你不知道得没得脑膜炎时，因为没有症状，但突然间脖子僵硬了，你就需要重新考虑你得脑膜炎的概率</p> <p>从果溯因的思想，从更多的结果不断更新因的概率使之准确</p> <p><strong>Probabilistic Models</strong></p> <blockquote><p>概率建模</p></blockquote> <ul><li>describe how (a part of) the world works</li></ul> <p>建模总是一个简化过程</p> <ul><li>从哪获取变量</li> <li>怎么计算概率</li> <li>如何学习</li></ul> <blockquote><p>All models are wrong, but some are useful</p> <p>——Geoge E. P. Box</p></blockquote> <p>我们的任务便是提出有用的模型</p> <p><strong>Utility</strong></p> <blockquote><p>模型的效用</p></blockquote> <ul><li>推理未知变量</li> <li>预测，因果推理</li> <li>通过已知变量做出理性决定</li></ul> <h3 id="independence">Independence</h3> <blockquote><p>随机变量的独立性</p></blockquote> <ul><li><code>P(x,y) = P(x)P(y)</code></li> <li><code>P(x|y) = P(y)</code></li></ul> <p>条件概率等于自身概率，就是说y发不发生对于x是否发生不产生影响，x、y相互独立，是两个一维表，而不是一个联合概率二维表，如抛硬币字面和花面互不影响，二者独立</p> <p>很多时候很多事都不是完全独立的</p> <p>如何检验是否独立？</p> <p>边缘概率相乘是否等于联合概率，若相等则独立，若不等则相关</p> <p>像抛硬币这样的独立情况是很罕见的，我们可以只通过一组概率推断一个很大的概率分布表（因为每次都不变）</p> <ul><li>变量往往有互动，因为你在建模的时候，为什么会选择两个完全无关的变量参与呢</li> <li>更多时候是有条件独立（Conditional Independence）</li></ul> <p><strong>Conditional Independence</strong></p> <blockquote><p>条件独立</p></blockquote> <p>呃就是说，a和b的相关需要条件c，比如a是发现蛀牙，b是牙疼，c是你有牙</p> <p>那么，<code>P(a|b) != P(a)</code>当且仅当<code>c</code>成立，否则<code>P(a|b) = P(a)</code>，即a、b相互独立</p> <ul><li><p>牙疼和发现蛀牙是独立的当没有牙</p> <p>toothcache ⊥ catch | no tooth</p></li></ul> <p>条件独立：</p> <ul><li><p><code>P(x,y|z) = P(x|z)P(y|z)</code></p></li> <li><p><code>P(x|z,y) = P(x|z)</code></p> <p>在z发生时，x、y独立，y是否发生不影响x发生概率</p></li></ul> <p>think about these domain</p> <ul><li>traffic</li> <li>umbrella</li> <li>raining</li></ul> <p>在下雨时交通和雨伞相关联，不下雨时相互独立</p> <ul><li>fire</li> <li>smoke</li> <li>alarm</li></ul> <p>当没有烟雾，火灾和警报将互不关联（烟雾报警器）</p> <p>对于一个Chain Rule</p> <ul><li><code>P(x,y,z) = P(z)P(y|z)P(x|z,y)</code></li></ul> <p>若x、y关于z条件独立，那么这个规则可以简化为</p> <ul><li><p><code>P(x,y,z) = P(z)P(y|z)P(x|z)</code></p> <p>即将<code>P(x|z,y)</code>简化为<code>P(x|y)</code></p></li></ul> <p>这样我们能通过更少的变量主键确定一张联合概率表</p> <img src="/assets/img/image-20220515143931060.4fa9ce30.png"> <h2 id="bayes-nets">Bayes' Nets</h2> <blockquote><p>贝叶斯网络</p> <p>一种用于构建概率模型的技术，管理和推理超过规模的不确定性</p></blockquote> <h3 id="representation">Representation</h3> <blockquote><p>表示法</p></blockquote> <h4 id="big-picture">Big Picture</h4> <p>概率模型等于一整个概率分布表？</p> <ul><li>数学上这很好</li> <li>大小是指数型的，真的很大</li> <li>很难去进行学习、评估</li></ul> <p><strong>Example</strong></p> <p>Insurance：汽车保险</p> <ul><li>a lot of variables：age、car、skill...</li> <li>accident：want to prediction</li></ul> <p>所有这些变量根据联系构建了一张大的关系网</p> <h4 id="graphical-model-notation">Graphical Model Notation</h4> <blockquote><p>图形模式表示法</p></blockquote> <p>just like CSPs</p> <ul><li>nodes：变量，variables</li> <li>domains：值域，变量的值</li> <li>arcs：用弧表示条件独立性</li></ul> <p><strong>Example</strong></p> <p>1、Coin Flips</p> <p>硬币翻转问题，绝对的独立性，对应一堆没有弧线的节点</p> <p>2、Traffic</p> <p>交通问题，变量为天气和交通</p> <ul><li><p>model 1：independence</p></li> <li><p>model 2：rain causes traffic</p> <p>箭头从下雨指向交通</p></li></ul> <p>model 2 is better</p> <p>3、Traffic Ⅱ</p> <p>交通问题Ⅱ，变量有交通T、下雨R、低气压L、屋顶滴雨D、一个球赛B、蛀牙C</p> <ul><li>低气压影响下雨</li> <li>下雨影响交通、屋顶滴雨、球赛</li> <li>球赛影响交通</li> <li>蛀牙独立于其他变量</li></ul> <p>4、Alarm Network</p> <p>报警装置，变量有入室盗窃B、警报响起A、玛丽打电话来M、约翰打电话来J、地震E</p> <ul><li>入室盗窃导致警报响起</li> <li>地震导致警报响起</li> <li>警报响起导致玛丽和约翰打电话来</li></ul> <h4 id="bayes-net-semantics">Bayes' Net Semantics</h4> <blockquote><p>贝叶斯网络定义：一种拓扑结构</p></blockquote> <p>贝叶斯网络是一组节点，每个变量x对应一个节点</p> <p>在这些节点中有一个有向无环图，对应变量间的联系（因果关系），注意图中没有定向循环</p> <p>一个节点可能有多个因，果继承了因的某些功能并且呈指数增长，我理解为条件概率在传递过程中不断变化</p> <p>每个节点的概率都是相对其父母节点的条件概率，整合所有的条件概率可以获得一张联合概率表，通过链规则或其他</p> <p>CPT：条件概率表（conditional probability table）</p> <p>不一定是因果关系，异或等都有可能</p> <p><strong>Probabilities in BNs</strong></p> <p>基于Chain Rule，链规则的扩展</p> <p><code>P(x1,x2,...,xn) = ∏ P(xi|parents(Xi))</code></p> <p>贝叶斯网络提供保证，通过乘积将得到节点概率</p> <p>可以通过一个拓扑图将上述例子画出，并提供相应的计算方式</p> <p>在贝叶斯网中，因果关系被弱化，由数字和字母表示，程序并不知道这些数字和字母背后的因果，只是得到一张巨大的联合概率分布表</p> <h3 id="conditional-independence">Conditional Independence</h3> <blockquote><p>条件独立</p></blockquote> <p><strong>Size of a Bayes' Net</strong></p> <p>N Boolean variables：<code>2^N</code></p> <p>N-node net and nodes have up to k parents：<code>O(N*2^(k+1))</code></p> <p>若单纯的计算联合概率分布，指数增长将令算法陷入困境</p> <p>贝叶斯网络将有效缓解</p> <ul><li>条件概率表远小于完整联合概率表</li></ul> <p><strong>Assumptions</strong></p> <p>我们总通过条件概率的乘积来表示当前变量概率，不同于链规则调整所有的条件，贝叶斯网络只根据父级概率进行调整，只关心父母节点</p> <p>举个例子：X ——&gt; Y ——&gt; Z ——&gt; W</p> <p>Chain Rule：<code>P(x,y,z,w) = P(x)P(y|x)P(z|x,y)P(w|x,y,z)</code></p> <p>NBs：<code>P(x,y,z,w) = P(x)P(y|x)P(z|y)P(w|z)</code></p> <ul><li>基于条件独立的简化</li> <li>条件独立是可以传递的，如这里w和z条件独立与y，我们也可以说w和x条件独立与y或z</li></ul> <p>另一个例子：X ——&gt; Y ——&gt; Z</p> <p>X和Z保证独立吗？</p> <p>他们不保证独立，X可以影响Z当Y发生，如低气压引发下雨，下雨引发堵车，那么我们有结论则低气压可以引发堵车当低气压引发了下雨</p> <p>当X发生时，Y发生概率为0时，X和Z保持独立，就像X为抛硬币字面，Y为花面，那么我们可以说这个贝叶斯网络有点智障</p> <h4 id="d-separation">D-Separation</h4> <blockquote><p>D分离算法</p> <p>将所有状态分为三元组进行判断</p> <ul><li>链型</li> <li><code>^</code>型</li> <li><code>v</code>型</li></ul> <p>根据路径是否活跃判断状态的独立关系</p></blockquote> <h5 id="causal-chains">Causal Chains</h5> <p>链型</p> <p>例子：X（low pressure） ——&gt; Y （rain）——&gt; Z（traffic）</p> <ul><li><p>无法保证X/Z独立</p></li> <li><p>能够保证X/Z关于条件Y独立，得到简化</p> <p><code>P(z|x,y) = P(x,y,z)/P(x,y) = P(x)P(y|x)P(z|y)/P(x)P(y|x) = P(z|y)</code></p> <p>从公式中可以看到当前节点概率只与其父母节点有关</p></li></ul> <h5 id="common-cause">Common Cause</h5> <p>^型，公共条件，即一个诱因对应多个结果，两或多个个效果由同一个条件导致</p> <p>条件概率选择</p> <p>例子：X ——&gt; Y ——&gt; Z/W</p> <ul><li><p>通常X/Z不会独立</p></li> <li><p>X和Z/W关于Y条件独立，当Y发生，X肯定发生，不对Z/W造成任何影响</p> <p><code>P(z|x,y) = P(z|y)</code></p></li></ul> <h5 id="common-effect">Common Effect</h5> <p>v型，相同效果，即多个诱因可能导致相同的结果。一个结果可以由多个因素导致</p> <p>例子：X/Y ——&gt; Z</p> <ul><li><p>在这个例子中X/Y是否独立</p> <p>yes</p></li> <li><p>X/Y是否关于Z条件独立</p> <p>no，当Z发生，X/Y都有可能发生，当拥有证据X发生了，那么Y的发生概率将会降低</p></li></ul> <p><strong>The General Case</strong></p> <p>一般情况，以三元组为例</p> <p>Reachability：可到达性</p> <p>通常在贝叶斯网络中将隐藏一些证据节点，观察贝叶斯图中其他节点的结果进行推断</p> <p>Active/Inactive Paths</p> <ul><li>链结构：中间无证据，活跃</li> <li><code>V</code>结构：中间有证据，活跃</li> <li><code>^</code>结构：中间无证据，活跃</li></ul> <blockquote><p>以上为D-Separation的轮廓</p></blockquote> <p>Query：<code>Xi⊥Xj | {Xk1,...,Xkn}</code></p> <p>Check：检查Xi到Xj间的所有路径，若有任一一条路径是活跃的，那么Xi和Xj不相互独立；否则二者独立</p> <p>Example：</p> <p>R/B ——&gt; T ——&gt; T'</p> <ul><li>R⊥B：yes（独立）</li> <li>R⊥B|T：no（关联）</li> <li>R⊥B|T'：no（关联）</li></ul> <p>L ——&gt; R ——&gt; D/T，B ——&gt; T ——&gt; T'</p> <ul><li>L⊥T'|T：yes（R-T-T'为非活跃）</li> <li>L⊥B：yes</li> <li>L⊥B|T：no（条件相关）</li> <li>L⊥B|T'：no</li> <li>L⊥B|T,R：yes</li></ul> <p>R ——&gt; T/D，T/D ——&gt; S</p> <ul><li>T⊥D：no（^型活跃）</li> <li>T⊥D|R：yes（^型不活跃，v型不活跃）</li> <li>T⊥D|R,S：no（v型活跃）</li></ul> <p>我们为什么以及如何调查所有独立性？</p> <p>基于贝叶斯网络的D分离算法</p> <p>不同的贝叶斯结构可能表示着相同的独立逻辑 关系，不同的结构的表现</p> <ul><li>X &lt;—— Y ——&gt; Z</li> <li>X ——&gt; Y ——&gt; Z</li> <li>X &lt;—— Y &lt;—— Z</li></ul> <p>上述三个结构都可以表示：<code>X⊥Z|Y</code></p> <p>在逻辑上他们是等价的，但在特定情况我们应选择更合理的结构</p> <img src="/assets/img/image-20220508231247.bd465353.png"> <p><strong>Summary</strong></p> <p>D分离算法给我们一个检查独立性的方法，为所有变量集运行它，得到所有独立性的完整列表</p> <p>有一个问题，当某个变量完全独立与其他所有变量，它很难被发现并加入列表当中</p> <h3 id="probabilistic-inference-2">Probabilistic Inference</h3> <blockquote><p>概率推理</p></blockquote> <p>有向无环图，使用<code>arc</code>表示变量之间的影响（条件概率），代表着各自变量的条件分布</p> <p>每个节点都是一个概率集，保存了继承自父母节点的条件概率</p> <ul><li>the more parents u have, the more action there is inside that node</li></ul> <p>节点的联合概率将是他们所有父母节点概率的乘积</p> <ul><li><code>P(x1,x1,...,xn) = ΠP(xi|parents(Xi)), (i∈[i,n])</code></li></ul> <p>他们将膨胀成一个巨大的联合概率表，需要更加优化的算法</p> <p>枚举推理：Alerm Network</p> <p>经典的报警模型可以通过五个小的条件概率分布表获取任一组合事件的发生可能性，通过线性组合相乘得到高维的可能性组合结果，这便是枚举推理的一个小应用</p> <h4 id="inference-by-enumeration-2">Inference by Enumeration</h4> <blockquote><p>枚举推理</p></blockquote> <p>给定一堆联合分布概率，通常是一堆条件概率，去定义一个贝叶斯网络</p> <ul><li><p>Posterior probability（后验概率）</p> <p><code>P(Q|E1=e1...Ek=ek)</code></p></li> <li><p>Most likely explanation</p> <p><code>argmax P(Q=q|E1=e1...)</code></p></li></ul> <p><strong>枚举推理</strong></p> <blockquote><p>很简单、很慢</p></blockquote> <p>查询变量、隐藏变量，<code>P(Q|e1...ek)</code></p> <p>1、如果有一张联合概率表，我们要做的就是删除没有证据不符合的行，剩下行的概率总和小于1，这个总和称为<strong>证据的可能性</strong></p> <p>2、总结出隐藏的变量（无关变量），碰撞在一起并合并（忽略隐藏变量）</p> <p>3、最终将概率总和化为1，得到你要查的概率</p> <p>以上是拥有整个贝叶斯网络的一般计算过程</p> <p>当时间、空间被限制，无法得到整张贝叶斯网，将通过条件概率来计算</p> <p>比如你要获得某个值的概率，那么你就分析所有能够到达这个值的路径，并计算所有可能性，如</p> <ul><li>A ——&gt; B ——&gt; C</li> <li>D ——&gt; B ——&gt; C</li></ul> <p>要获得C的发生概率，就计算所有路径致使C发生/不发生的可能性：如a发生b发生c发生、a不发生b发生c发生、d发生b发生c发生......</p> <p>总结所有这些概率并进行规范化（概率和化1）</p> <p>由此可得的所有情况中c发生的概率即为推理的c发生概率</p> <h4 id="variable-elimination">Variable Elimination</h4> <blockquote><p>变量消除</p></blockquote> <p>在枚举推理中，我们仍然是使用所有路径的概率组成一个一张n维的联合概率表，然后再从这张表中截取获得结果</p> <p>有没有一种办法不要扩张至n维，而是一步一步计算推理控制在低维度计算</p> <p>交错计算概率，避免指数喷井</p> <p><strong>Factor Zoo</strong></p> <blockquote><p>因素动物园</p></blockquote> <p>1、P(X,Y)</p> <p>joint distribution</p> <p>考虑两个变量的联合概率分布<code>P(X,Y)</code>，当两个变量都是不定时且有两个选项，总的概率分布表为2维（2维数组表示），概率总和为<code>1</code></p> <p>2、P(x0, Y)</p> <p>selected joint</p> <p>当选择了某一变量确定其值如<code>P(x0,Y)</code>，立马概率分布表将缩小至<code>2x1</code>行，概率总和为<code>P(x0)</code>，此时变量<code>X</code>被称为被选定的关节</p> <ul><li>淘汰了所有<code>X != x0</code>的行</li></ul> <p>此时概率分布表降为1维，我们可以有效的减少数据结构（表）的大小</p> <p>3、P(Y|x0)</p> <p>single condition</p> <p>同样降为1维问题，不同于情况2，他的概率总和为1，得到的时Y的概率分布</p> <p>4、P(Y|X)</p> <p>family of conditionals</p> <p>总和大于1，一系列概率分布</p> <p>5、P(y|X)</p> <p>specified family</p> <p>条件概率的结果知道，但原因有多种选择，其概率总和不确定</p> <p><strong>example</strong></p> <p>R ——&gt; T ——&gt; L</p> <p><img src="C:%5CUsers%5Cadmin%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20220515143931060.png" alt="image-20220515143931060"></p> <p>消去没用的条件概率</p> <ul><li>消去<code>-l</code>的行</li></ul> <p>joining factors（融合条件变量）</p> <ul><li><p>like a database join</p></li> <li><p><code>P(R) x P(T|R) = P(R,T)</code></p> <p>相应行概率相乘</p></li></ul> <p>Multiple joins</p> <ul><li>就像数据库连接，通过相同的字段，连接不同的表，只是在这一过程中多了乘法计算</li> <li>这样总能得到一张更大维度的概率分布表</li></ul> <p>Eliminate（变量消除）：边缘化</p> <ul><li>显而易见的，多重连接实际上就是一步步进行连接，在每次连接前，我们使一些无关的变量塌陷，如已知P(L|T)求P(L)，R便是无关变量，在得到P(R,L)后对R进行压缩塌陷，便能简化计算，减少维度</li> <li>边连接，边化简（消除变量）</li> <li>multiple join + multiple eliminate = inference by enumerateion</li></ul> <p>Marginalizing Early：Variable elimination（尽早边缘化（塌陷））</p> <ul><li>当某个变量不重要时，立马将它消除塌陷，降低维数</li> <li>对于每一次连接都如此检查，直至得到最简答案</li></ul> <p>Evidence</p> <ul><li>Start with evidence</li></ul> <p>当有证据出现时，即删除不符合证据的所有行，锁定数据源（query+evdence）</p> <p>在这群符合证据的数据源上再进行枚举推理或变量消除</p> <p>最终对得到的概率进行标准化（概率和化为1）</p> <p><strong>General Variable Elimination</strong></p> <ul><li>Query：P(Q|E1=e1...Ek=ek)</li> <li>Start with initial factors：Local CPTs</li> <li>Pick out hidden variable H, use it then eliminate H</li> <li>Join all remaining and normalize the result</li></ul> <p>注意连接的规则，若已知<code>P(B),P(E),P(j,m|B,E)</code></p> <p>连接和消除应该是这样的：</p> <ul><li><code>P(E)xP(j,m|B,E) = P(j,m,E|B)</code></li> <li><code>P(j,m,E|B) = P(j,m|B)</code></li></ul> <p>第一步的连接将条件转为结果，在第二步对这个无关的结果进行了塌陷（变量消除）</p> <img src="/assets/img/image-20220515151102382.142166fb.png"> <p>变量排序</p> <p>引入变量的顺序决定了消除变量的顺序，在不同的消除过程中，其产生的中间概率矩阵将是不一样的，一定要避免产生指数级的矩阵</p> <ul><li>当一个父节点对应了n个子节点，这一次连接就将是n维的</li></ul> <p>如何找到好的变量排序？</p> <ul><li>在实践中，通常有规律性的好的排序</li> <li>使用贝叶斯网络解决CSP问题</li> <li>NP hard</li></ul> <h4 id="sampling">Sampling</h4> <blockquote><p>Approximate Inference</p> <p>采样、抽样：计算和准确性之间的权衡</p> <p>抽样也是一种学习，像是一种模拟（概率模拟），比蛮力计算更快，但有可能完全错误，但总有办法阻止其找到错误的概率</p></blockquote> <p>计算一个近似的后验概率，通过不同的小数区间表示变量的不同状态，如<code>(0.1,0.5)</code>红色，<code>[0.5,0.7]</code>绿色</p> <h5 id="prior-sampling">Prior Sampling</h5> <blockquote><p>事先抽样</p></blockquote> <p>P(Q)</p> <p>样本：对变量状态的快照</p> <p>就是说，对于一系列条件概率分布，通过抛硬币（不是五五开的硬币，而是根据条件概率来的）的方式决定每个变量的状态，使之变为证据，直到得到结果概率，作为一次样本（快照）</p> <p>只是按顺序抛硬币得到目标概率</p> <ul><li><code>S(PS)(x1...xn) = ΠP(xi|parents(Xi)) = P(x1...xn)</code></li> <li><code>S(PS)</code>即一次事先抽样的样本</li></ul> <p>通常情况下，我们拥有数百万个样本，使用计数而不是概率去获得结果</p> <p>在这些样本中，直接用除法计算概率（一个经验概率），当样本数不断增加，经验概率将不断逼近真实概率</p> <h5 id="rejection-sampling">Rejection Sampling</h5> <blockquote><p>拒绝抽样</p></blockquote> <p>P(Q|e)</p> <p>我们带着一些期望状态进入抽样程序，若样品和期望不符合，就被拒绝（丢弃）</p> <p>以同样的方式获取样本，然后将不符合期望（证据）的样本丢掉，在剩下的样本中进行除法运算获取概率</p> <h5 id="likelihood-weighting">Likelihood Weighting</h5> <blockquote><p>可能性加权</p></blockquote> <p>P(Q|e)</p> <p>我们在证据节点固定使之状态为我们的证据，这样在最后得到的样本中，一个都不需要拒绝（丢弃）</p> <p>将证据融入你的硬币翻转程序，使之必然发生，同时给这个事件加上权重（从拒绝样本获取的抽样概率转变为条件概率分布表上的通常概率）</p> <ul><li><code>S(WS)(z,e) = ΠP(zi|Parents(Zi))</code></li> <li><code>w(z,e) = ΠP(ei|Parents(Ei))</code></li> <li><code>S(WS)(z,e) * w(z,e) = ΠP(zi|Parents(Zi)) * ΠP(ei|Parents(Ei))</code></li></ul> <p>在有证据的前提下进行合理的必然概率分配，在这样的前提下进行场景模拟，从上往下取样</p> <ul><li>考虑了证据的参与</li></ul> <p>注意这里在实际计算时，使用了已经得知的概率，如<code>P(R|+t)</code>，<code>+t</code>为证据</p> <p>已知：</p> <ul><li><code>+r: +t:0.9, -t:0.1</code></li> <li><code>-r: +t:0.5, -t:0.5</code></li></ul> <p>抽取三个样本为：<code>(+r,+t),(+r,+t),(-r,+t)</code></p> <p>那么现在有：<code>w(+r)=0.9+0.9=1.8; w(-r)=0.5</code></p> <p>那么得到概率：<code>p(+r)=1.8/2.3; p(-r)=0.5/2.3</code></p> <p>因为我们固定了变量的值，我们需要对他进行加权，进行一个概率估计</p> <p>这个过程中我们没有计算R的边缘分布，只是根据R/T的条件概率对样本进行加权并最终计算概率</p> <h5 id="gibbs-sampling">Gibbs Sampling</h5> <blockquote><p>吉布斯采样</p></blockquote> <p>P(Q|e)</p> <p>我们不会从上到下遍历网络，而像一种迭代（迭代改进）</p> <p>从一个完整实例开始，这个实例将符合已有证据。对于所有非证据节点，一个一个单独进行重新采样</p> <p>steps：</p> <ol><li>Fix evidence：固定证据节点</li> <li>Initialize other variables：随机根据条件概率初始化其他节点</li> <li>Repeat：继续单个初始化这些节点
<ul><li>Choose a non-evidence variable X</li> <li>Resample X from <code>P(X|all other variables)</code></li> <li>keep doing this</li></ul></li></ol> <p>以此获取很多根据条件概率得到的样本，随着样本数增多，各概率将逼近真实值</p> <h2 id="decision-networks-and-vpi">Decision Networks and VPI</h2> <blockquote><p>决策网和信息价值</p></blockquote> <h3 id="decision-network">Decision Network</h3> <blockquote><p>决策网络</p> <p>MEU：maximum expected utility，最大期望效用</p></blockquote> <p>根据由贝叶斯网络得出的可能性做出决策</p> <p>决策+贝叶斯网可能性=效用</p> <ul><li>chance node：机会节点（椭圆形表示）</li> <li>actions：行为、决策（矩形表示）</li> <li>utility node：产生的效用（菱形表示）</li> <li>椭圆形+矩形=菱形</li></ul> <p>A：action，W：weather，U：Utility</p> <table><thead><tr><th>A</th> <th>W</th> <th>U(A,W)</th></tr></thead> <tbody><tr><td>leave</td> <td>sun</td> <td>100</td></tr> <tr><td>leave</td> <td>rain</td> <td>0</td></tr> <tr><td>take</td> <td>sun</td> <td>20</td></tr> <tr><td>take</td> <td>rain</td> <td>70</td></tr></tbody></table> <table><thead><tr><th>W</th> <th>P(W)</th></tr></thead> <tbody><tr><td>sun</td> <td>0.7</td></tr> <tr><td>rain</td> <td>0.3</td></tr></tbody></table> <p>我们的机器人根据utility计算最佳决策并执行，做出合理的行为</p> <p>如何选择行为</p> <ul><li><p>instantiate all evidence</p> <p>初始化所有证据节点，固定之</p></li> <li><p>set action node(s) each passible way</p> <p>列出所有可能的行为路径</p></li> <li><p>calculate posterior for all parents of utility node, given the evidence</p> <p>在已有证据下计算每个效用节点父母节点的后验分布（条件概率分布）</p></li> <li><p>calculate expected utility for each action</p> <p>根据条件概率和对应效用对每个行为做出期望效用估计</p></li> <li><p>choose maximizing action</p> <p>选择效用估计最好的行为作为当前决策</p></li></ul> <p>就是说对每个行为的不同情况加权再求和，获取一个相对合理的平均值</p> <p>如选择带伞，你在赌是否下雨</p> <ul><li>下雨0.3，晴天0.7</li> <li>下雨带伞70分，晴天带伞20分</li></ul> <p>那么你的均值<code>EU(take) = 20*0.7+70*0.3=35</code>分</p> <p>同样的，我们可以计算出<code>EU(leave) = 100*0.7+0*0.3 = 70</code>分</p> <p>那么在这样的奖惩制度下，我们将选择<code>optimal action=leave</code>，获得最佳行动</p> <p>最大期望效用（在预期行为中的最大值）</p> <ul><li><code>MEU(o) = maxEU(a) = 70</code></li> <li><code>MEU(o)</code>这里的<code>o</code>表示没有任何证据</li></ul> <p>注意现在没有任何证据参与贝叶斯网络</p> <p><strong>Decisions as Outcome Trees</strong></p> <p>将这样的决策过程化成一棵树</p> <ul><li>顶点为证据集</li> <li>叶子节点为效用值（utility）</li> <li>弧为行动/状态（action）</li> <li>剩余节点为概率变量（state）</li></ul> <p>就像一个最大期望的MDP问题</p> <p>What's changed?</p> <p>我们必须对每个节点基于证据和贝叶斯网络的预测，计算给出结果的概率</p> <p>当加入证据后，概率发生变化，相应的效用也将发生变化</p> <p>如天气预报说天气不好后，晴天和雨天的概率变化</p> <table><thead><tr><th>W</th> <th>P（W|F=bad）</th></tr></thead> <tbody><tr><td>sun</td> <td>0.34</td></tr> <tr><td>rain</td> <td>0.66</td></tr></tbody></table> <p>这时最佳行动变成了<code>take</code></p> <ul><li><code>MEU(F=bad) = maxEU(a|bad) = 53</code></li></ul> <p><strong>Ghostbusters Decision Network</strong></p> <p>证据就是你探测过的点</p> <h3 id="vpi">VPI</h3> <blockquote><p>信息价值：value of perfect information</p> <ul><li>信息计算的价值</li></ul> <p>信息能够使我们的决策更加精准</p></blockquote> <p>对于互斥问题，一个价值很大，一个价值为零，信息量为零，如石油钻井，A/B区域只有一个有油，一次工作只能选择A/B一个区域</p> <table><thead><tr><th>D</th> <th>O</th> <th>U</th></tr></thead> <tbody><tr><td>a</td> <td>a</td> <td>k</td></tr> <tr><td>a</td> <td>b</td> <td>0</td></tr> <tr><td>b</td> <td>a</td> <td>0</td></tr> <tr><td>b</td> <td>b</td> <td>k</td></tr></tbody></table> <p>此时A/B的期望效用都是<code>k/2</code></p> <p>做一个调查，揭露石油的位置，假设我们知道了石油的位置，那么很明显我们的最佳预期效用将变为<code>k</code></p> <p>这样的调查就像天气问题看了天气预报一样</p> <ul><li><code>MEU(o) = maxEU(a) = 70</code></li> <li><code>MEU(F=bad) = maxEU(a|bad) = 53</code></li> <li><code>MEU(F=good) = maxEU(a|good) = 95</code></li></ul> <p>预测同样是不准确的，即有他自己的概率分布</p> <p>Forecast distribution</p> <table><thead><tr><th>F</th> <th>P(F)</th></tr></thead> <tbody><tr><td>good</td> <td>0.59</td></tr> <tr><td>bad</td> <td>0.41</td></tr></tbody></table> <p>预测给予的差距</p> <ul><li><code>difference = 0.59*95+0.41*53-70 = 7.8</code></li> <li><code>VPI = ΣP(e'|e)MEU(e,e') - MEU(e)</code></li></ul> <p>这就是VPI：即是否有预测给推理带来的差异</p> <p>预测是积极或消极影响预测的MEU大小</p> <p>当我们有证据E=e时</p> <ul><li><code>MEU(e) = maxΣP(s|e)U(s,a)</code></li></ul> <p>当我们有证据<code>e,e'</code>时</p> <ul><li><code>MEU(e,e') = maxΣP(s|e,e')U(s,a)</code></li></ul> <p>当我们的证据不确定，而是有很多值供选择时</p> <ul><li><code>MEU(e,E') = maxΣP(e'|e)U(e,e')</code></li></ul> <p>据此得到VPI为</p> <ul><li><code>VPI(E'|e) = MEU(e,E') - MEU(e)</code></li></ul> <p>在天气预报这个问题上，决策树将被预报的积极或消极状态扩展一层，并给出相应的概率和预测值</p> <p><strong>VPI是非负的</strong>，你的预测无法影响你的决策时，我们可以说<code>VPI=0</code>，即该信息没有价值</p> <p>根据信息的影响程度也分为<code>highly value, low value, 0</code></p> <p><strong>Value of Imperfect information</strong>，不完美的信息，如天气预报，有很多嘈杂的影响，我们暂不考虑这种东西</p> <p>信息揭示了随机变量的价值</p> <p><strong>Question</strong></p> <p>VPI(OilLoc)（油矿位置A/B）：k/2</p> <p>VPI(ScoutingReport)（预测油矿位置）：0-k/2（产生微弱影响）</p> <ul><li>k over 2 means k/2</li></ul> <p>VPI(scout)（是否派出了好的预测员）：0（不影响预测结果，因为在没有返回预测的前提下，你派出预测员和我获得预测是相互独立的）</p> <p>VPI(Scout|ScoutingReport)（在返回预测报告的前提得知派出预测员的优秀程度）：&gt; 0</p> <h3 id="pomdps">POMDPs</h3> <blockquote><p>部分可观察的马尔可夫决策过程</p> <p>非确定性和不确定的问题</p> <p>人生就是POMDPs</p></blockquote> <p>有多种结果，你不知道身处何处，不知道世界的规则，你只知道当前观察到的</p> <p>MDPs have</p> <ul><li>states s</li> <li>actions a</li> <li>transition function P(s'|s, a)，即P(s, a, s')</li> <li>rewards R(s,a,s')</li></ul> <p>POMDPs add</p> <ul><li>Observations O</li> <li>Observation function P(o|s)，或O(s, o)</li></ul> <p>他的作用是收集观察结果并基于证据对个结果做出评估，感知过程。评估计算通常要在贝叶斯网络中进行</p> <p>经常在进入下一层之前将进入一个<code>belief state</code>，进行各种概率评估给各状态加权，再根据转换函数和回报函数做出最佳决策</p> <ul><li>belief state</li></ul> <p><strong>POMDP Tree</strong></p> <p>really very hard</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">7/6/2023, 9:04:51 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/cs/machine/cs188/ai-mdp-rl.html" class="prev">
        马尔可夫决定过程 - 强化学习
      </a></span> <span class="next"><a href="/cs/machine/cs188/ai-hmm-ml.html">
        隐马尔科夫模型 - 机器学习
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><div class="reco-bgm-panel" data-v-b1d3339e><audio id="bgm" src="/song/aries.aac" data-v-b1d3339e></audio> <div class="reco-float-box" style="bottom:44px;z-index:999999;display:none;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><img src="/img/error.jpg" data-v-b1d3339e></div> <div class="reco-bgm-box" style="left:10px;bottom:10px;z-index:999999;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="reco-bgm-cover" style="background-image:url(/img/error.jpg);" data-v-b1d3339e><div class="mini-operation" style="display:none;" data-v-b1d3339e><i class="reco-bgm reco-bgm-pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play" style="display:none;" data-v-b1d3339e></i></div> <div class="falut-message" style="display:none;" data-v-b1d3339e>
          播放失败
        </div></div> <div class="reco-bgm-info" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-music music" data-v-b1d3339e></i>白羊</div> <div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-artist" data-v-b1d3339e></i>northboat</div> <div class="reco-bgm-progress" data-v-b1d3339e><div class="progress-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div> <div class="reco-bgm-operation" data-v-b1d3339e><i class="reco-bgm reco-bgm-last last" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-pause pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play play" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-next next" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-volume1 volume" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-mute mute" style="display:none;" data-v-b1d3339e></i> <div class="volume-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div></div> <div class="reco-bgm-left-box" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><i class="reco-bgm reco-bgm-left" data-v-b1d3339e></i></div></div></div><!----><div class="RibbonAnimation"></div><div class="Sakura" data-v-248d85d6><canvas id="canvas_sakura" style="z-index:99;" data-v-248d85d6></canvas></div></div></div>
    <script src="/assets/js/app.ea876610.js" defer></script><script src="/assets/js/5.ccbdcc26.js" defer></script><script src="/assets/js/69.cd818ffc.js" defer></script>
  </body>
</html>
