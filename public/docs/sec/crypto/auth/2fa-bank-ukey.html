<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>UKEY - å¸¸è§å®‰å…¨çš„ 2FA å®ç° | Northboat Dock</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/img/boat.ico">
    <link rel="stylesheet" href="/css/katex0.15.1.min.css">
    <script src="/js/katex0.15.1.min.js"></script>
    <script src="/js/jquery1.9.1.min.js"></script>
    <script src="/js/translation.js"></script>
    <script src="/js/crypto.js"></script>
    <script src="/js/md5.js"></script>
    <script src="/js/clock.js"></script>
    <link rel="stylesheet" href="/css/button.css">
    <meta name="description" content="Docs and Blog through My Student Period.">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.41816376.css" as="style"><link rel="preload" href="/assets/js/app.0d79b349.js" as="script"><link rel="preload" href="/assets/js/10.1029e43e.js" as="script"><link rel="preload" href="/assets/js/1.13e9bcdf.js" as="script"><link rel="preload" href="/assets/js/169.2bbadbf1.js" as="script"><link rel="prefetch" href="/assets/js/100.c942daa9.js"><link rel="prefetch" href="/assets/js/101.8bb26738.js"><link rel="prefetch" href="/assets/js/102.d0226073.js"><link rel="prefetch" href="/assets/js/103.d0e9623e.js"><link rel="prefetch" href="/assets/js/104.8d0b4a4d.js"><link rel="prefetch" href="/assets/js/105.9cd95d62.js"><link rel="prefetch" href="/assets/js/106.859f40a8.js"><link rel="prefetch" href="/assets/js/107.f59d1b9e.js"><link rel="prefetch" href="/assets/js/108.0047c99f.js"><link rel="prefetch" href="/assets/js/109.5e5c7814.js"><link rel="prefetch" href="/assets/js/11.20a09216.js"><link rel="prefetch" href="/assets/js/110.5a16e73a.js"><link rel="prefetch" href="/assets/js/111.281d374a.js"><link rel="prefetch" href="/assets/js/112.e102a5eb.js"><link rel="prefetch" href="/assets/js/113.6dcf4e87.js"><link rel="prefetch" href="/assets/js/114.8b220d02.js"><link rel="prefetch" href="/assets/js/115.eb33c0f3.js"><link rel="prefetch" href="/assets/js/116.77fe931d.js"><link rel="prefetch" href="/assets/js/117.8f8b0b2b.js"><link rel="prefetch" href="/assets/js/118.7a546c49.js"><link rel="prefetch" href="/assets/js/119.4dc1f915.js"><link rel="prefetch" href="/assets/js/12.c19fd62d.js"><link rel="prefetch" href="/assets/js/120.63973131.js"><link rel="prefetch" href="/assets/js/121.c1c0d360.js"><link rel="prefetch" href="/assets/js/122.42141712.js"><link rel="prefetch" href="/assets/js/123.57602751.js"><link rel="prefetch" href="/assets/js/124.8aed0d6c.js"><link rel="prefetch" href="/assets/js/125.9e15d6e6.js"><link rel="prefetch" href="/assets/js/126.83f2c6ba.js"><link rel="prefetch" href="/assets/js/127.b34b613a.js"><link rel="prefetch" href="/assets/js/128.6612cf2c.js"><link rel="prefetch" href="/assets/js/129.e84f433c.js"><link rel="prefetch" href="/assets/js/13.4e940e11.js"><link rel="prefetch" href="/assets/js/130.39e818f9.js"><link rel="prefetch" href="/assets/js/131.f8914134.js"><link rel="prefetch" href="/assets/js/132.1db6ab45.js"><link rel="prefetch" href="/assets/js/133.68ab88e0.js"><link rel="prefetch" href="/assets/js/134.1b9c3792.js"><link rel="prefetch" href="/assets/js/135.475f84ae.js"><link rel="prefetch" href="/assets/js/136.51a37b95.js"><link rel="prefetch" href="/assets/js/137.6620f27e.js"><link rel="prefetch" href="/assets/js/138.7810d1e7.js"><link rel="prefetch" href="/assets/js/139.9fd8d614.js"><link rel="prefetch" href="/assets/js/14.56fe2019.js"><link rel="prefetch" href="/assets/js/140.9cadd497.js"><link rel="prefetch" href="/assets/js/141.8dc3fac7.js"><link rel="prefetch" href="/assets/js/142.0a7e999d.js"><link rel="prefetch" href="/assets/js/143.e048053d.js"><link rel="prefetch" href="/assets/js/144.1b0e8b09.js"><link rel="prefetch" href="/assets/js/145.7c9a94c5.js"><link rel="prefetch" href="/assets/js/146.b1b9e5c8.js"><link rel="prefetch" href="/assets/js/147.b6a17504.js"><link rel="prefetch" href="/assets/js/148.c7e710ff.js"><link rel="prefetch" href="/assets/js/149.88248e45.js"><link rel="prefetch" href="/assets/js/15.a692a085.js"><link rel="prefetch" href="/assets/js/150.c6383c99.js"><link rel="prefetch" href="/assets/js/151.d1ae2bbd.js"><link rel="prefetch" href="/assets/js/152.b4daafd1.js"><link rel="prefetch" href="/assets/js/153.bce56b70.js"><link rel="prefetch" href="/assets/js/154.d9806c7f.js"><link rel="prefetch" href="/assets/js/155.3182eb1c.js"><link rel="prefetch" href="/assets/js/156.62749451.js"><link rel="prefetch" href="/assets/js/157.8b0a5bc9.js"><link rel="prefetch" href="/assets/js/158.5c581ac0.js"><link rel="prefetch" href="/assets/js/159.97183363.js"><link rel="prefetch" href="/assets/js/16.520970a5.js"><link rel="prefetch" href="/assets/js/160.e1a5996f.js"><link rel="prefetch" href="/assets/js/161.0f940b0d.js"><link rel="prefetch" href="/assets/js/162.0d66c89f.js"><link rel="prefetch" href="/assets/js/163.a736054a.js"><link rel="prefetch" href="/assets/js/164.1faf08f6.js"><link rel="prefetch" href="/assets/js/165.06ce54ec.js"><link rel="prefetch" href="/assets/js/166.a4194417.js"><link rel="prefetch" href="/assets/js/167.5f6caba2.js"><link rel="prefetch" href="/assets/js/168.12b3db81.js"><link rel="prefetch" href="/assets/js/17.1cf66725.js"><link rel="prefetch" href="/assets/js/170.b8bb22c7.js"><link rel="prefetch" href="/assets/js/171.a892bf3a.js"><link rel="prefetch" href="/assets/js/172.99d0431e.js"><link rel="prefetch" href="/assets/js/173.66e58e13.js"><link rel="prefetch" href="/assets/js/174.0ef3a987.js"><link rel="prefetch" href="/assets/js/175.18c5cbb5.js"><link rel="prefetch" href="/assets/js/176.dad7bc77.js"><link rel="prefetch" href="/assets/js/177.01add894.js"><link rel="prefetch" href="/assets/js/178.036cc374.js"><link rel="prefetch" href="/assets/js/179.00026c0a.js"><link rel="prefetch" href="/assets/js/18.4a9bceda.js"><link rel="prefetch" href="/assets/js/180.4f2ac12f.js"><link rel="prefetch" href="/assets/js/181.fe6a8be8.js"><link rel="prefetch" href="/assets/js/182.0e001c41.js"><link rel="prefetch" href="/assets/js/183.33b03f47.js"><link rel="prefetch" href="/assets/js/184.b9823040.js"><link rel="prefetch" href="/assets/js/185.42c95e59.js"><link rel="prefetch" href="/assets/js/186.071941c0.js"><link rel="prefetch" href="/assets/js/187.5b5062a7.js"><link rel="prefetch" href="/assets/js/188.db2c3cad.js"><link rel="prefetch" href="/assets/js/189.1867a700.js"><link rel="prefetch" href="/assets/js/19.c6dcd789.js"><link rel="prefetch" href="/assets/js/190.e9160330.js"><link rel="prefetch" href="/assets/js/20.019a3686.js"><link rel="prefetch" href="/assets/js/21.aa1175b8.js"><link rel="prefetch" href="/assets/js/22.563408fd.js"><link rel="prefetch" href="/assets/js/23.6c1a40dc.js"><link rel="prefetch" href="/assets/js/24.5567d740.js"><link rel="prefetch" href="/assets/js/25.4eaa0ed4.js"><link rel="prefetch" href="/assets/js/26.7c145dc3.js"><link rel="prefetch" href="/assets/js/27.be2faf2e.js"><link rel="prefetch" href="/assets/js/28.47c32642.js"><link rel="prefetch" href="/assets/js/29.b9a3b505.js"><link rel="prefetch" href="/assets/js/3.25823a7a.js"><link rel="prefetch" href="/assets/js/30.2dc3a272.js"><link rel="prefetch" href="/assets/js/31.b39de820.js"><link rel="prefetch" href="/assets/js/32.a7840bbf.js"><link rel="prefetch" href="/assets/js/33.60fade9f.js"><link rel="prefetch" href="/assets/js/34.4b052ac0.js"><link rel="prefetch" href="/assets/js/35.c55b6ab9.js"><link rel="prefetch" href="/assets/js/36.bd5c5df5.js"><link rel="prefetch" href="/assets/js/37.61659ca2.js"><link rel="prefetch" href="/assets/js/38.f5afbc90.js"><link rel="prefetch" href="/assets/js/39.17d75ba4.js"><link rel="prefetch" href="/assets/js/4.ab516e2e.js"><link rel="prefetch" href="/assets/js/40.bc57c3ba.js"><link rel="prefetch" href="/assets/js/41.367b8c3a.js"><link rel="prefetch" href="/assets/js/42.cd6928fb.js"><link rel="prefetch" href="/assets/js/43.af43cf88.js"><link rel="prefetch" href="/assets/js/44.357978d8.js"><link rel="prefetch" href="/assets/js/45.cd901874.js"><link rel="prefetch" href="/assets/js/46.93570280.js"><link rel="prefetch" href="/assets/js/47.d32a1e84.js"><link rel="prefetch" href="/assets/js/48.0ede43e6.js"><link rel="prefetch" href="/assets/js/49.829cc01b.js"><link rel="prefetch" href="/assets/js/5.342ab8a1.js"><link rel="prefetch" href="/assets/js/50.7aa8cf53.js"><link rel="prefetch" href="/assets/js/51.72268e49.js"><link rel="prefetch" href="/assets/js/52.e76e09f2.js"><link rel="prefetch" href="/assets/js/53.af60a5b5.js"><link rel="prefetch" href="/assets/js/54.35f7ab36.js"><link rel="prefetch" href="/assets/js/55.9d81860f.js"><link rel="prefetch" href="/assets/js/56.daad2def.js"><link rel="prefetch" href="/assets/js/57.657f4b2e.js"><link rel="prefetch" href="/assets/js/58.f6047de2.js"><link rel="prefetch" href="/assets/js/59.b6015e36.js"><link rel="prefetch" href="/assets/js/6.54fbda90.js"><link rel="prefetch" href="/assets/js/60.f99ad0e7.js"><link rel="prefetch" href="/assets/js/61.45550da6.js"><link rel="prefetch" href="/assets/js/62.c5518db8.js"><link rel="prefetch" href="/assets/js/63.4d3357ee.js"><link rel="prefetch" href="/assets/js/64.a668e6a7.js"><link rel="prefetch" href="/assets/js/65.753f4b13.js"><link rel="prefetch" href="/assets/js/66.bfc746cb.js"><link rel="prefetch" href="/assets/js/67.28b58ec6.js"><link rel="prefetch" href="/assets/js/68.51126532.js"><link rel="prefetch" href="/assets/js/69.72990917.js"><link rel="prefetch" href="/assets/js/7.ae6d9864.js"><link rel="prefetch" href="/assets/js/70.06875847.js"><link rel="prefetch" href="/assets/js/71.5dd8e37d.js"><link rel="prefetch" href="/assets/js/72.c9d09cc3.js"><link rel="prefetch" href="/assets/js/73.3fbfec16.js"><link rel="prefetch" href="/assets/js/74.08b23c27.js"><link rel="prefetch" href="/assets/js/75.ef01f285.js"><link rel="prefetch" href="/assets/js/76.60429036.js"><link rel="prefetch" href="/assets/js/77.5a045813.js"><link rel="prefetch" href="/assets/js/78.7ab63221.js"><link rel="prefetch" href="/assets/js/79.3e5e8729.js"><link rel="prefetch" href="/assets/js/8.da9bac04.js"><link rel="prefetch" href="/assets/js/80.88940583.js"><link rel="prefetch" href="/assets/js/81.947a8ea4.js"><link rel="prefetch" href="/assets/js/82.5de76cc8.js"><link rel="prefetch" href="/assets/js/83.c573ace1.js"><link rel="prefetch" href="/assets/js/84.a0f45e3a.js"><link rel="prefetch" href="/assets/js/85.86d25a32.js"><link rel="prefetch" href="/assets/js/86.a523af14.js"><link rel="prefetch" href="/assets/js/87.e98a7fa2.js"><link rel="prefetch" href="/assets/js/88.1e6e2d1b.js"><link rel="prefetch" href="/assets/js/89.c2e22907.js"><link rel="prefetch" href="/assets/js/9.031f1a6c.js"><link rel="prefetch" href="/assets/js/90.83fa8e27.js"><link rel="prefetch" href="/assets/js/91.434c91fc.js"><link rel="prefetch" href="/assets/js/92.90a6d471.js"><link rel="prefetch" href="/assets/js/93.dbbd7301.js"><link rel="prefetch" href="/assets/js/94.5ff4fc63.js"><link rel="prefetch" href="/assets/js/95.cb62136f.js"><link rel="prefetch" href="/assets/js/96.fa3b0d54.js"><link rel="prefetch" href="/assets/js/97.47779727.js"><link rel="prefetch" href="/assets/js/98.52770f81.js"><link rel="prefetch" href="/assets/js/99.662b2be0.js">
    <link rel="stylesheet" href="/assets/css/0.styles.41816376.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-7dd95ae2><div data-v-7dd95ae2><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>Northboat Dock</h3> <p class="description" data-v-59e6cb88>Docs and Blog through My Student Period.</p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>northboat</span>
        Â Â 
        <span data-v-59e6cb88>2021 - </span>
        2024
      </a></span></div></div> <div class="hide" data-v-7dd95ae2><header class="navbar" data-v-7dd95ae2><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/leaf.ico" alt="Northboat Dock" class="logo"> <span class="site-name">Northboat Dock</span></a> <div class="links"><!----> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  ä¸»é¡µ
</a></div><div class="nav-item"><a href="/categories/Blogs/" class="nav-link"><i class="iconfont reco-blog"></i>
  åšå®¢
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-document"></i>
      è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/cs/ds/" class="nav-link"><i class="undefined"></i>
  æ•°æ®ç»“æ„
</a></li><li class="dropdown-item"><!----> <a href="/docs/cs/co/" class="nav-link"><i class="undefined"></i>
  ç»„åŸ
</a></li><li class="dropdown-item"><!----> <a href="/docs/cs/cn/" class="nav-link"><i class="undefined"></i>
  è®¡ç®—æœºç½‘ç»œ
</a></li><li class="dropdown-item"><!----> <a href="/docs/cs/os/" class="nav-link"><i class="undefined"></i>
  æ“ä½œç³»ç»Ÿ
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-bokeyuan"></i>
      å¼€å‘ä¸è¿ç»´
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/devops/be/" class="nav-link"><i class="undefined"></i>
  åç«¯å¼€å‘
</a></li><li class="dropdown-item"><!----> <a href="/docs/devops/algo/" class="nav-link"><i class="undefined"></i>
  ç®—æ³•
</a></li><li class="dropdown-item"><!----> <a href="/docs/devops/ops/" class="nav-link"><i class="undefined"></i>
  æœåŠ¡å™¨è¿ç»´
</a></li><li class="dropdown-item"><!----> <a href="/docs/devops/fe/" class="nav-link"><i class="undefined"></i>
  å‰ç«¯å¼€å‘
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-eye"></i>
      ç½‘ç»œä¸ä¿¡æ¯å®‰å…¨
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/sec/crypto/" class="nav-link router-link-active"><i class="undefined"></i>
  å¯†ç å·¥ç¨‹
</a></li><li class="dropdown-item"><!----> <a href="/docs/sec/math/" class="nav-link"><i class="undefined"></i>
  æ•°å­¦
</a></li><li class="dropdown-item"><!----> <a href="/docs/sec/lib/" class="nav-link"><i class="undefined"></i>
  æ–‡å­¦ä¸æ”¿æ²»
</a></li><li class="dropdown-item"><!----> <a href="/docs/sec/cs/" class="nav-link"><i class="undefined"></i>
  ç½‘ç»œå®‰å…¨
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/northboat" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-7dd95ae2></div> <aside class="sidebar" data-v-7dd95ae2><div class="personal-info-wrapper" data-v-1fad0c41 data-v-7dd95ae2><img src="/img/boat.ico" alt="author-avatar" class="personal-img" data-v-1fad0c41> <h3 class="name" data-v-1fad0c41>
    northboat
  </h3> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>168</h3> <h6 data-v-1fad0c41>Articles</h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>33</h3> <h6 data-v-1fad0c41>Tags</h6></div></div> <ul class="social-links" data-v-1fad0c41></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  ä¸»é¡µ
</a></div><div class="nav-item"><a href="/categories/Blogs/" class="nav-link"><i class="iconfont reco-blog"></i>
  åšå®¢
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-document"></i>
      è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/cs/ds/" class="nav-link"><i class="undefined"></i>
  æ•°æ®ç»“æ„
</a></li><li class="dropdown-item"><!----> <a href="/docs/cs/co/" class="nav-link"><i class="undefined"></i>
  ç»„åŸ
</a></li><li class="dropdown-item"><!----> <a href="/docs/cs/cn/" class="nav-link"><i class="undefined"></i>
  è®¡ç®—æœºç½‘ç»œ
</a></li><li class="dropdown-item"><!----> <a href="/docs/cs/os/" class="nav-link"><i class="undefined"></i>
  æ“ä½œç³»ç»Ÿ
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-bokeyuan"></i>
      å¼€å‘ä¸è¿ç»´
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/devops/be/" class="nav-link"><i class="undefined"></i>
  åç«¯å¼€å‘
</a></li><li class="dropdown-item"><!----> <a href="/docs/devops/algo/" class="nav-link"><i class="undefined"></i>
  ç®—æ³•
</a></li><li class="dropdown-item"><!----> <a href="/docs/devops/ops/" class="nav-link"><i class="undefined"></i>
  æœåŠ¡å™¨è¿ç»´
</a></li><li class="dropdown-item"><!----> <a href="/docs/devops/fe/" class="nav-link"><i class="undefined"></i>
  å‰ç«¯å¼€å‘
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-eye"></i>
      ç½‘ç»œä¸ä¿¡æ¯å®‰å…¨
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/sec/crypto/" class="nav-link router-link-active"><i class="undefined"></i>
  å¯†ç å·¥ç¨‹
</a></li><li class="dropdown-item"><!----> <a href="/docs/sec/math/" class="nav-link"><i class="undefined"></i>
  æ•°å­¦
</a></li><li class="dropdown-item"><!----> <a href="/docs/sec/lib/" class="nav-link"><i class="undefined"></i>
  æ–‡å­¦ä¸æ”¿æ²»
</a></li><li class="dropdown-item"><!----> <a href="/docs/sec/cs/" class="nav-link"><i class="undefined"></i>
  ç½‘ç»œå®‰å…¨
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/northboat" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>ç°ä»£å¯†ç å­¦</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/sec/crypto/basic/crypto-outline-stream-cipher.html" class="sidebar-link">å¯†ç å­¦æ¦‚è¿°å’Œæµå¯†ç </a></li><li><a href="/docs/sec/crypto/basic/crypto-block-cipher.html" class="sidebar-link">åˆ†ç»„å¯†ç ä½“åˆ¶</a></li><li><a href="/docs/sec/crypto/basic/crypto-public-key.html" class="sidebar-link">å…¬é’¥å¯†ç </a></li><li><a href="/docs/sec/crypto/basic/crypto-destribution-manage.html" class="sidebar-link">å¯†é’¥åå•†ä¸åˆ†å‰²</a></li><li><a href="/docs/sec/crypto/basic/crypto-verify-hash.html" class="sidebar-link">æ¶ˆæ¯è®¤è¯å’Œå“ˆå¸Œå‡½æ•°</a></li><li><a href="/docs/sec/crypto/basic/crypto-digital-signature.html" class="sidebar-link">æ•°å­—ç­¾åç®—æ³•</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>å¯æœç´¢åŠ å¯†</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>è®¤è¯</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>UKEY - å¸¸è§å®‰å…¨çš„ 2FA å®ç°</h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>northboat</span>
        Â Â 
        <span data-v-59e6cb88>2021 - </span>
        2024
      </a></span></div></div> <div data-v-7dd95ae2><div data-v-7dd95ae2><main class="page"><section style="display:;"><div class="page-title"><h1 class="title">UKEY - å¸¸è§å®‰å…¨çš„ 2FA å®ç°</h1> <div data-v-8a445198><i class="iconfont reco-account" data-v-8a445198><span data-v-8a445198>northboat</span></i> <i class="iconfont reco-date" data-v-8a445198><span data-v-8a445198>6/22/2024</span></i> <!----> <i class="tags iconfont reco-tag" data-v-8a445198><span class="tag-item" data-v-8a445198>Authentication</span></i></div></div> <div class="theme-reco-content content__default"><h2 id="ä»€ä¹ˆæ˜¯-2fa">ä»€ä¹ˆæ˜¯ 2FAï¼Ÿ</h2> <p>2FAï¼ŒTwo-Factor Authenticationï¼Œå³åŒå› ç´ è®¤è¯</p> <ul><li>ä¼ ç»Ÿçš„è´¦å·å¯†ç ä¸ºå•é‡è®¤è¯ï¼Œå¦‚ QQ çš„ç™»å½•ï¼›Stream çš„ç™»å½•åˆ™ä¸ºåŒå› ç´ ï¼Œä¸€é‡ä¸ºè´¦å·å¯†ç ï¼ŒäºŒä¸ºæ‰‹æœºæ¥æ”¶çš„è®¤è¯ç çŸ­ä¿¡</li></ul> <p>å¯†ç  + æŸç§ä¸ªäººç‰©å“æ˜¯å¸¸è§çš„åŒå› ç´ ç»„åˆï¼Œå¦‚é“¶è¡Œä½¿ç”¨çš„ U ç›¾ï¼ˆä¸€ä¸ª U ç›˜ï¼‰ï¼Œåœ¨æ­¤å¤„ U ç›¾ å……å½“â€œæŸç§ä¸ªäººç‰©å“â€çš„ä½œç”¨ï¼Œæ¯ä½ç”¨æˆ·å°†é…å¤‡å„è‡ªçš„ U ç›¾ï¼Œå†…ç½®æœ‰ç”¨æˆ·çš„ç­¾åè¯ä¹¦ä¸åŠ å¯†è¯ä¹¦ï¼ŒåŒæ—¶ U ç›¾çš„è®¿é—®å— PIN ç ä¿æŠ¤</p> <p>ä¸€ç§å…¸å‹å®ç°æ–¹æ¡ˆä¸º</p> <ul><li>ç”¨æˆ·åœ¨å®Œæˆå£ä»¤ã€éªŒè¯ç çš„è¾“å…¥åï¼Œå‰ç«¯è°ƒç”¨ USBKEY çš„æ¥å£å¯¹ç™»å½•è¯·æ±‚æ•°æ®è¿›è¡Œç­¾åï¼Œå¹¶ä¸”å°†è¯¥ç­¾åä½œä¸ºä¸€ä¸ªå­—æ®µåŠ å…¥ HTTP è¯·æ±‚ä¸­</li> <li>åç«¯ç³»ç»Ÿä¼šéƒ¨ç½²ä¸€ä¸ªç­¾åéªŒç­¾æœåŠ¡å™¨ï¼Œæ¥æ”¶åˆ°å‰ç«¯ç™»å½•è¯·æ±‚åï¼Œåˆ©ç”¨ç­¾åéªŒç­¾æœåŠ¡å™¨å®ŒæˆéªŒç­¾ï¼ŒéªŒç­¾æ­£ç¡®åˆ™èº«ä»½é‰´åˆ«é€šè¿‡ï¼Œè€Œåå†è¿›è¡Œå¯†ç çš„è®¤è¯ï¼Œå®ç°åŒå› ç´ è®¤è¯</li></ul> <p>æœ¬æ–‡é‡‡ç”¨å¥¥è”çš„ USBKEY ä»¥åŠå…¶ç›¸å¯¹åº”çš„å¯†ç æœºå®ç° U ç›¾çš„ 2FA è®¤è¯ã€‚çœŸçš„ä¸å¾—ä¸è¯´ï¼Œå¥¥è”ç»™çš„æ¥å£ç®€ç›´æ˜¯ä¸€å¨å¤§èŠ¬ğŸ¤®ï¼Œæ–‡æ¡£æ›´æ˜¯ç‰›å¤´ä¸å¯¹é©¬å˜´</p> <h2 id="å®ç°">å®ç°</h2> <p>ä¸€äº›å‰ç½®å·¥ä½œ</p> <ul><li>ç”¨æˆ· UKEY ä¸­æ‰€ä½¿ç”¨çš„ç­¾åè¯ä¹¦éœ€è¦åœ¨åç«¯ç­¾åéªŒç­¾æœåŠ¡å™¨ä¸­æ³¨å†Œ</li> <li>ä¸‹è½½å®‰è£… UKEY çš„æ’ä»¶ç¯å¢ƒ</li> <li>éœ€è¦ä¸€ä¸ªå€’éœ‰è›‹å°† U ç›˜ä»è¥¿å®‰é‚®åˆ°ç§¦çš‡å²›</li></ul> <h3 id="ukey-ç¯å¢ƒæ£€æµ‹">UKEY ç¯å¢ƒæ£€æµ‹</h3> <p>é‡‡ç”¨ WebSocket å½¢å¼çš„æ¥å£ï¼ˆæ„å¼å¥¥è”æä¾›çš„ï¼‰å¯¹å‰ç«¯è¡¨å•æ•°æ®è¿›è¡Œ SGD_SM3_SM2 è¿›è¡Œç­¾åï¼Œè¯¥ UKEY æ¥å£å†…éƒ¨å†™æ­» SignerID ä¸º<code>&quot;1234567812345678&quot;</code>ï¼ˆé»˜è®¤ IDï¼‰ï¼Œè¿™åœ¨åç»­éªŒç­¾æ—¶éœ€ä¿æŒä¸€è‡´</p> <p>æ£€æµ‹æ’ä»¶ç¯å¢ƒä»¥åŠæ˜¯å¦æ’å…¥ U ç›¾</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">envCheck</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>ntlsUtil<span class="token punctuation">.</span>wsObj<span class="token punctuation">)</span><span class="token punctuation">{</span>
        ntlsUtil<span class="token punctuation">.</span><span class="token function">websocketInit</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>check_plugin_exist<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>check_plugin_exist<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">check_plugin_exist</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>ntlsUtil æ˜¯ä»å¥¥è”æ¥å£ä¸­å¯¼å…¥çš„å…¨å±€å·¥å…·ç±»</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> ntlsUtil <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/utils/ntls-plugin'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å¦‚æœ ntlsUtil.wsObj ä¸ä¸ºç©ºï¼Œå³ websocket è¿æ¥æ‰“å¼€ï¼Œåˆ™è®¤ä¸ºå·²ç»æ£€æŸ¥è¿‡ä¸è¿›è¡Œåç»­æ“ä½œï¼ˆå› ä¸ºæ£€æŸ¥è¿‡ç¨‹ä¼šä¸»åŠ¨æ‰“å¼€ websocketï¼Œè‹¥åœ¨å·²è¿æ¥çš„æƒ…å†µä¸‹å†æ‰“å¼€ä¼šæŠ¥é”™ï¼Œæ‰€ä»¥è¿™é‡Œè¿™ä¹ˆå¤„ç†ï¼Œä½†åœ¨åç»­å¼•å‘äº†å…¶ä»–é—®é¢˜ï¼‰</p> <p>æ’ä»¶æ£€æŸ¥</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//æ£€æŸ¥æ’ä»¶</span>
<span class="token function">check_plugin_exist</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ntlsUtil<span class="token punctuation">.</span>pluginExist<span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//è¿æ¥ä¸æˆåŠŸ,æ’ä»¶æœªå®‰è£…æˆ–è€…æœåŠ¡æœªå¯åŠ¨</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;è¿æ¥ä¸æˆåŠŸ,æ’ä»¶æœªå®‰è£…æˆ–è€…æœåŠ¡æœªå¯åŠ¨&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//step4 æ£€æµ‹æ˜¯å¦æ’å…¥ukey, æ‰€æœ‰æ¥æ”¶ä¿¡æ¯çš„å›è°ƒå‡½æ•°åç§°éƒ½ä¸ºå½“å‰å‘é€æ¶ˆæ¯çš„actionåç§° </span>
    ntlsUtil<span class="token punctuation">.</span>func<span class="token punctuation">.</span><span class="token function">enumerate_ukey_user</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>enumerate_ukey_user<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><code>ntlsUtil.func.enumerate_ukey_user()</code>æ˜¯ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œä¼ å‚ä¸ºå›è°ƒå‡½æ•°ï¼Œå¯¹å¼‚æ­¥è¿”å›çš„æ•°æ®è¿›è¡Œå¤„ç†ï¼Œ<code>this.enumerate_ukey_user</code>å¦‚ä¸‹</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">enumerate_ukey_user</span><span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>message <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;WebSocketæ£€æµ‹è¯·æ±‚å¤±è´¥&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> ukey_exist <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> message<span class="token punctuation">.</span>data<span class="token punctuation">.</span>usbkey<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> key_data <span class="token operator">=</span> message<span class="token punctuation">.</span>data<span class="token punctuation">.</span>usbkey<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> key_data<span class="token punctuation">.</span>keytype <span class="token operator">!=</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>check_key_type <span class="token operator">==</span> <span class="token boolean">true</span> <span class="token operator">&amp;&amp;</span>  key_data<span class="token punctuation">.</span>keytype <span class="token operator">!=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>key_type <span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token punctuation">}</span>
            <span class="token keyword">else</span><span class="token punctuation">{</span>
                <span class="token comment">//keytype=file åœ¨ç§é’¥æ ‡è¯†ä¸­æŸ¥æ‰¾ï¼Œä»æ¯ä¸ªidentity.0.type æŸ¥æ‰¾sm2/sm9/...</span>
                <span class="token keyword">var</span> this_ukey_exist <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> length <span class="token operator">=</span> key_data<span class="token punctuation">.</span>identity<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> m <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> m <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> m<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    <span class="token comment">//åªåŒ¹é…éœ€è¦çš„alg</span>
                    <span class="token keyword">if</span><span class="token punctuation">(</span>key_data<span class="token punctuation">.</span>identity<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span>type<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>alg_type<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                        this_ukey_exist <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//å±€éƒ¨</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>this_ukey_exist<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    ukey_exist <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//å…¨å±€</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">//key_type=usbkey  åœ¨äº§å•†ä¸­æŸ¥æ‰¾</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>key_data<span class="token punctuation">.</span>manufacturer<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>alg_type<span class="token punctuation">)</span><span class="token operator">!==</span><span class="token operator">-</span><span class="token number">1</span> <span class="token operator">||</span> key_data<span class="token punctuation">.</span>alg<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>alg_type<span class="token punctuation">)</span><span class="token operator">!==</span><span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
                ukey_exist <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ukey_exist <span class="token operator">==</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'æœªæ£€æµ‹åˆ°'</span><span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>alg_type<span class="token operator">+</span><span class="token string">'ç§é’¥æ ‡è¯†'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//æŒ‰æ‰­åŠŸèƒ½ ï¼Œæ£€æµ‹sm2/sm9ç­‰ UKEYæ˜¯å¦æ’ä»¶</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æ£€æµ‹åˆ°'</span><span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>alg_type<span class="token operator">+</span><span class="token string">'ç§é’¥æ ‡è¯†'</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>keyindex <span class="token operator">=</span> message<span class="token punctuation">.</span>data<span class="token punctuation">.</span>usbkey<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>keyindex<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>container <span class="token operator">=</span> message<span class="token punctuation">.</span>data<span class="token punctuation">.</span>usbkey<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>identity<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>container<span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;keyindex: &quot;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>keyindex <span class="token operator">+</span> <span class="token string">&quot;\ncontainer: &quot;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>container<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>ret <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><p>è¯·æ±‚å®Œæ¯•åï¼Œå°† UKEY ä¸­çš„<code>keyindex</code>å’Œ<code>container</code>å­˜åœ¨å‰ç«¯ç»´æŠ¤çš„ä¸¤ä¸ªå˜é‡ä¸­ï¼Œåœ¨åç»­ç™»é™†æ—¶ä½¿ç”¨</p> <h3 id="ç”¨æˆ·æ³¨å†Œ">ç”¨æˆ·æ³¨å†Œ</h3> <p>ç³»ç»Ÿè¦æ±‚ç”¨æˆ·æ³¨å†Œæ—¶å½•å…¥ç”¨æˆ·æ‰€ä½¿ç”¨ UKEY ä¸­çš„è¯ä¹¦ä¿¡æ¯ï¼ŒåŒæ ·é‡‡ç”¨å¼‚æ­¥å‡½æ•°è·å–</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">handleRegister</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>registerForm<span class="token punctuation">.</span><span class="token function">validate</span><span class="token punctuation">(</span><span class="token parameter">valid</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>valid<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>loading <span class="token operator">=</span> <span class="token boolean">true</span>
            <span class="token keyword">let</span> ukey_val <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>keyindex<span class="token punctuation">;</span>
            <span class="token keyword">let</span> identity_val <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>container<span class="token punctuation">;</span>
            ntlsUtil<span class="token punctuation">.</span>func<span class="token punctuation">.</span><span class="token function">get_cert_content</span><span class="token punctuation">(</span>ukey_val<span class="token punctuation">,</span> identity_val<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>doRegister<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token comment">// message ä¸­ä¸ºè¯ä¹¦ä¿¡æ¯</span>
<span class="token function">doRegister</span><span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>message <span class="token operator">||</span> <span class="token operator">!</span>message<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;è·å–è¯ä¹¦å†…å®¹å¤±è´¥&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
    <span class="token comment">// æˆªå–cert</span>
    <span class="token keyword">let</span> cert <span class="token operator">=</span> message<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\r\n]</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cert <span class="token operator">=</span> cert<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">27</span><span class="token punctuation">,</span> cert<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
    cert <span class="token operator">=</span> cert<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> cert<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>cert<span class="token punctuation">)</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>registerForm<span class="token punctuation">.</span>certificate <span class="token operator">=</span> cert<span class="token punctuation">;</span>
    <span class="token function">register</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>registerForm<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$message</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'æ³¨å†ŒæˆåŠŸï¼Œå³å°†è¿”å›ç™»å½•é¡µé¢ï¼'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'success'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">2000</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>loginForm<span class="token punctuation">.</span>username <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>registerForm<span class="token punctuation">.</span>username
        <span class="token keyword">this</span><span class="token punctuation">.</span>loginForm<span class="token punctuation">.</span>password <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>registerForm<span class="token punctuation">.</span>password
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>switchLogin <span class="token operator">=</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1500</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">[</span><span class="token string">'registerForm'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">resetFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">finally</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>loading <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><h3 id="ç­¾ååŠç™»å½•">ç­¾ååŠç™»å½•</h3> <p>è¡¨å•æ•°æ®åœ¨ç­¾åå‰éœ€è¦è¿›è¡Œ Base64 ç¼–ç å¤„ç†</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">encodeBase64</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">'base64'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>ç”¨æˆ·æ³¨å†ŒæˆåŠŸï¼Œå¹¶ä¸”åœ¨é¡µé¢æ­£å¸¸è·å¾— UKEY ä¿¡æ¯åï¼Œæ‰§è¡Œç™»é™†æ“ä½œï¼Œpass ä¸º UKEY çš„ PIN ç ï¼Œéœ€è¦ç”¨æˆ·åœ¨å‰ç«¯æ‰‹åŠ¨è¾“å…¥</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// ç™»å½•</span>
<span class="token function">handleLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>loginForm<span class="token punctuation">.</span><span class="token function">validate</span><span class="token punctuation">(</span><span class="token parameter">valid</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        valid <span class="token operator">=</span> valid <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ret <span class="token comment">// this.ret åœ¨ç¯å¢ƒæ£€æµ‹é€šè¿‡åç½®ä¸º trueï¼Œvalid ä¸ºè¡¨å•æ•°æ®åˆæ³•æ€§</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>valid<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>loading <span class="token operator">=</span> <span class="token boolean">true</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>loginForm<span class="token punctuation">.</span>iniData <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>loginForm<span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>loginForm<span class="token punctuation">.</span>iniData<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> inData <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">encodeBase64</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>loginForm<span class="token punctuation">.</span>iniData<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> ukey_val <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>keyindex<span class="token punctuation">;</span>
            <span class="token keyword">let</span> identity_val <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>container<span class="token punctuation">;</span>
            <span class="token keyword">let</span> pass <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>loginForm<span class="token punctuation">.</span>key<span class="token punctuation">;</span>
            <span class="token keyword">let</span> hashtype <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> format <span class="token operator">=</span> <span class="token string">&quot;asn.1&quot;</span><span class="token punctuation">;</span>
            <span class="token comment">// æ³¨æ„è¿™é‡Œè¦æ ‡æ˜ format ä¸º asn.1</span>
            ntlsUtil<span class="token punctuation">.</span>func<span class="token punctuation">.</span><span class="token function">data_sm2_signature</span><span class="token punctuation">(</span>ukey_val<span class="token punctuation">,</span> identity_val<span class="token punctuation">,</span> pass<span class="token punctuation">,</span> inData<span class="token punctuation">,</span> hashtype<span class="token punctuation">,</span> format<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>doLogin<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'error submit!!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;error submit!&quot;</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>æ ¸å¿ƒåœ¨äºè¿™æ¡åŠ å¯†å‡½æ•°</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>ntlsUtil<span class="token punctuation">.</span>func<span class="token punctuation">.</span><span class="token function">data_sm2_signature</span><span class="token punctuation">(</span>ukey_val<span class="token punctuation">,</span> identity_val<span class="token punctuation">,</span> pass<span class="token punctuation">,</span> inData<span class="token punctuation">,</span> hashtype<span class="token punctuation">,</span> format<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>doLogin<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><code>ukey_val</code>å’Œ<code>identity_val</code>ä¸ºç¯å¢ƒæ£€æµ‹æ—¶è·å–çš„ UKEY ä¿¡æ¯<code>keyindex</code>å’Œ<code>container</code>ï¼Œ<code>pass</code>ä¸º UKEY çš„ PIN ç ï¼Œ<code>inData</code>ä¸ºç™»é™†çš„è¡¨å•åŸæ–‡ï¼ˆJson æ•°æ®ï¼‰ï¼Œå¦‚</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token string">&quot;{\&quot;account\&quot;:\&quot;wx\&quot;, \&quot;password\&quot;:\&quot;123456\&quot;, \&quot;verify_code\&quot;:\&quot;dQ3k\&quot;, \&quot;PIN\&quot;:\&quot;123456\&quot;}&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><code>this.doLogin</code>ä¸ºå›è°ƒå‡½æ•°ï¼Œä¼ å…¥çš„<code>message</code>ä¸ºç­¾åæ•°æ®</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// æ‰“è¯·æ±‚</span>
<span class="token function">doLogin</span><span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>message <span class="token operator">||</span> <span class="token operator">!</span>message<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;ç­¾åå¤±è´¥, è¯·æ£€æŸ¥UKeyæ˜¯å¦æ’å…¥æˆ–PINç æ˜¯å¦æ­£ç¡®, æˆ–PINç æ˜¯å¦è¢«é”å®š&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>loading <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;ç­¾åæ‰€ç”¨è¯ä¹¦ä¸º: &quot;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cert  <span class="token operator">+</span> <span class="token string">&quot;\nå‰ç«¯ç­¾ååŸæ–‡ä¸º&quot;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">encodeBase64</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>loginForm<span class="token punctuation">.</span>iniData<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\nå‰ç«¯ç­¾åæ‰€å¾—å¯†æ–‡ä¸º: &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>loginForm<span class="token punctuation">.</span>signature <span class="token operator">=</span> message<span class="token punctuation">.</span>data<span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'user/login'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>loginForm<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">&quot;pin&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>loginForm<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">&quot;keyindex&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>keyindex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">&quot;container&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>container<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>redirect <span class="token operator">||</span> <span class="token string">'/'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>loading <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>loading <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>æ³¨æ„ä¼ å…¥çš„åŸæ–‡æ•°æ®éœ€è¦æ˜¯ Base64 ç¼–ç ï¼Œå¹¶ä¸”åœ¨ç­¾åæ—¶ï¼Œå¿…é¡»è¦è§„å®šä¼ å‚<code>format</code>ä¸º<code>asn.1</code>ï¼Œæ‰èƒ½ç­¾åå¾—åˆ° Base64 ç¼–ç çš„å¯†æ–‡ï¼Ÿå¥¥è”çœŸçš„æ˜¯ä¸€å¨æ„æ€</p> <p>å¦å¤–è¿™é‡Œéå¸¸ä¸ä¼˜é›…çš„æŠŠä¸€ç³»åˆ—ä¿¡æ¯å­˜åˆ°äº† localStorageï¼Œå› ä¸ºåœ¨åç»­çš„è½¬è´¦æ“ä½œä¸­è¦ç”¨åˆ°ï¼Œä¸ºä»€ä¹ˆè¦è¿™ä¹ˆå†™ï¼Ÿï¼Ÿå”‰ï¼Œæ˜¯è¿™æ ·</p> <ol><li>ä¹‹å‰åœ¨æ£€æµ‹ç¯å¢ƒæ—¶è¯´è¿‡ï¼Œæ˜¯å¦æ£€æµ‹çš„æ¡ä»¶æ˜¯ websocket æ˜¯å¦è¿æ¥ï¼Œè¿™å°±é€ æˆç™»å½•æ—¶ç”¨çš„è¿™ä¸ªè¿æ¥ä¸€ç›´ä¿æŒï¼Œäºæ˜¯åœ¨åç»­å¹¶ä¸ä¼šè¿›è¡Œç¯å¢ƒæ£€æµ‹</li> <li>æ‰€ä»¥å‘¢ï¼Œåœ¨è½¬è´¦é¡µé¢ï¼Œæ²¡æœ‰è¿›è¡Œç¯å¢ƒæ£€æµ‹ï¼Œè‡ªç„¶å°±ä¸ä¼šå»éå†é’¥åŒ™ï¼Œå°±ä¸ä¼šè·å¾—<code>keyindex</code>å’Œ<code>container</code>ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘å·æ‡’ç›´æ¥å­˜äº†ï¼Œåˆ°æ—¶å€™ç›´æ¥å–äº†ç”¨</li></ol> <p>æ­£ç¡®çš„æµç¨‹åº”è¯¥æ˜¯ï¼šåœ¨ç™»é™†æˆåŠŸåï¼Œä¸»åŠ¨æ–­å¼€ websocket è¿æ¥ï¼Œåœ¨è½¬è´¦é¡µé¢é‡å¤ä¸Šè¿°æµç¨‹è·å–é’¥åŒ™ä¿¡æ¯å†è¿›è¡Œç­¾åæ“ä½œï¼Œä½†æ˜¯ä»–å°±ç»™äº†æˆ‘ 1kï¼Œæˆ‘æ‡’å¾—å†™äº†ï¼Œåæ­£ç”²æ–¹æ²¡æ‰¾æˆ‘éº»çƒ¦</p> <h3 id="éªŒç­¾å®ç°">éªŒç­¾å®ç°</h3> <p>å‰ç«¯å°†åŸå§‹è¡¨å•æ•°æ®ï¼ˆåŸæ–‡ï¼‰å’Œç­¾åæ•°æ®ï¼ˆå¯†æ–‡ï¼‰ä¸€åŒæ‰“åœ¨åç«¯æ¥å£ä¸Šï¼Œåç«¯æ¥æ”¶åˆ°è¯·æ±‚åï¼Œé¦–å…ˆæ ¹æ®ç”¨æˆ·åä»æ•°æ®åº“ä¸­å–å‡ºç”¨æˆ·è¯ä¹¦ï¼Œå†å¯¹å‰ç«¯ä¼ æ¥çš„åŸæ–‡å’Œå¯†æ–‡é€šè¿‡è¯ä¹¦å’Œç­¾åéªŒç­¾æœåŠ¡å™¨è¿›è¡ŒéªŒè¯ï¼Œè¿”å›<code>true/false</code>ï¼Œå®ç°ä¸€é‡è®¤è¯</p> <p>Controller å±‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/login&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Result</span> <span class="token function">doLogin</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">LoginInfoDTO</span> user<span class="token punctuation">,</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">CryptoException</span><span class="token punctuation">,</span> <span class="token class-name">UnsupportedEncodingException</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;signature: &quot;</span><span class="token operator">+</span> user<span class="token punctuation">.</span><span class="token function">getSignature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">HttpSession</span> session <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> gencode <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> session<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;index_code&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Result</span><span class="token punctuation">.</span><span class="token function">ERROR</span><span class="token punctuation">(</span><span class="token string">&quot;éªŒè¯ç ä¸èƒ½ä¸ºç©º&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;éªŒè¯ç ï¼š &quot;</span> <span class="token operator">+</span> gencode<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>gencode<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Result</span><span class="token punctuation">.</span><span class="token function">ERROR</span><span class="token punctuation">(</span><span class="token string">&quot;éªŒè¯ç é”™è¯¯&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//éªŒè¯ç”¨æˆ·ç™»å½•ç­¾åä¿¡æ¯</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getSignature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Result</span><span class="token punctuation">.</span><span class="token function">ERROR</span><span class="token punctuation">(</span><span class="token string">&quot;ç­¾åä¿¡æ¯ä¸èƒ½ä¸ºç©º&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">String</span> jwtToken <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">doLogin</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>jwtToken <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Result</span><span class="token punctuation">.</span><span class="token function">ERROR</span><span class="token punctuation">(</span><span class="token string">&quot;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯!!!!!!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ç”¨æˆ·ç™»å½•&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">Result</span><span class="token punctuation">.</span><span class="token function">OK</span><span class="token punctuation">(</span>jwtToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>ä¸»è¦çš„éªŒè¯ä¸šåŠ¡å†<code>String jwtToken = userService.doLogin(user)</code>è¿™ä¸€è¡Œ</p> <p>Service å±‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">doLogin</span><span class="token punctuation">(</span><span class="token class-name">LoginInfoDTO</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">User</span> uu <span class="token operator">=</span> userMapper<span class="token punctuation">.</span><span class="token function">findByName</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> cert <span class="token operator">=</span> uu<span class="token punctuation">.</span><span class="token function">getCertificate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> iniData <span class="token operator">=</span> user<span class="token punctuation">.</span><span class="token function">getIniData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> signData <span class="token operator">=</span> user<span class="token punctuation">.</span><span class="token function">getSignature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;iniData: &quot;</span> <span class="token operator">+</span> iniData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;signature: &quot;</span> <span class="token operator">+</span> signData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">boolean</span> flag <span class="token operator">=</span> <span class="token class-name">OlymSignature</span><span class="token punctuation">.</span><span class="token function">verifySignature</span><span class="token punctuation">(</span>cert<span class="token punctuation">,</span> iniData<span class="token punctuation">,</span> signData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token function">doLogin</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>ç¬¬ä¸€é‡è®¤è¯åœ¨<code>boolean flag = OlymSignature.verifySignature(cert, iniData, signData);</code></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">verifySignature</span><span class="token punctuation">(</span><span class="token class-name">String</span> cert<span class="token punctuation">,</span> <span class="token class-name">String</span> inData<span class="token punctuation">,</span> <span class="token class-name">String</span> signed<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">boolean</span> flag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span><span class="token punctuation">{</span>
        flag <span class="token operator">=</span> <span class="token function">verify</span><span class="token punctuation">(</span>cert<span class="token punctuation">,</span> inData<span class="token punctuation">,</span> signed<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;----------&gt;éªŒç­¾å‡ºé”™&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> flag<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>verify å‡½æ•°å°è£…ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œæ‰“å‘åç«¯å†…ç½‘ä¸­çš„å¯†ç æœºï¼Œè·å–éªŒç­¾ç»“æœï¼Œè¿™é‡Œçš„ cert æ˜¯æ³¨å†Œæ—¶ç”¨æˆ·å­˜å…¥æ•°æ®åº“çš„é‚£ä»½è¯ä¹¦ï¼ŒinData å’Œ signature åˆ†åˆ«æ˜¯ä»å‰ç«¯æ‰“æ¥çš„è¡¨å•åŸæ–‡ä¿¡æ¯å’Œå‰ç«¯çš„ç­¾åä¿¡æ¯</p> <ul><li>æ‰€ä»¥è¿™é‡Œçš„éªŒç­¾å®é™…ä¸Šå°±æ˜¯ï¼Œæ ¹æ®ç”¨æˆ·åœ¨åç«¯å­˜çš„è¯ä¹¦ certï¼Œå¯¹ç”¨æˆ·çš„åŸæ–‡åŠ å¯†ï¼Œå¹¶å’Œç”¨æˆ·åœ¨å‰ç«¯çš„å¯†æ–‡è¿›è¡Œæ¯”å¯¹ï¼Œè‹¥ä¸€è‡´åˆ™è®¤è¯é€šè¿‡</li></ul> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">verify</span><span class="token punctuation">(</span><span class="token class-name">String</span> cert<span class="token punctuation">,</span> <span class="token class-name">String</span> inData<span class="token punctuation">,</span> <span class="token class-name">String</span> signature<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>cert <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        cert <span class="token operator">=</span> <span class="token class-name">Cert</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> signerIDBytes <span class="token operator">=</span> <span class="token class-name">SignerID</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Integer</span> signerIDLen <span class="token operator">=</span> signerIDBytes<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token class-name">String</span> signerID <span class="token operator">=</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">encodeToString</span><span class="token punctuation">(</span>signerIDBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> inDataBytes <span class="token operator">=</span> inData<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Integer</span> inDataLen <span class="token operator">=</span> inDataBytes<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>inDataLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
    inData <span class="token operator">=</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">encodeToString</span><span class="token punctuation">(</span>inDataBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;éªŒç­¾æ‰€ä½¿ç”¨çš„è¯ä¹¦ä¸º: &quot;</span> <span class="token operator">+</span> cert<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;éªŒç­¾æ‰€ä½¿ç”¨çš„åŸæ–‡ä¸º: &quot;</span> <span class="token operator">+</span> inData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;éªŒç­¾æ‰€ä½¿ç”¨çš„ç­¾åå¯†æ–‡ä¸º: &quot;</span> <span class="token operator">+</span> signature<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;éªŒç­¾æ‰€ä½¿ç”¨çš„ç­¾åIDä¸º: &quot;</span> <span class="token operator">+</span> signerID<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">VerifySignedDataReq</span> verifySignedDataReq <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VerifySignedDataReq</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    verifySignedDataReq<span class="token punctuation">.</span><span class="token function">setSignMethod</span><span class="token punctuation">(</span><span class="token constant">SGD_SM3_SM2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    verifySignedDataReq<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token class-name">Type</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    verifySignedDataReq<span class="token punctuation">.</span><span class="token function">setCert</span><span class="token punctuation">(</span>cert<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Typeä¸º1æ—¶certSNæ²¡ç”¨ï¼Œå°†ä½¿ç”¨cert</span>
    verifySignedDataReq<span class="token punctuation">.</span><span class="token function">setInData</span><span class="token punctuation">(</span>inData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    verifySignedDataReq<span class="token punctuation">.</span><span class="token function">setInDataLen</span><span class="token punctuation">(</span>inDataLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è¿™ä¸ªIDé»˜è®¤ä¸º&quot;1234567812345678&quot;</span>
    verifySignedDataReq<span class="token punctuation">.</span><span class="token function">setSignerID</span><span class="token punctuation">(</span>signerID<span class="token punctuation">)</span><span class="token punctuation">;</span>
    verifySignedDataReq<span class="token punctuation">.</span><span class="token function">setSignerIDLen</span><span class="token punctuation">(</span>signerIDLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
    verifySignedDataReq<span class="token punctuation">.</span><span class="token function">setSignature</span><span class="token punctuation">(</span>signature<span class="token punctuation">)</span><span class="token punctuation">;</span>
    verifySignedDataReq<span class="token punctuation">.</span><span class="token function">setVerifyLevel</span><span class="token punctuation">(</span><span class="token class-name">VerifyLevel</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>verifySignedDataReq<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Integer</span> verifySignedDataResult <span class="token operator">=</span> <span class="token class-name">SignVerifyUtil</span><span class="token punctuation">.</span><span class="token function">verifySignedData</span><span class="token punctuation">(</span>verifySignedDataReq<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
        <span class="token string">&quot;å•åŒ…éªŒè¯æ•°å­—ç­¾åç»“æœï¼š&quot;</span> <span class="token operator">+</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token constant">SVSRESPONSE_RESPVALUE_SUCCESS</span><span class="token punctuation">,</span> verifySignedDataResult<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">SignVerifyUtil</span><span class="token punctuation">.</span><span class="token function">verifySignedData</span><span class="token punctuation">(</span>verifySignedDataReq<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><p>è€Œåçš„äºŒé‡è®¤è¯<code>doLogin(user.getUsername(), user.getPassword())</code>å°±æ˜¯æ•°æ®åº“å¯†ç è®¤è¯ï¼Œä¸å†èµ˜è¿°</p> <h3 id="å¤–éƒ¨-jar-å¼•å…¥æ‰“åŒ…">å¤–éƒ¨ jar å¼•å…¥æ‰“åŒ…</h3> <p>IDEA éœ€è¦åœ¨<code>Project Structure</code>ä¸­æ·»åŠ <code>Modules</code>ï¼ŒåŒæ—¶åœ¨<code>pom.xml</code>ä¸­é…ç½®å¯¼å‡º</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--å¤–éƒ¨å¼•ç”¨ï¼Œæ‰“åŒ…æ—¶è¦åŒ…å«è¿›å»--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>obymtect.ibc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>sign<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>system<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>systemPath</span><span class="token punctuation">&gt;</span></span>${pom.basedir}/lib/olymibc.jar<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>systemPath</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
                <span class="token comment">&lt;!-- åœ¨æ‰“åŒ…æ—¶å°†å¼•ç”¨çš„å¤–éƒ¨jarå¼•å…¥åˆ°å½“å‰é¡¹ç›®åŒ…ä¸­	--&gt;</span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>includeSystemScope</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>includeSystemScope</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="åè®°">åè®°</h2> <p>å…³äºè¿™ä¸ªæ–¹æ¡ˆï¼Œç”¨æˆ·ä¸å¯èƒ½éšæ—¶æºå¸¦ U ç›¾ï¼Œæ‰‹æœºæ‰æ˜¯æœ€å¥½çš„æ›¿ä»£å“ã€‚å¯†ç  + æ‰‹æœºå°±æˆäº†æœ€ä½³çš„åŒå› ç´ è®¤è¯æ–¹æ¡ˆï¼ˆfrom é˜®ä¸€å³°ï¼‰</p> <p>å¦å¤–ï¼Œå¥¥è”çš„æ¥å£ï¼Œè°ç”¨è°çŸ¥é“ï¼Œæ— æ•Œäº†</p></div></section> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">10/4/2024, 10:15:07 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/docs/sec/crypto/auth/auth-survey.html" class="prev">
          ç»¼è¿°
        </a></span> <span class="next"><a href="/docs/sec/crypto/auth/2fa-github-totp.html">
          TOTP - GitHub çš„ç™»å½•è®¤è¯æ–¹æ¡ˆ
        </a></span></p></div> <div class="comments-wrapper"><!----></div></main></div> <!----></div> <ul class="sub-sidebar sub-sidebar-wrapper" style="width:12rem;" data-v-b57cc07c data-v-7dd95ae2><li class="level-2" data-v-b57cc07c><a href="/docs/sec/crypto/auth/2fa-bank-ukey.html#ä»€ä¹ˆæ˜¯-2fa" class="sidebar-link reco-side-ä»€ä¹ˆæ˜¯-2fa" data-v-b57cc07c>ä»€ä¹ˆæ˜¯ 2FAï¼Ÿ</a></li><li class="level-2" data-v-b57cc07c><a href="/docs/sec/crypto/auth/2fa-bank-ukey.html#å®ç°" class="sidebar-link reco-side-å®ç°" data-v-b57cc07c>å®ç°</a></li><li class="level-3" data-v-b57cc07c><a href="/docs/sec/crypto/auth/2fa-bank-ukey.html#ukey-ç¯å¢ƒæ£€æµ‹" class="sidebar-link reco-side-ukey-ç¯å¢ƒæ£€æµ‹" data-v-b57cc07c>UKEY ç¯å¢ƒæ£€æµ‹</a></li><li class="level-3" data-v-b57cc07c><a href="/docs/sec/crypto/auth/2fa-bank-ukey.html#ç”¨æˆ·æ³¨å†Œ" class="sidebar-link reco-side-ç”¨æˆ·æ³¨å†Œ" data-v-b57cc07c>ç”¨æˆ·æ³¨å†Œ</a></li><li class="level-3" data-v-b57cc07c><a href="/docs/sec/crypto/auth/2fa-bank-ukey.html#ç­¾ååŠç™»å½•" class="sidebar-link reco-side-ç­¾ååŠç™»å½•" data-v-b57cc07c>ç­¾ååŠç™»å½•</a></li><li class="level-3" data-v-b57cc07c><a href="/docs/sec/crypto/auth/2fa-bank-ukey.html#éªŒç­¾å®ç°" class="sidebar-link reco-side-éªŒç­¾å®ç°" data-v-b57cc07c>éªŒç­¾å®ç°</a></li><li class="level-3" data-v-b57cc07c><a href="/docs/sec/crypto/auth/2fa-bank-ukey.html#å¤–éƒ¨-jar-å¼•å…¥æ‰“åŒ…" class="sidebar-link reco-side-å¤–éƒ¨-jar-å¼•å…¥æ‰“åŒ…" data-v-b57cc07c>å¤–éƒ¨ jar å¼•å…¥æ‰“åŒ…</a></li><li class="level-2" data-v-b57cc07c><a href="/docs/sec/crypto/auth/2fa-bank-ukey.html#åè®°" class="sidebar-link reco-side-åè®°" data-v-b57cc07c>åè®°</a></li></ul></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><div class="reco-bgm-panel" data-v-b1d3339e><audio id="bgm" src="/song/å¦–é£è¿‡æµ·.mp3" data-v-b1d3339e></audio> <div class="reco-float-box" style="bottom:44px;z-index:999999;display:none;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><img src="/img/error.jpg" data-v-b1d3339e></div> <div class="reco-bgm-box" style="left:10px;bottom:10px;z-index:999999;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="reco-bgm-cover" style="background-image:url(/img/error.jpg);" data-v-b1d3339e><div class="mini-operation" style="display:none;" data-v-b1d3339e><i class="reco-bgm reco-bgm-pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play" style="display:none;" data-v-b1d3339e></i></div> <div class="falut-message" style="display:none;" data-v-b1d3339e>
          æ’­æ”¾å¤±è´¥
        </div></div> <div class="reco-bgm-info" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-music music" data-v-b1d3339e></i>å¦–é£è¿‡æµ·</div> <div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-artist" data-v-b1d3339e></i>åˆ˜æ£®</div> <div class="reco-bgm-progress" data-v-b1d3339e><div class="progress-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div> <div class="reco-bgm-operation" data-v-b1d3339e><i class="reco-bgm reco-bgm-last last" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-pause pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play play" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-next next" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-volume1 volume" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-mute mute" style="display:none;" data-v-b1d3339e></i> <div class="volume-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div></div> <div class="reco-bgm-left-box" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><i class="reco-bgm reco-bgm-left" data-v-b1d3339e></i></div></div></div><!----><div class="RibbonAnimation"></div><div class="Sakura" data-v-248d85d6><canvas id="canvas_sakura" style="z-index:99;" data-v-248d85d6></canvas></div><div class="cat-container" data-v-a13867c0><canvas id="vuepress-cat" width="280" height="250" class="live2d" data-v-a13867c0></canvas></div><canvas id="vuepress-canvas-cursor"></canvas></div></div>
    <script src="/assets/js/app.0d79b349.js" defer></script><script src="/assets/js/10.1029e43e.js" defer></script><script src="/assets/js/1.13e9bcdf.js" defer></script><script src="/assets/js/169.2bbadbf1.js" defer></script>
  </body>
</html>
