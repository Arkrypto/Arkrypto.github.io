---
title: 皓的学前考察
date: 2024-3-6
---

## 算法考察

> [爬楼梯](https://leetcode.cn/problems/climbing-stairs/)：假设你正在爬楼梯。需要 n 阶你才能到达楼顶。每次你可以爬 1 或 2 个台阶。问多少种不同的方法可以爬到楼顶

显然，可以使用动态规划来解决问题，对于第 i 层阶梯，其登上的方式有两种，即

- 从`i-2`层登两步
- 从`i-1`层登一步

于是有状态转移方程
$$
dp[i]=
\begin{cases}
1&i=0\\\\
2&i=1\\\\
dp[i-1]+dp[i-2]&i\geq2
\end{cases}
$$
依此思路，可得

```c
class Solution {
public:
    int climbStairs(int n) {
        vector<int> dp;
        dp.push_back(1); dp.push_back(2);
        for(int i = 2; i < n; i++){
            dp.push_back(dp[i-1]+dp[i-2]);
        }
        return dp[n-1];
    }
};
```

<img src="./assets/image-20240307202659652.png">

## 论文笔记

> 阅读论文《Attention Is All You Need》或者《BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding》，做好论文阅读笔记并尽可能代码复现、解读代码逻辑

注意力机制（Attention Mechanism）是机器学习中的一种**数据处理方法**

- 严格来说，注意力机制更像是一种方法论。没有严格的数学定义，而是根据具体任务目标，**对关注的方向和加权模型进行调整**
- 简单的理解就是，在神经网络的隐藏层，增加注意力机制的加权，使不符合注意力模型的内容弱化或者遗忘

《Attention Is All You Need》中对注意力的抽象定义
$$
Attention(Q,K,V)=softmax(\frac{QK^T}{\sqrt{d_k}})V
$$
`An attention function can be described as mapping a query and a set of key-value pairs to an output, where the query, keys, values, and output are all vectors. The output is computed as a weighted sum of the values, where the weight assigned to each value is computed by a compatibility function of the query with the corresponding key.`

注意力是将一个查询（Q）和键值对（K,V）映射到输出的方法，Q、K、V 均为向量，输出通过对 V 进行加权求和得到，权重就是 Q、K 的相似度

- 其中`softmax`是激活函数

注意力机制的应用

1. 机器视觉中的应用（精细分类、图像分割、图像焦点）：例如，识别鸟类的品种问题。对于鸟品种的精细分类，对结果影响最大的可能是鸟类的头部，通过注意力机制将头部的特征强化，而忽略其他部分（羽毛、爪子），以实现区分鸟类的具体品种

2. 机器翻译中的应用（LSTM+注意力模型）：LSTM（Long Short Term Memory）是RNN（循环神经网络）的一种应用。可以简单理解为，每一个神经元都具有输入门、输出门、遗忘门

   其中输入门、输出门将 LSTM 神经元首尾连接，而遗忘门将无意义内容弱化或遗忘。注意力机制就应用在 LSTM 的遗忘门，使得机器阅读更加贴近于人类阅读的习惯，也使得翻译结果具有上下文联系

搜一下softmax，然后注意力的定义解释完整，d是什么，这个矩阵乘法的意义是什么

## 大模型概述

> 说一下当前较为流行的大模型，国内外各三种，且说出他们主要针对的领域（通用 or 专有，专有的话针对哪个垂直领域）

国内大模型

- **百度的ERNIE**：百度提出的基于知识增强的语言表示模型，主要用于自然语言处理领域，包括文本分类、情感分析、命名实体识别等
- **中文BERT（BERT-wwm）**：这是对Google的BERT模型进行了改进和优化，使其更适合中文语境，通常应用于通用自然语言处理任务，如问答系统、语义理解等
- **华为的MindSpore**：虽然不是一个单一的模型，但华为的MindSpore是一个用于构建和训练大规模深度学习模型的框架，可以支持各种领域的应用，包括自然语言处理、计算机视觉等

国外大模型

- **OpenAI的GPT（Generative Pre-trained Transformer）系列**：包括GPT-3等版本，主要应用于自然语言处理领域，如文本生成、对话系统、文本分类等，其强大的生成能力备受关注
- **Google的BERT（Bidirectional Encoder Representations from Transformers）**：作为一种预训练的语言表示模型，BERT在自然语言处理领域表现出色，广泛用于文本分类、语义理解、命名实体识别等任务
- **Facebook的RoBERTa**：RoBERTa是对BERT进行了改进的模型，通过更大规模的数据集和更长的预训练时间来提高性能，同样应用于自然语言处理领域的各种任务

这些大模型可以在各种领域发挥作用，包括但不限于通用自然语言处理、计算机视觉、推荐系统等。有些模型对特定领域更加适用，如 ERNIE 在中文语境下的表现更好，而 GPT 系列在文本生成任务上独领风骚

> 请说一下大模型训练、微调的手段有哪些

大型模型的训练和微调通常涉及到以下几种主要手段

- 预训练（Pre-training）：在大规模数据集上进行的初始训练，目的是使模型学习到丰富的语言表示。预训练通常采用无监督或半监督的方式，在文本数据上进行预测任务，如语言建模（预测下一个词）、掩码语言建模（预测掩码词）、预测下一个句子等
- **微调（Fine-tuning）**：将预训练好的模型在特定任务的有标签数据集上进行进一步的训练，以使其适应该任务的特定要求。微调可以是在整个模型上进行，也可以只在模型的一部分层次上进行
- **自适应学习率（Adaptive Learning Rate）**：由于大型模型参数数量庞大，学习率的设置尤为重要。自适应学习率算法可以根据参数的梯度情况动态调整学习率，以保证训练的稳定性和收敛性
- **正则化（Regularization）**：用于减少模型的过拟合风险。常见的正则化技术包括L1正则化和L2正则化，它们通过对模型参数进行惩罚来限制参数的大小
- **批量归一化（Batch Normalization）**：在深度神经网络中，批量归一化可以加速模型的收敛，减少训练时间，并且有助于模型的泛化性能
- **参数初始化（Parameter Initialization）**：好的参数初始化策略可以加速模型的收敛并提高模型的性能。常见的参数初始化方法包括随机初始化、Xavier初始化和He初始化等
- **数据增强（Data Augmentation）**：在微调阶段，通过对训练数据进行变换、旋转、剪裁等操作，可以增加数据的多样性，提高模型的泛化能力
- **迁移学习（Transfer Learning）**：利用预训练好的模型在特定领域进行微调，可以加速模型的收敛并提高模型的性能，尤其是在数据量有限的情况下

这些手段可以单独或组合使用，并且根据具体任务和数据情况来选择合适的训练和微调策略

> 如果有优化和部署经验，请进一步解说其中的技术点

在本地不同笔记本电脑上（Windows11 / Manjaro / ArchLinux）部署过清华的开源语言大模型 ChatGLM-6B 并分别以 32G/16G CPU 和 6G GPU 成功运行

- Github：[THUDM/ChatGLM-6B: 开源双语对话语言模型](https://github.com/THUDM/ChatGLM-6B)
- Hugging Face：[THUDM/chatglm-6b · Hugging Face](https://huggingface.co/THUDM/chatglm-6b)

采用 Web 可视化操作微调过相关参数，但对于其中优化细节及相关技术点并不十分了解，以下为搜索得到

- **模型压缩和量化（Model Compression and Quantization）**：针对大型模型的参数数量庞大和计算需求高的问题，可以采用模型压缩和量化技术来减少模型的大小和计算量。例如，剪枝（Pruning）可以去除模型中冗余的连接和参数，量化（Quantization）可以将模型参数从浮点数转换为较低位数的整数，从而减少存储和计算量
- **硬件加速器的使用（Hardware Acceleration）**：利用专门的硬件加速器（如GPU、TPU等）来加速大型模型的推理和训练过程。这些硬件加速器通常能够提供比通用处理器更高的计算性能和能效比，从而加速模型的运行
- **模型量化和量化训练（Quantization-aware Training）**：在训练过程中考虑到模型量化后的精度损失，采用量化感知的训练方法，从而在量化后保持模型的性能
- **分布式训练（Distributed Training）**：利用多个计算节点或者多个设备进行模型训练，加速训练过程并处理大规模数据。分布式训练需要设计合适的通信和同步机制，以确保模型参数的一致性
- **模型蒸馏（Model Distillation）**：利用较小、高效的模型来“蒸馏”（distill）大型模型的知识，从而在保留性能的情况下减少模型的大小和计算需求
- **缓存优化和预取优化（Cache and Prefetch Optimization）**：利用硬件缓存和预取机制来优化模型的内存访问模式，减少内存访问延迟，提高模型的运行效率
- **模型并行和数据并行（Model Parallelism and Data Parallelism）**：将模型参数或训练数据分布到多个设备或计算节点上，并行地进行模型计算和训练，以提高训练速度和计算效率
- **模型部署的优化（Deployment Optimization）**：将训练好的模型部署到生产环境中时，需要考虑到模型的性能、延迟、吞吐量等方面的要求，并对模型进行相应的优化，以满足实际应用的需求

这些技术点通常会结合使用，以优化和部署大型模型，在保持模型性能的同时，提高模型的效率和可用性

> 请说一下目前大模型急待解决的缺陷在哪里

目前大型模型仍存在一些急待解决的缺陷，主要包括

- **能源消耗和计算资源需求高**：大型模型需要庞大的计算资源和能源来进行训练和推理，这给环境造成了负担，也限制了大型模型的广泛应用
- **模型的可解释性差**：大型模型通常具有数以亿计的参数，其内部机理复杂，导致模型的预测结果难以解释，这在一些应用场景下不利于模型的应用和部署
- **数据隐私和安全性问题**：大型模型通常需要大量的数据进行训练，在数据隐私和安全性方面存在一定的风险，例如模型可能会记住训练数据中的敏感信息
- **样本偏差和数据分布偏移**：大型模型在训练过程中往往对数据分布敏感，当面临新领域或新任务时，可能会出现样本偏差和数据分布偏移的问题，导致模型性能下降
- **社会和伦理问题**：大型模型的应用可能会引发社会和伦理方面的问题，例如模型生成的内容可能包含有害信息、歧视性言论等，需要制定相应的政策和规范来管理模型的应用
- **通用性和泛化能力有限**：虽然大型模型在许多任务上表现出色，但其泛化能力仍有待改进，特别是在面对不同领域、不同语种或低资源语种的情况下

解决这些缺陷需要跨学科的合作，包括算法研究、硬件优化、数据管理、隐私保护等方面的工作。同时，也需要制定相关政策和规范，确保大型模型的应用能够符合社会和伦理的要求
