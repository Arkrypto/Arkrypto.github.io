---
title: 端到端轻量安全认证
date: 2024-12-10 00:00:00
tags: 
  - LightweightEncryption
permalink: /pages/f5cde7/
author: 
  name: northboat
  link: https://github.com/northboat
---

## 端到端认证

### TLS/SSL

| 协议    | 特性                                                         | 缺点                                                         |
| ------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| SSL 1.0 | 仅供内部测试，未发布                                         | 严重安全问题                                                 |
| SSL 2.0 | 提供了基础的加密通信功能；使用对称加密（如 DES）、公钥加密（如 RSA）和消息摘要算法（如 MD5） | 无法验证完整性，容易受到“中间人攻击”和“重放攻击”；明文警报：握手中的部分信息未加密，暴露给攻击者；不支持会话恢复 |
| SSL 3.0 | 提高了加密强度，支持更强大的加密算法（如 3DES）；引入了消息认证码（MAC）以确保数据完整性；支持会话恢复，减少通信开销 | 仍然基于较弱的算法，如 MD5 和 SHA-1，这些算法后来被证明存在缺陷；握手阶段的部分内容仍然暴露，存在一定的安全隐患 |
| TLS 1.0 | 引入了密钥派生函数：使用更安全的密钥派生机制来生成会话密钥；基于 HMAC 进行消息认证 | 不支持 AEAD 算法，存在潜在的安全风险；难以抵御 CBC（Cipher Block Chaining）模式的攻击 |
| TLS 1.1 | 防止 CBC padding oracle 攻击；加强了密钥管理和消息验证：改进了密钥派生函数和消息认证机制，使得加密过程更加稳健 | 仍然无法完全防止一些高级攻击（例如，BEAST 攻击）；部署并不广泛，大部分直接跳过 1.1 采用 1.2 |
| TLS 1.2 | TLS 1.2 引入了对更强大的加密算法的支持，例如 AES 和 SHA-256；TLS 1.2 引入了更强大的签名和认证机制，尤其是在客户端和服务器之间进行身份验证时；支持 AEAD 模式 | downgrade 攻击和某些不当配置                                 |
| TLS 1.3 | TLS 1.3 将握手过程从传统的 2 次往返减少为 1 次往返（1-RTT），提高了连接建立的效率；TLS 1.3 移除了许多不再安全的加密算法，如 RC4、MD5、DES、3DES 和 SHA-1。它只支持更现代、更安全的加密套件，如 AES-GCM 和 ChaCha20-Poly1305；TLS 1.3 引入了 0-RTT 数据传输，在连接重用时，可以提前开始发送数据，但这也带来了潜在的重放攻击风险 | 由于 0-RTT 数据传输允许提前发送数据，这可能导致重放攻击的风险 |

TLS 的安全性来自于其加密和认证机制，最常用和广泛支持的版本为 08 年发布的 TLS 1.2

### 2PC

Two-Party Computation（2PC）：是指两个参与方共同计算某个函数或问题的结果，而不暴露各自的私有输入信息。它是**安全多方计算**（Secure Multi-Party Computation，SMPC）中的一种特殊情况，其中涉及的计算只有两个参与方

目标

- **隐私保护**：确保每一方的私有数据在计算过程中不会泄露给另一方
- **正确性**：计算结果必须符合预期，两方都能得到相同的结果
- **安全性**：即使一方存在恶意行为，系统仍应保证安全性，即结果不会受到篡改，也不会泄漏多余的信息

核心特性

- **私有性**：每一方只知道计算的结果，而不泄露自己的输入
- **无信任**：即使双方不完全信任对方，仍然可以在计算过程中保护各自的隐私
- **计算正确性**：两方需要确保计算过程中没有篡改或错误，保证最终的输出结果是正确的

为什么提到 2PC，因为 TLS 协议自身的特点，如果在认证过程中出现第三方，比如 C 向 V 请求服务，而 V 的服务需要从中心服务器 S 中获取，显然 V-S 之间需要安全认证，这可以通过 TLS 实现，但 C-S 的安全性将很难保障，只能通过额外多余的双方计算（在 C 和 V 之间）实现安全认证，这会带来很大的计算开销

### Garble-Then-Prove

> Lightweight Authentication of Web Data via Garble-Then-Prove

### VPN

> 虚拟私有网络，通过端到端加密构建安全隧道

## 加密体系

### 对称体系

参考对称轻量级密码算法，如 PRESENT、SPARX 等的设计思路，基于格上的 LPN 问题（LWE 问题的特殊情况）也常用于对称加密场景

### 数字签名

> 后量子数字签名
>

#### 基于格

基于格的问题，如

- 学习错误问题 LWE（Falcon）
- 短整数解问题 SIS（Dilithium）
- 最短向量问题 SVP（NTRU）

被认为对量子计算机具有抗性，因此成为抗量子密码学的热门研究方向

Kyber

1. Kyber 是一个广泛使用的基于 **LWE** 的加密方案，也提供了一种基于 **LWE** 的签名方案（通常与加密协议一同使用）
2. Kyber 签名方案基于基于LWE问题的密钥交换和公钥加密系统
3. 该签名方案适用于公钥加密系统中，并具有较好的效率和紧凑性

Falcon：一种基于 NTRU 格和 LWE 问题的高效抗量子签名方案，其核心思想是

1. 使用格上的短向量作为签名，确保签名的长度较短
2. 引入拒绝采样技术，保证签名的随机性和抗攻击性

[CRYSTALS-Dilithium: A Lattice-Based Digital Signature Scheme | IACR Transactions on Cryptographic Hardware and Embedded Systems](https://tches.iacr.org/index.php/TCHES/article/view/839)

1. 基于模块化的 SIS 问题
2. 是 NIST 抗量子密码学标准化项目中的候选算法（现已入选）
3. 特点：签名大小较小，验证速度快，适合通用签名场景
4. 参考场景：抗量子环境下的区块链和身份认证

BLISS（Bimodal Lattice Signature Scheme）

1. 基于格上的离散高斯采样，采用 LWE 的设计思想
2. 优点：签名小，计算速度快，密钥生成相对高效。
3. 缺点：在侧信道攻击下可能存在风险

#### 基于哈希

哈希函数的安全性已经过几十年的广泛研究，基于哈希的签名算法在理论上简单且抗量子攻击

SPHINCS+

- 是 NIST 抗量子密码学标准化项目中的另一候选算法
- 特点：无状态签名，完全基于哈希函数，无需额外的数学假设
- 缺点：签名长度较长，但安全性非常高
- 应用场景：适合需要强安全性保证的系统，如军事和政府通信

Merkle 签名方案

- 使用 Merkle 树作为核心数据结构，支持大批量签名
- 优点：简单、直接
- 缺点：签名效率不高，需要维护状态（改进版如 SPHINCS+ 解决了这一问题）

#### 其他

| 算法    | 数学理论         | 特点                                                         |
| ------- | ---------------- | ------------------------------------------------------------ |
| Rainbow | 基于多变量多项式 | 使用多层多变量多项式系统设计；优点：签名小，验证速度快；缺点：密钥较大，在某些应用中存储成本高；应用：轻量级设备或需要快速签名的场景 |
| Wave    | 基于纠错码       | 基于纠错码和稀疏多项式；优点：签名小，验证速度快；缺点：目前仍处于研究阶段，实际应用较少 |
| SeaSign | 基于等距映射     | 基于超奇异椭圆曲线的等距映射问题；特点：密钥和签名大小非常小，特别适合低带宽环境；缺点：签名生成速度较慢，仍在优化中 |
| Picnic  | 基于组合理论     | 利用组合数学问题的难度构造，基于零知识证明和哈希函数；特点：无需复杂的数学假设，签名大小中等；缺点：验证速度可能较慢；应用：嵌入式设备或资源受限的环境 |
