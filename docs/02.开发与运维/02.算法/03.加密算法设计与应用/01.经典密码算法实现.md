---
title: 经典密码算法实现
date: 2025-4-1
permalink: /pages/07937a/
author: 
  name: northboat
  link: https://github.com/northboat
---

非对称加密体系

- RSA 体系：基于大数分解的非对称加密体系
- ElGamal 体系：基于离散对数问题的非对称加密体系
- Rabin 体系：基于平方剩余难题的公钥加密体系（特征为多解）
- ECC 体系：通过椭圆曲线构造的公钥加密体系

注意**体系并不等于算法**，不同算法可以应用于不同体系，比如 ElGamal 算法可以在 ElGamal 体系中实现，也可以在 ECC 中实现

- 令人费解的点可能在于，ElGamal 算法并不等于 ElGamal 体系，同样 RSA 算法也并不等于 RSA 体系，他们只是一个名字罢了，在日常交流中很容易混淆

密钥交换协议：Diffie-Hellman（D-H），用于安全协商密钥，是一种协议，其实现类似于算法，可以在多个密码体系中实现

门限密码：Shamir 门限方案，用于将秘密拆分成多个部分，满足门限才能恢复

用表来看或许清晰一点，不同的算法有其适用的密码体系，在“适用”的前提下，可以在不同密码体系中具体实现（或是变体）

| **算法**        | **主要数学难题**                  | **典型适用体系**  |
| --------------- | --------------------------------- | ----------------- |
| **RSA**         | 大数分解（Factoring）             | RSA 体系          |
| **Rabin**       | 二次剩余（Quadratic Residue）     | Rabin 体系        |
| **ElGamal**     | 离散对数（DLP）                   | 传统 ElGamal、ECC |
| **D-H**         | 离散对数（DLP）                   | 经典 D-H、ECDH    |
| **Shamir 门限** | 多项式插值（Lagrange Polynomial） | 门限密码学        |

例如

- **RSA 和 Rabin** 是基于大数分解问题的，属于**数论体系**（通常不和 ECC 结合）
- **ElGamal 和 D-H** 是基于离散对数问题的，它们既可以在**整数域（模素数）**也可以在**椭圆曲线（ECC）**上实现

想弄清楚密码这套东西一定要区分好体系和算法

## RSA 算法

基于大数分解问题，在整数域上实现

## Elgamal 算法

基于离散对数问题，它可以在不同的数学结构上实现

1. 经典 ElGamal（整数模运算）
   - 适用于**传统 DLP（模素数）**
   - 公式
     - 公钥：$g, p, y = g^x \mod p$
     - 加密：$c_1 = g^k \mod p，c_2 = m \cdot y^k \mod p$
2. ECC-ElGamal（椭圆曲线加密）
   - 适用于**ECC（椭圆曲线上的 DLP）**
   - 公式类似，但数学运算从整数域变成椭圆曲线上的点运算
     - 公钥：$P, Q = xP$
     - 加密：$C_1 = kP, C_2 = M + kQ$

### 整数域实现

### ECC 实现

## Rabin 加密

## Shamir 秘密共享方案

## D-H 密钥交换协议

基于离散对数问题

### 整数域实现

### ECC 实现
