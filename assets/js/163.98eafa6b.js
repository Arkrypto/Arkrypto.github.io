(window.webpackJsonp=window.webpackJsonp||[]).push([[163],{1491:function(e,s,a){"use strict";a.r(s);var r=a(3),n=Object(r.a)({},(function(){var e=this,s=e._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h2",{attrs:{id:"æ¦‚è¿°"}},[e._v("æ¦‚è¿°")]),e._v(" "),s("h3",{attrs:{id:"why-happened"}},[e._v("Why Happened")]),e._v(" "),s("blockquote",[s("p",[e._v("å¼€å‘å³è¿ç»´")])]),e._v(" "),s("p",[e._v("å‘å¸ƒä¸€ä¸ªé¡¹ç›® ( jar + (Redis MySQL jdk ES) )éœ€è¦é¡¹ç›®å’Œç¯å¢ƒæ‰“åŒ…å‘å¸ƒ")]),e._v(" "),s("ul",[s("li",[e._v("ç¯å¢ƒé…ç½®æ˜¯ååˆ†éº»çƒ¦çš„ï¼Œæ¯ä¸€ä¸ªæœºå™¨éƒ½è¦éƒ¨ç½²ç¯å¢ƒï¼Œè´¹æ—¶è´¹åŠ›")])]),e._v(" "),s("p",[e._v("ä¼ ç»Ÿï¼šå¼€å‘jarï¼Œè¿ç»´æ¥åš")]),e._v(" "),s("p",[e._v("ç°åœ¨ï¼šå¼€å‘æ‰“åŒ…éƒ¨ç½²ä¸Šçº¿ï¼Œä¸€å¥—æµç¨‹åšå®Œ")]),e._v(" "),s("p",[e._v("Dockerç»™ä»¥ä¸Šçš„é—®é¢˜ï¼Œæå‡ºäº†è§£å†³æ–¹æ¡ˆ")]),e._v(" "),s("ul",[s("li",[e._v("Dockerçš„æ€æƒ³æ¥è‡ªäºé›†è£…ç®±")])]),e._v(" "),s("p",[e._v("dockeræ ¸å¿ƒæ€æƒ³ï¼š"),s("strong",[e._v("éš”ç¦»")])]),e._v(" "),s("ul",[s("li",[e._v("Docker é€šè¿‡éš”ç¦»æœºåˆ¶ï¼Œå¯ä»¥å°†æœåŠ¡å™¨åˆ©ç”¨åˆ°æè‡´")])]),e._v(" "),s("p",[e._v("æœ¬è´¨ï¼šæ‰€æœ‰çš„æŠ€æœ¯éƒ½æ˜¯å› ä¸ºå‡ºç°äº†ä¸€äº›é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦å»è§£å†³ï¼Œæ‰å»å­¦ä¹ ")]),e._v(" "),s("h3",{attrs:{id:"history"}},[e._v("History")]),e._v(" "),s("p",[e._v("2010å¹´ï¼Œå‡ ä¸ªæitçš„å¹´è½»äººï¼Œå°±åœ¨ç¾å›½æˆç«‹äº†ä¸€å®¶å…¬å¸ "),s("strong",[e._v("dotCloud")]),e._v(" åšä¸€äº› pass çš„äº‘è®¡ç®—æœåŠ¡ã€‚Linuxæœ‰å…³çš„å®¹å™¨æŠ€æœ¯ã€‚")]),e._v(" "),s("p",[e._v("ä»–ä»¬å°†è‡ªå·±çš„æŠ€æœ¯ï¼ˆå®¹å™¨åŒ–æŠ€æœ¯ï¼‰å‘½åå°±æ˜¯Dockerã€‚")]),e._v(" "),s("p",[e._v("Dockeråˆšåˆšè¯ç”Ÿçš„æ—¶å€™ï¼Œæ²¡æœ‰å¼•èµ·è¡Œä¸šæ³¨æ„ã€‚")]),e._v(" "),s("p",[e._v("dotCloudï¼Œè¦æ°é¥­ ------\x3e "),s("strong",[e._v("å¼€æº")])]),e._v(" "),s("p",[e._v("å¼€å‘æºä»£ç ")]),e._v(" "),s("ul",[s("li",[e._v("2013å¹´ï¼Œå°†Dockerå¼€æº")])]),e._v(" "),s("p",[e._v("è¶Šæ¥è¶Šå¤šçš„äººå‘ç°äº†Dockerçš„ä¼˜ç‚¹ï¼ç«äº†ï¼Œå‡ ä¹æ¯ä¸ªæœˆéƒ½ä¼šæ›´æ–°ä¸€ä¸ªç‰ˆæœ¬")]),e._v(" "),s("p",[e._v("2014å¹´4æœˆ9æ—¥ï¼ŒDocker1.0å‘å¸ƒ")]),e._v(" "),s("p",[e._v("å…¥é—¨ ------\x3e ç²¾é€š")]),e._v(" "),s("p",[e._v("Dockerä¸ºä»€ä¹ˆè¿™ä¹ˆç«ï¼Ÿååˆ†çš„è½»å·§ï¼")]),e._v(" "),s("p",[e._v("åœ¨å®¹å™¨æŠ€æœ¯å‡ºæ¥ä¹‹å‰ï¼Œæˆ‘ä»¬éƒ½æ˜¯ä½¿ç”¨è™šæ‹ŸæœºæŠ€æœ¯")]),e._v(" "),s("p",[e._v("è™šæ‹Ÿæœºï¼šåœ¨windowä¸­è£…ä¸€ä¸ªVmwareï¼Œé€šè¿‡è½¯ä»¶è™šæ‹Ÿå‡ºæ¥ä¸€å°æˆ–å¤šå°è®¡ç®—æœºï¼Œç¬¨é‡")]),e._v(" "),s("p",[e._v("Dockerå®¹å™¨æŠ€æœ¯ï¼ŒåŒæ ·æ˜¯ä¸€ç§è™šæ‹ŸæœºæŠ€æœ¯")]),e._v(" "),s("p",[e._v("å»æ‰äº†è™šæ‹Ÿç¡¬ä»¶å±‚ï¼šHypeviscr & Guest OSâ€”â€”>Docker Engine")]),e._v(" "),s("p",[e._v("è™šæ‹Ÿæœºé¢å‘ç¡¬ä»¶ï¼ŒDockeré¢å‘è½¯ä»¶")]),e._v(" "),s("h3",{attrs:{id:"system"}},[e._v("System")]),e._v(" "),s("p",[e._v("Client-Serverï¼ˆCSï¼‰ç»“æ„")]),e._v(" "),s("p",[e._v("è¿è¡Œä¸»æœºï¼ˆServerï¼‰ä¸­è¿è¡Œç€ä¸€ä¸ªä¸ªå®¹å™¨ï¼ˆé›†è£…ç®±ï¼‰ä»¥åŠåå°å®ˆæŠ¤è¿›ç¨‹ï¼ˆDaemonï¼‰ï¼Œä¿å­˜ç€é•œåƒï¼Œå®¢æˆ·æœºï¼ˆClientï¼‰é€šè¿‡ä¸‹è¾¾å‘½ä»¤ï¼ˆAPIï¼‰ï¼Œè¿æ¥åå°å®ˆæŠ¤è¿›ç¨‹ï¼ˆDaemonï¼‰ï¼Œå¯¹å®¹å™¨è¿›è¡Œæ“ä½œ")]),e._v(" "),s("p",[e._v("å®¹å™¨ç›¸å½“äºä¸€ä¸ªç®€æ˜“ç‰ˆçš„Linuxç³»ç»Ÿï¼ˆé›†è£…ç®±ï¼‰ï¼Œè¿è¡Œåœ¨å®¿ä¸»æœºä¸Šï¼ˆé²¸èƒŒï¼‰ï¼Œå·¨å¤§çš„ä»“åº“åƒæ˜¯å¤§æµ·ä¸€èˆ¬æ”¯æ’‘ç€é²¸é±¼")]),e._v(" "),s("p",[e._v("dockeré•œåƒï¼š")]),e._v(" "),s("p",[e._v("è”åˆæ–‡ä»¶ç³»ç»Ÿï¼ˆUnionFSï¼‰ï¼šä¸€å±‚ä¸€å±‚å åŠ ï¼Œæ‹¢å’Œæˆä¸€ä¸ªæ–‡ä»¶ï¼Œå³é•œåƒ")]),e._v(" "),s("p",[e._v("bootfsï¼ˆboot file systemï¼‰& rootfsï¼ˆroot file systemï¼‰")]),e._v(" "),s("p",[e._v("kernelï¼ˆå†…æ ¸ï¼‰ï¼šå®¿ä¸»æœºå†…æ ¸")]),e._v(" "),s("p",[e._v("å®¹å™¨å±‚ â€”â€”> é•œåƒ")]),e._v(" "),s("p",[e._v("åˆ†å±‚ â€”â€”> å…±äº«èµ„æº")]),e._v(" "),s("h2",{attrs:{id:"æ­å»º"}},[e._v("æ­å»º")]),e._v(" "),s("p",[e._v("åœ¨CentOS 7ä¸Šé…ç½®Docker")]),e._v(" "),s("p",[e._v("1ã€å®‰è£…ä¹‹å‰ç°å¸è½½ç³»ç»Ÿä¸ŠåŸæœ‰çš„Docker")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("yum remove docker docker-client  docker-client-latest docker-common docker-latest docker-latest-logrotate docker-logrotate docker-engine\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("2ã€å®‰è£…éœ€è¦çš„å®‰è£…åŒ…yum-utils")]),e._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('[root@instance-h9cwbr8m ~]# yum install -y yum-utils\n\nLoaded plugins: langpacks, versionlock\nExcluding 1 update due to versionlock (use "yum versionlock status" to show it)\nPackage yum-utils-1.1.31-54.el7_8.noarch already installed and latest version\nNothing to do\n[root@instance-h9cwbr8m ~]# \n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br")])]),s("p",[e._v("æ­¤ä¸»æœºå·²å®‰è£…æœ€æ–°çš„yum-utils")]),e._v(" "),s("p",[e._v("3ã€è®¾ç½®é•œåƒä»“åº“åœ°å€")]),e._v(" "),s("p",[e._v("æ·»åŠ dockeré»˜è®¤çš„å®˜æ–¹ä»“åº“åœ°å€")]),e._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("yum-config-manager \\\n    --add-repo \\\n    https://download.docker.com/linux/centos/docker-ce.repo \n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br")])]),s("p",[e._v("æ­¤åœ°å€ä¸ºå®˜æ–¹çš„ä»“åº“åœ°å€ï¼Œåœ¨å›½å†…å»ºè®®ä¸è¦ç”¨")]),e._v(" "),s("p",[e._v("é˜¿é‡Œäº‘çš„é•œåƒä»“åº“åœ°å€")]),e._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("yum-config-manager \\\n  --add-repo \\\n   http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br")])]),s("p",[e._v("4ã€å®‰è£…dockerç›¸å…³çš„å¼•æ“")]),e._v(" "),s("p",[e._v("å…ˆæ›´æ–°yumè½¯ä»¶åŒ…ç´¢å¼•")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[e._v("yum makecache fase \n")])])]),s("ul",[s("li",[e._v("dockerç¤¾åŒºç‰ˆã€ä¼ä¸šç‰ˆã€‚"),s("code",[e._v("ce")]),e._v("ä¸ºç¤¾åŒºç‰ˆï¼Œ"),s("code",[e._v("ee")]),e._v("ä¸ºä¼ä¸šç‰ˆã€‚å®˜æ–¹æ¨èä½¿ç”¨"),s("code",[e._v("ce")]),e._v("ç‰ˆï¼Œé»˜è®¤å®‰è£…æœ€æ–°çš„dockerç‰ˆæœ¬ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šç‰ˆæœ¬å®‰è£…")])]),e._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("yum install docker-ce docker-ce-cli containerd.io\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("5ã€å¯åŠ¨docker")]),e._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("systemctl start docker\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("6ã€ä½¿ç”¨docker version æŸ¥çœ‹dockersæ˜¯å¦å¯åŠ¨")]),e._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("docker version\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/qq_26400011/article/details/113856681")]),e._v(" "),s("p",[e._v("7ã€è®¾ç½®é˜¿é‡Œäº‘é•œåƒåŠ é€Ÿ")]),e._v(" "),s("p",[e._v("åœ¨é˜¿é‡Œäº‘å®˜ç½‘è·å¾—åŠ é€Ÿåœ°å€ï¼š"),s("a",{attrs:{href:"https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors",target:"_blank",rel:"noopener noreferrer"}},[e._v("å®¹å™¨é•œåƒæœåŠ¡ (aliyun.com)"),s("OutboundLink")],1)]),e._v(" "),s("p",[e._v("é…ç½®/etc/docker/daemon.jsonæ–‡ä»¶")]),e._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('sudo mkdir -p /etc/docker\nsudo tee /etc/docker/daemon.json <<-\'EOF\'\n{\n  "registry-mirrors": ["https://wvbyitta.mirror.aliyuncs.com"]\n}\nEOF\nsudo systemctl daemon-reload\nsudo systemctl restart docker\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br")])]),s("p",[e._v("8ã€æ‹‰å–"),s("code",[e._v("hello-world")]),e._v("é•œåƒè¿›è¡Œæµ‹è¯•")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("sudo docker pull hello-world\nsudo docker run hello-world\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("h2",{attrs:{id:"ç®€å•å‘½ä»¤"}},[e._v("ç®€å•å‘½ä»¤")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("service docker restartï¼šé‡å¯dockeræœåŠ¡")])]),e._v(" "),s("li",[s("p",[e._v("docker run + é•œåƒåmï¼šç”¨é•œåƒmç”Ÿæˆå®¹å™¨")])]),e._v(" "),s("li",[s("p",[e._v("docker run -itï¼šäº¤äº’å¼è¿è¡Œ")])]),e._v(" "),s("li",[s("p",[e._v("docker run -p 8000:8080ï¼šè®¾ç½®å¯¹å¤–å¼€æ”¾ç«¯å£å’Œéƒ¨ç½²ç«¯å£")])]),e._v(" "),s("li",[s("p",[e._v("docker run -Pï¼šéšæœºåˆ†é…ç«¯å£")])]),e._v(" "),s("li",[s("p",[e._v("docker run -dï¼šåå°è¿è¡Œ")])]),e._v(" "),s("li",[s("p",[e._v("docker run --nameï¼šç»™å®¹å™¨å‘½å")])]),e._v(" "),s("li",[s("p",[e._v("exitï¼šé€€å‡ºå®¹å™¨")])]),e._v(" "),s("li",[s("p",[e._v("ctrl+q+pï¼šå°†å®¹å™¨æŒ‚èµ·")])]),e._v(" "),s("li",[s("p",[e._v("docker startï¼šå¼€å¯å®¹å™¨")])]),e._v(" "),s("li",[s("p",[e._v("docker restartï¼šé‡å¯å®¹å™¨")])]),e._v(" "),s("li",[s("p",[e._v("docker stopï¼šåœæ­¢å®¹å™¨")])]),e._v(" "),s("li",[s("p",[e._v("docker killï¼šå¼ºåˆ¶åœæ­¢å®¹å™¨")])]),e._v(" "),s("li",[s("p",[e._v("docker exec -it å®¹å™¨id /bin/bash äº¤äº’å¼è¿è¡Œå®¹å™¨")])])]),e._v(" "),s("h3",{attrs:{id:"æŸ¥è¯¢"}},[e._v("æŸ¥è¯¢")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("docker versionï¼šæŸ¥çœ‹dockerç‰ˆæœ¬")])]),e._v(" "),s("li",[s("p",[e._v("docker infoï¼šæŸ¥çœ‹dockerä¿¡æ¯")])]),e._v(" "),s("li",[s("p",[e._v("docker --helpï¼šæŸ¥è¯¢å‘½ä»¤")])]),e._v(" "),s("li",[s("p",[e._v("docker psï¼šæ­£åœ¨è¿è¡Œçš„å®¹å™¨")])]),e._v(" "),s("li",[s("p",[e._v("docker ps -lï¼šæœ€è¿‘è¿è¡Œçš„å®¹å™¨ä¿¡æ¯")])]),e._v(" "),s("li",[s("p",[e._v("docker ps -aï¼šæ‰€æœ‰è¿è¡Œè¿‡çš„å®¹å™¨ä¿¡æ¯")])]),e._v(" "),s("li",[s("p",[e._v("docker ps -qï¼šæ­£åœ¨è¿è¡Œçš„å®¹å™¨ID")])]),e._v(" "),s("li",[s("p",[e._v("docker imagesï¼šæŸ¥çœ‹é•œåƒï¼ˆ-l -a -q ä¸5ã€6ã€7åŒç†ï¼‰")])]),e._v(" "),s("li",[s("p",[e._v("docker searchï¼šåœ¨è¿œç«¯æŸ¥è¯¢é•œåƒ")])]),e._v(" "),s("li",[s("p",[e._v("docker inspectï¼šæŸ¥çœ‹å®¹å™¨å…·ä½“ä¿¡æ¯")])]),e._v(" "),s("li",[s("p",[e._v("docker topï¼šæŸ¥çœ‹å®¹å™¨å†…è¿è¡Œè¿›ç¨‹")])])]),e._v(" "),s("h3",{attrs:{id:"åˆ é™¤"}},[e._v("åˆ é™¤")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("docker rmï¼šåˆ é™¤å®¹å™¨")])]),e._v(" "),s("li",[s("p",[e._v("docker rm -fï¼šå¼ºåˆ¶åˆ é™¤å®¹å™¨")])]),e._v(" "),s("li",[s("p",[e._v("docker rm -f $ (docker ps -qa)ï¼šåˆ é™¤æ‰€æœ‰å®¹å™¨")])]),e._v(" "),s("li",[s("p",[e._v("docker rmiï¼šåˆ é™¤é•œåƒ")])]),e._v(" "),s("li",[s("p",[e._v("docker rmi -fï¼šå¼ºåˆ¶åˆ é™¤é•œåƒ")])]),e._v(" "),s("li",[s("p",[e._v("docker rmi -f $ (docker images -qa)")])])]),e._v(" "),s("h3",{attrs:{id:"æ„å»ºå¹¶ä½¿ç”¨"}},[e._v("æ„å»ºå¹¶ä½¿ç”¨")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("docker pullï¼šä»è¿œç«¯è·å–é•œåƒ")])]),e._v(" "),s("li",[s("p",[e._v('docker commit -m="é•œåƒå"   -a="ä½œè€…å "ï¼šç”¨å®¹å™¨ç”Ÿæˆé•œåƒ')])]),e._v(" "),s("li",[s("p",[e._v("docker build -f   /.../.../DockerFile (dockerfileè·¯å¾„) -t+é•œåƒåï¼šç”¨dockerfileç”Ÿæˆé•œåƒ")])]),e._v(" "),s("li",[s("p",[e._v("docker run -it -v  /.../.../... (ä¸»æœºç›®å½•) ğŸ˜•...(å®¹å™¨ç›®å½•)  + å®¹å™¨cï¼šåœ¨ä¸»æœºå’Œå®¹å™¨cä¹‹é—´ç”Ÿæˆæ•°æ®å…±äº«å·")])]),e._v(" "),s("li",[s("p",[e._v("docker run it  --volumes-from+å®¹å™¨å/ID  -name+å®¹å™¨å  é•œåƒåmï¼šç”¨mç”Ÿæˆå®¹å™¨ï¼Œç”¨å®¹å™¨è”é€šå®¹å™¨")])])]),e._v(" "),s("h2",{attrs:{id:"ssl-è¯ä¹¦è¿æ¥"}},[e._v("SSL è¯ä¹¦è¿æ¥")]),e._v(" "),s("blockquote",[s("p",[e._v("åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/oceanyang520/article/details/101563309")])]),e._v(" "),s("p",[e._v("1ã€æ–°å»ºä¸€ä¸ªç›®å½•certsï¼Œåœ¨ç›®å½•æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œè¾“å…¥ä¸¤æ¬¡å¯†ç ï¼Œéœ€è¦è®°ä½åé¢ä¼šç”¨åˆ°")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("openssl genrsa -aes256 -out ca-key.pem 4096 \n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("2ã€æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œè¾“å…¥å¯†ç ï¼Œç„¶åä¾æ¬¡è¾“å…¥å›½å®¶æ˜¯ CNï¼Œçœä¾‹å¦‚æ˜¯Shanghaiã€å¸‚Shanghaiã€ç»„ç»‡åç§°ã€ç»„ç»‡å•ä½ã€å§“åæˆ–æœåŠ¡å™¨åã€é‚®ä»¶åœ°å€ï¼Œéƒ½å¯ä»¥éšæ„å¡«å†™")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("openssl req -new -x509 -days 365 -key ca-key.pem -sha256 -out ca.pem\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("3ã€æ‰§è¡Œç”ŸæˆæœåŠ¡å™¨ç«¯keyè¯ä¹¦æ–‡ä»¶")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("openssl genrsa -out server-key.pem 4096\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("4ã€ipéœ€è¦æ¢æˆè‡ªå·±æœåŠ¡å™¨çš„å¤–ç½‘ipåœ°å€ï¼Œæˆ–è€…åŸŸåéƒ½å¯ä»¥")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('openssl req -subj "/CN=å…¬ç½‘ip" -sha256 -new -key server-key.pem -out server.csr\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("5ã€é…ç½®ç™½åå•ï¼Œå¤šä¸ªç”¨é€—å·éš”å¼€ï¼Œä¾‹å¦‚ï¼š "),s("code",[e._v("IP:192.168.1.111,IP:0.0.0.0")]),e._v("ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„ï¼Œè™½ç„¶"),s("code",[e._v("0.0.0.0")]),e._v("å¯ä»¥åŒ¹é…ä»»æ„ï¼Œä½†æ˜¯ä»ç„¶éœ€è¦é…ç½®ä½ çš„æœåŠ¡å™¨å¤–ç½‘ipï¼Œå¦‚æœçœç•¥ä¼šé€ æˆé”™è¯¯ï¼Œåé¢ä¼šè®²åˆ°")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("echo subjectAltName = IP:**å…¬ç½‘ip**,IP:0.0.0.0 >> extfile.cnf\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("6ã€æŠŠ extendedKeyUsage = serverAuth é”®å€¼è®¾ç½®åˆ°extfile.cnfæ–‡ä»¶é‡Œï¼Œé™åˆ¶æ‰©å±•åªèƒ½ç”¨åœ¨æœåŠ¡å™¨è®¤è¯")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("echo extendedKeyUsage = serverAuth >> extfile.cnf\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("7ã€æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œè¾“å…¥ä¹‹å‰è®¾ç½®çš„å¯†ç ï¼Œç„¶åä¼šç”Ÿæˆç­¾åçš„è¯ä¹¦")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("openssl x509 -req -days 365 -sha256 -in server.csr -CA ca.pem -CAkey ca-key.pem \\-CAcreateserial -out server-cert.pem -extfile extfile.cnf\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("8ã€ç”Ÿæˆä¾‹å¦‚ideaç­‰å®¢æˆ·ç«¯éœ€è¦ç”¨åˆ°çš„å¯†é’¥æ–‡ä»¶")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("openssl genrsa -out key.pem 4096\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("9ã€ç”Ÿæˆå®¢æˆ·ç«¯ç­¾åè¯·æ±‚éœ€è¦ç”¨åˆ°çš„ä¸´æ—¶æ–‡ä»¶")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("openssl req -subj '/CN=client' -new -key key.pem -out client.csr\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("10ã€ç»§ç»­è®¾ç½®è¯ä¹¦æ‰©å±•å±æ€§")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("echo extendedKeyUsage = clientAuth >> extfile.cnf\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("11ã€è¾“å…¥ä¹‹å‰çš„å¯†ç ç”Ÿæˆè®¤è¯è¯ä¹¦ï¼Œç”Ÿæˆæ­£å¼ç­¾åè¯ä¹¦")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("openssl x509 -req -days 365 -sha256 -in client.csr -CA ca.pem -CAkey ca-key.pem \\-CAcreateserial -out cert.pem -extfile extfile.cnf \n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("12ã€åˆ é™¤ç”Ÿæˆçš„ä¸´æ—¶æ–‡ä»¶")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("rm -rf client.csr server.csr\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("13ã€ä¿®æ”¹è¯ä¹¦ä¸ºåªè¯»æƒé™ä¿è¯è¯ä¹¦å®‰å…¨")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("chmod -v 0400 ca-key.pem key.pem server-key.pem\nchmod -v 0444 ca.pem server-cert.pem cert.pem\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("14ã€å¤åˆ¶æœåŠ¡ç«¯éœ€è¦ç”¨åˆ°çš„è¯ä¹¦åˆ°dockeré…ç½®ç›®å½•ä¸‹ä¾¿äºè¯†åˆ«ä½¿ç”¨ï¼š")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("cp server-cert.pem ca.pem server-key.pem /etc/docker/\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("15ã€ä¿®æ”¹dockeré…ç½®")]),e._v(" "),s("p",[e._v("å¦‚æœæ˜¯ç¦»çº¿æ‰‹åŠ¨å®‰è£…çš„dockerï¼Œé€šå¸¸æƒ…å†µä¸‹æ˜¯è¿™ä¸ªæ–‡ä»¶ï¼š")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("vim /etc/systemd/system/docker.service\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("ç„¶ååœ¨"),s("code",[e._v("ExecStart=/usr/bin/dockerd")]),e._v("åé¢è¿½åŠ ä¸€ä¸ª \\ ,ç„¶åé»è´´è¯ä¹¦çš„é…ç½®ï¼Œå¤§æ¦‚å¦‚ä¸‹")]),e._v(" "),s("hr"),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("ExecStart=/usr/bin/dockerd \\\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("åŠ ä¸Šä»¥ä¸‹éƒ¨åˆ†")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("--tlsverify \\ \n--tlscacert=/etc/docker/ca.pem \\ \n--tlscert=/etc/docker/server-cert.pem \\ \n--tlskey=/etc/docker/server-key.pem \\ \n-H tcp://0.0.0.0:2375 \\ \n-H unix:///var/run/docker.sock \\  \n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br")])]),s("hr"),e._v(" "),s("p",[e._v("ä½†æ˜¯ï¼Œå¦‚æœæ˜¯è‡ªåŠ¨ä½¿ç”¨yumå®‰è£…çš„ï¼ŒæœåŠ¡æ–‡ä»¶åœ°å€å¯èƒ½æ˜¯è¿™ä¸ªï¼š")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("vim /lib/systemd/system/docker.service\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("ç„¶ååŠ ä¸ŠåŠ ç²—çš„éƒ¨åˆ†å³å¯")]),e._v(" "),s("hr"),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("ExecStart=/usr/bin/dockerd-current \\\n\n--add-runtime docker-runc=/usr/libexec/docker/docker-runc-current \\\n--default-runtime=docker-runc \\\n--exec-opt native.cgroupdriver=systemd \\\n--userland-proxy-path=/usr/libexec/docker/docker-proxy-current \\\n--init-path=/usr/libexec/docker/docker-init-current \\\n--seccomp-profile=/etc/docker/seccomp.json \\\n$OPTIONS \\\n$DOCKER_STORAGE_OPTIONS \\\n$DOCKER_NETWORK_OPTIONS \\\n$ADD_REGISTRY \\\n$BLOCK_REGISTRY \\\n$INSECURE_REGISTRY \\\n$REGISTRIES\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br"),s("span",{staticClass:"line-number"},[e._v("13")]),s("br"),s("span",{staticClass:"line-number"},[e._v("14")]),s("br"),s("span",{staticClass:"line-number"},[e._v("15")]),s("br")])]),s("p",[e._v("åœ¨é¦–è¡ŒååŠ ä¸Šä»¥ä¸‹éƒ¨åˆ†")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("--tlsverify \\ \n--tlscacert=/etc/docker/ca.pem \\ \n--tlscert=/etc/docker/server-cert.pem \\ \n--tlskey=/etc/docker/server-key.pem \\ \n-H tcp://0.0.0.0:2375 \\ \n-H unix:///var/run/docker.sock \\  \n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br")])]),s("hr"),e._v(" "),s("p",[e._v("16ã€å¼€æ”¾é˜²ç«å¢™çš„2375çš„ç«¯å£ï¼Œè‹¥ä¸ºé˜¿é‡Œäº‘æœåŠ¡å™¨ï¼Œéœ€åœ¨ç½‘é¡µä¸Šé˜²ç«å¢™è‡ªå®šä¹‰æ·»åŠ è§„åˆ™")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("firewall-cmd --zone=public --add-port=2375/tcp --permanent\n\nfirewall-cmd --reload\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br")])]),s("p",[e._v("17ã€é‡è½½æœåŠ¡å¹¶é‡å¯docker")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("systemctl daemon-reload && systemctl restart docker \n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("18ã€ä¿å­˜è¯ä¹¦å®¢æˆ·ç«¯æ–‡ä»¶åˆ°æœ¬åœ°ç”¨äºè¿æ¥dockerï¼Œä½¿ç”¨winscpè¿æ¥æœåŠ¡å™¨å¤åˆ¶å³å¯")]),e._v(" "),s("p",[e._v("19ã€æµ‹è¯•ä¸€ä¸‹è¯ä¹¦æ˜¯å¦é…ç½®æˆåŠŸï¼Œå¦‚æœæˆåŠŸï¼Œä¼šè¾“å‡ºè¯ä¹¦ç›¸å…³ä¿¡æ¯ï¼Œå¦‚æœæœ‰failï¼Œè¯·æ£€æŸ¥è¯ä¹¦ï¼ˆåœ¨certsæ–‡ä»¶å¤¹ä¸‹è¿è¡Œï¼‰")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("docker --tlsverify --tlscacert=ca.pem --tlscert=cert.pem --tlskey=key.pem -H=16.21.2.234:2375 version \n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("20ã€é…ç½®idea")]),e._v(" "),s("p",[e._v("ç‚¹å‡»ideaç¬¬ä¸€è¡Œèœå•"),s("code",[e._v("run -> edit configurations")]),e._v("ï¼Œç„¶åç‚¹å‡»+å·ï¼Œæ·»åŠ dockeré…ç½®ï¼Œé€‰æ‹©"),s("code",[e._v("Dockerfile")]),e._v("ï¼Œ")]),e._v(" "),s("p",[e._v("ç„¶åé€‰æ‹©serverå±æ€§ï¼Œå¼¹å‡ºdocker serveré…ç½®ï¼Œ")]),e._v(" "),s("p",[e._v("engine api urlï¼šhttps://å…¬ç½‘IP:2375")]),e._v(" "),s("p",[e._v("certificates folderï¼šD:\\buy\\ca-docker")]),e._v(" "),s("p",[e._v("è¿æ¥æˆåŠŸå°†æ˜¾ç¤ºseccussful")]),e._v(" "),s("p",[e._v("21ã€ç”Ÿæˆè¯ä¹¦shellè„šæœ¬")]),e._v(" "),s("p",[e._v("ä¸Šè¿°å‘½ä»¤è„šæœ¬ï¼ˆcert.shï¼‰ï¼š")]),e._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('SERVER="172.16.75.201" \nPASSWORD="2084team-docker-tls" \necho "shell script is doing"\necho "start file"\nmkdir /mydata/docker-ca && cd /mydata/docker-ca\nopenssl genrsa -aes256 -passout pass:$PASSWORD -out ca-key.pem 4096\nopenssl req -new -x509 -passin "pass:$PASSWORD" -days 365 -key ca-key.pem -sha256 -subj "/CN=$SERVER" -out ca.pem\nopenssl genrsa -out server-key.pem 4096\nopenssl req -subj "/CN=$SERVER" -sha256 -new -key server-key.pem -out server.csr\nsh -c  \'echo "subjectAltName = IP:\'$SERVER\',IP:0.0.0.0" >> extfile.cnf\'\nsh -c  \'echo "extendedKeyUsage = serverAuth" >> extfile.cnf\'\nopenssl x509 -req -days 365 -sha256 -passin "pass:$PASSWORD" -in server.csr -CA ca.pem -CAkey ca-key.pem -CAcreateserial -out server-cert.pem -extfile extfile.cnf\nopenssl genrsa -out key.pem 4096\nopenssl req -subj "/CN=client" -new -key key.pem -out client.csr\necho extendedKeyUsage = clientAuth > extfile-client.cnf\nopenssl x509 -req -days 365 -sha256 -passin "pass:$PASSWORD" -in client.csr -CA ca.pem -CAkey ca-key.pem -CAcreateserial -out cert.pem -extfile extfile-client.cnf\nrm -rf ca.srl server.csr client.csr extfile-client.cnf extfile.cnf\necho "end file"\necho "shell script is done"\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br"),s("span",{staticClass:"line-number"},[e._v("13")]),s("br"),s("span",{staticClass:"line-number"},[e._v("14")]),s("br"),s("span",{staticClass:"line-number"},[e._v("15")]),s("br"),s("span",{staticClass:"line-number"},[e._v("16")]),s("br"),s("span",{staticClass:"line-number"},[e._v("17")]),s("br"),s("span",{staticClass:"line-number"},[e._v("18")]),s("br"),s("span",{staticClass:"line-number"},[e._v("19")]),s("br")])])])}),[],!1,null,null,null);s.default=n.exports}}]);